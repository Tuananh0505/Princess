;/*FB_PKG_DELIM*/

__d("MAWEncryptedBackupsRestoreDialogContexts_query.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWEncryptedBackupsRestoreDialogContexts_query",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWEncryptedBackupsGetVirtualDevicesPreloaded_xfbEncryptedBackup"},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'}],storageKey:null},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null}],storageKey:null},action:"THROW",path:"viewer"}],type:"Query",abstractKey:null};e.exports=a}),null);
__d("MWChatEncryptedBackupsRestoreUpsellDialogContextProvider.react",["MWChatEncryptedBackupsDisableDismissalDialogContext","MWChatEncryptedBackupsSetIsDialogPersistedContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useMemo;function a(a){var b=a.children,d=a.disableDismissalDialog,e=a.setIsDialogPersisted;a=j(function(){return{setIsDialogPersisted:e}},[e]);var f=j(function(){return{disableDismissalDialog:d}},[d]);if(e!=null)return i.jsx(c("MWChatEncryptedBackupsSetIsDialogPersistedContext").Provider,{value:a,children:b});return d!=null?i.jsx(c("MWChatEncryptedBackupsDisableDismissalDialogContext").Provider,{value:f,children:b}):b}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWEncryptedBackupsOTCEligibleDevicesContextProvider.react",["MWEncryptedBackupsOTCEligibleDevicesContext.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useMemo,k=b.useState;function a(a){a=a.children;var b=k(!0),c=b[0],e=b[1];b=k(!0);var f=b[0],g=b[1];b=k([]);var h=b[0],l=b[1];b=j(function(){return{failedToFetchOtcDevices:f,isFetchOtcDevicesInFlight:c,otcEligibleDevices:h,setFailedToFetchOtcDevices:g,setIsFetchOtcDevicesInFlight:e,setOtcEligibleDevices:l}},[f,c,h]);return i.jsx(d("MWEncryptedBackupsOTCEligibleDevicesContext.react").MWEncryptedBackupsOTCEligibleDevicesContext.Provider,{value:b,children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse",selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],type:"VestaGetUserInfoResponse",abstractKey:null};e.exports=a}),null);
__d("useMWChatEncryptedBackupsVestaUserInfo",["CometRelay","useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c;a=a.vestaGetUserInfoResponse$key;a=d("CometRelay").useFragment(h!==void 0?h:h=b("useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql"),a);return{attemptsRemaining:(c=a==null?void 0:a.attempts_remaining)!=null?c:null,isRegistered:(c=a==null?void 0:a.is_registered)!=null?c:null,loginTimeoutRemainingSecs:(c=a==null?void 0:a.login_timeout_remaining_secs)!=null?c:null}}g["default"]=a}),98);
__d("MAWEncryptedBackupsRestoreDialogContexts.react",["CometRelay","CometTransientDialogProvider.react","MAWEncryptedBackupsRestoreDialogContexts_query.graphql","MWChatEncryptedBackupsRestoreUpsellDialogContextProvider.react","MWChatEncryptedBackupsVestaUserInfoContext.react","MWChatEncryptedBackupsVirtualDevicesContextProvider.react","MWEBFlowSourceContextProvider.react","MWEncryptedBackupsOTCEligibleDevicesContextProvider.react","react","useMWChatEncryptedBackupsVestaUserInfo","useMWEncryptedBackupsGetVirtualDevicesPreloaded"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react")),k=i.useMemo;function a(a){var e,f=a.children,g=a.disableDismissalDialog,i=a.query,l=a.setIsDialogPersisted;a=a.source;i=d("CometRelay").useFragment(h!==void 0?h:h=b("MAWEncryptedBackupsRestoreDialogContexts_query.graphql"),i);e=(e=i.viewer.messenger_default_encrypted_backup)==null?void 0:e.vesta_user_info;var m=c("useMWChatEncryptedBackupsVestaUserInfo")({vestaGetUserInfoResponse$key:e});e=c("useMWEncryptedBackupsGetVirtualDevicesPreloaded")({encryptedBackup:i.xfb_backup});e=e.getVirtualDevices;e=e();var n=e.isGDriveDeviceEnabled,o=e.offlineDevicesCount;e=e.vestaClientID;var p=k(function(){return{attemptsRemaining:m.attemptsRemaining,loginTimeoutRemainingSecs:m.loginTimeoutRemainingSecs,vestaClientID:null}},[m.attemptsRemaining,m.loginTimeoutRemainingSecs]);return j.jsx(c("MWChatEncryptedBackupsRestoreUpsellDialogContextProvider.react"),{setIsDialogPersisted:l,children:j.jsx(c("MWChatEncryptedBackupsVirtualDevicesContextProvider.react"),{hasOtcEligibleDevicesInitialValue:(i=(l=i.xfb_backup)==null?void 0:l.has_otc_eligible_devices)!=null?i:void 0,isGDriveDeviceEnabledInitialValue:n,offlineDevicesCountInitialValue:o,vestaClientIDInitialValue:e,children:j.jsx(c("MWEBFlowSourceContextProvider.react"),{source:a,children:j.jsx(c("MWChatEncryptedBackupsRestoreUpsellDialogContextProvider.react"),{disableDismissalDialog:g,children:j.jsx(d("MWChatEncryptedBackupsVestaUserInfoContext.react").VestaUserInfoContext.Provider,{value:p,children:j.jsx(c("MWEncryptedBackupsOTCEligibleDevicesContextProvider.react"),{children:j.jsx(c("CometTransientDialogProvider.react"),{children:f})})})})})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsRingIndeterminateIcon.react",["CometHeroHoldTrigger.react","MWXSpinner.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={large:{minHeight:"x1zwvfr",$$css:!0},root:{alignItems:"x6s0dn4",display:"x78zum5",flexDirection:"xdt5ytf",justifyContent:"xl56j7k",$$css:!0},small:{minHeight:"x1edz59j",$$css:!0}};function a(a){a=a.size;a=a===void 0?"large":a;return j.jsxs("div",{className:(h||(h=c("stylex")))(k.root,k[a]),children:[j.jsx(c("CometHeroHoldTrigger.react"),{description:"MWEBRingSpinner",hold:!0}),j.jsx(c("MWXSpinner.react"),{color:"blue",size:60})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWAbandonRestoreConfirmationDialog",["fbt","MWChatEncryptedBackupsQPLEvents","QPLUserFlow","gkx","react","useMWXConfirmationDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||d("react")).useCallback;function a(a){var b=c("useMWXConfirmationDialog")(),e=c("gkx")("23219");return j(function(){b({body:e?h._("__JHASH__igJ7_fPkBWf__JHASH__"):h._("__JHASH__mJ4KzCvoneV__JHASH__"),confirm:h._("__JHASH__NclomsdgTqa__JHASH__"),title:h._("__JHASH__Lc-TiofSivN__JHASH__")},function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"DONT_RESTORE_CONFIRMATION_CLICK"),a==null?void 0:a()},function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"DONT_RESTORE_CANCEL_CLICK")})},[b,e,a])}g["default"]=a}),98);
__d("MWEBRestoreDialog.react",["CometControlledUserBlockingMultiStepDialog.react","MAWEncryptedBackupsRestoreStep.react","MAWPinCodeGating","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWChatEncryptedBackupsRingIndeterminateIcon.react","MWChatEncryptedBackupsVirtualDevicesContext.react","MWEncryptedBackupsDeviceRegistrationId","MWEncryptedBackupsForgotPinStep","MWEncryptedBackupsForgotRCStep","MWEncryptedBackupsOtcRestoreSteps","MWEncryptedBackupsRetrieveQplLoggingAnnotations","PAKECleanupSessionReasonEnum","PAKEClientTypeEnum","promiseDone","qex","react","requireDeferred","useLabyrinthLogging","useMWAbandonRestoreConfirmationDialog","useMWChatEncryptedBackupsAutoRestoreConsentStep","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useContext,m=b.useEffect,n=b.useRef,o=c("requireDeferred")("CleanupPakeSession").__setRef("MWEBRestoreDialog.react"),p=c("requireDeferred")("mwEBCheckIfEBKeysExistInDisk").__setRef("MWEBRestoreDialog.react"),q=(e=c("qex")._("179"))!=null?e:!1;function a(a){var b=a.addDeferUpsellQplAnnotation,e=a.cancellable;e=e===void 0?!0:e;var f=a.isDismissDisabled,g=a.onClose,i=a.onDismissUpsell,r=n(!1),s=(h||(h=c("useReStore")))();a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var t=a.startFlow;a=l(c("MWChatEncryptedBackupsVirtualDevicesContext.react"));var u=a.virtualDeviceInfo;a=k(function(){i==null?void 0:i(),d("MWChatEncryptedBackupsLogging").closeDialogCancelFlow({event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,onClose:function(){return g()}}),u.doesUserHaveOtcEligibleDevices===!0&&o.onReady(function(a){c("promiseDone")(a({cleanupReason:c("PAKECleanupSessionReasonEnum").FLOW_ABANDONED,clientType:c("PAKEClientTypeEnum").ENCRYPTED_BACKUPS,deviceId:d("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId(),storage:s}))})},[i,u.doesUserHaveOtcEligibleDevices,g,s]);var v=c("useMWAbandonRestoreConfirmationDialog")(a),w=function(){b==null?void 0:b(),g()},x=c("useMWChatEncryptedBackupsAutoRestoreConsentStep")({onComplete:w}),y=u.vestaClientID!=null;m(function(){r.current||(r.current=!0,d("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:s,onFetch:function(a){var b=a.ebsmWiped,e=a.firstUpsellTime,f=a.hasEbKeysLocally,g=a.hasEBSM,h=a.hasPDB,i=a.hasUserRestoredBefore;a=a.hasUserRestoredBeforeTemp;t({additionalAnnotations:{eb_session_identifier:e,ebsm_wiped:b,has_eb_keys_locally:f,has_ebsm:g,has_pdb:h,has_user_restored_before:i,has_user_restored_before_temp:a,restore_upsell_first_impression_time:e},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:c("MWChatEncryptedBackupsQPLSource.enum").INBOX_INTERSTITIAL_SOFTBLOCK});c("promiseDone")(p.load(),function(a){return a(f)})}}))},[t,s]);return q?null:j.jsx(c("CometControlledUserBlockingMultiStepDialog.react"),{onDismiss:f?function(){}:v,size:"small",withCloseButton:e,children:function(a){if(u.offlineDevicesCount===-1)return j.jsx(c("MWChatEncryptedBackupsRingIndeterminateIcon.react"),{});var b=x.onPushAutoRestoreConsentPage(a);return j.jsx(c("MAWEncryptedBackupsRestoreStep.react"),{clientID:d("MAWPinCodeGating").isPinCodeEnabled()&&y?u.vestaClientID:null,isGDriveDeviceEnabled:u.isGDriveDeviceEnabled,offlineDevicesCount:u.offlineDevicesCount,onChooseOtc:u.doesUserHaveOtcEligibleDevices?function(){return d("MWEncryptedBackupsOtcRestoreSteps").pushByOneTimeCodePage({onOtcComplete:b,pushPage:a})}:null,onClose:v,onComplete:b,onForgotPin:function(){d("MWEncryptedBackupsForgotPinStep").pushForgotPinPage({isGDriveDeviceEnabled:u.isGDriveDeviceEnabled,offlineDeviceCount:u.offlineDevicesCount,onClose:g,onComplete:w,pushPage:a})},onForgotRC:function(){d("MWEncryptedBackupsForgotRCStep").pushForgotRCPage({onClose:g,onComplete:w,pushPage:a})},pushPage:a,shouldShowForgotButton:!0})}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWEBRestoreInterstitialDialogWrapper_query.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEBRestoreInterstitialDialogWrapper_query",selections:[{args:null,kind:"FragmentSpread",name:"MAWEncryptedBackupsRestoreDialogContexts_query"}],type:"Query",abstractKey:null};e.exports=a}),null);
__d("MWEBRestoreInterstitialDialogWrapper.react",["CometRelay","MAWEncryptedBackupsRestoreDialogContexts.react","MWChatEncryptedBackupsQPLSource.enum","MWEBRestoreDialog.react","MWEBRestoreInterstitialDialogWrapper_query.graphql","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react")),k=i.useState;function a(a){var e=a.query,f=a.setIsClosed,g=a.setIsDialogPersisted;a=a.setIsDismissed;e=d("CometRelay").useFragment(h!==void 0?h:h=b("MWEBRestoreInterstitialDialogWrapper_query.graphql"),e);var i=k(!1),l=i[0],m=i[1];i=c("MWChatEncryptedBackupsQPLSource.enum").INBOX_INTERSTITIAL_SOFTBLOCK;return j.jsx(c("MAWEncryptedBackupsRestoreDialogContexts.react"),{disableDismissalDialog:function(){return m(!0)},query:e,setIsDialogPersisted:function(){return g(!0)},source:i,children:j.jsx(c("MWEBRestoreDialog.react"),{isDismissDisabled:l,onClose:function(){return f(!0)},onDismissUpsell:a})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);