;/*FB_PKG_DELIM*/

__d("LSCleanupSession",["LSIssueNewTask","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][cleanupSession] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.i64.eq(a[1],c.i64.cast([0,0]))?d[2]=c.i64.cast([0,21]):(c.i64.eq(a[1],c.i64.cast([0,1]))?d[10]=c.i64.cast([0,20]):d[10]=c.i64.cast([0,20]),d[2]=d[10]),c.filter(c.db.table(258).fetch(),function(b){return(b.initiatorId===a[0]||b.responderId===a[0])&&c.i64.eq(b.clientType,a[2])}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.filter(c.db.table(258).fetch(),function(b){return c.i64.eq(b.clientType,a[2])}).next().then(function(f,h){var e=f.done;f=f.value;return e?c.db.table(258).add({sessionId:c.i64.cast([-1,4294967295]),responderId:a[0],initiatorId:a[0],messageType:d[2],clientType:a[2]}):(h=f.item,c.sequence([function(a){return d[13]=h.sessionId,c.forEach(c.db.table(258).fetch([[[d[13]]]]),function(a){var b=a.update;a.item;return b({messageType:d[2]})})},function(e){return d[11]=new c.Map(),d[11].set("session_id",d[13]),d[11].set("responder_id",h.responderId),d[11].set("initiator_id",h.initiatorId),d[11].set("message_payload",h.messagePayload),d[11].set("pake_secret",h.pakeSecret),d[11].set("sender_id",a[0]),d[11].set("message_type",d[2]),d[11].set("client_type",a[2]),d[12]=c.toJSON(d[11]),c.storedProcedure(b("LSIssueNewTask"),"PakeMessages",c.i64.cast([0,717]),d[12],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]))}):(f=e.item,d[11]=f.sessionId,d[10]=f.messageType,c.i64.eq(d[10],c.i64.cast([0,15]))||c.i64.eq(d[10],c.i64.cast([0,21]))||c.i64.eq(d[10],c.i64.cast([0,20]))?c.resolve(0):c.sequence([function(a){return c.forEach(c.db.table(258).fetch([[[d[11]]]]),function(a){var b=a.update;a.item;return b({messageType:d[2]})})},function(e){return d[12]=new c.Map(),d[12].set("session_id",d[11]),d[12].set("responder_id",f.responderId),d[12].set("initiator_id",f.initiatorId),d[12].set("message_payload",f.messagePayload),d[12].set("pake_secret",f.pakeSecret),d[12].set("sender_id",a[0]),d[12].set("message_type",d[2]),d[12].set("client_type",a[2]),d[13]=c.toJSON(d[12]),c.storedProcedure(b("LSIssueNewTask"),"PakeMessages",c.i64.cast([0,717]),d[13],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]))})},function(a){return d[4]=c.i64.of_float(Date.now()),d[5]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[4],d[0])),d[9]=" ms",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][cleanupSession] ",d[6],d[7],d[6],d[8],d[6],d[9]].join("")),c.i64.eq(c.i64.mod_(d[5],c.i64.cast([0,100])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"cleanupSession",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSCleanupSessionStoredProcedure",["LSCleanupSession","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.deviceId;d[1]=b.cleanupReason;d[2]=b.clientType;return c("LSCleanupSession").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("CleanupPakeSession",["LSCleanupSessionStoredProcedure","LSFactory","LSIntEnum","MAWOneTimeCodeGating","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){var e=a.cleanupReason,f=a.clientType,g=a.deviceId;a=a.storage;return!d("MAWOneTimeCodeGating").isOneTimeCodeEnabled()?(i||(i=b("Promise"))).resolve():a.runInTransaction(function(a){return c("LSCleanupSessionStoredProcedure")(c("LSFactory")(a),{cleanupReason:(h||(h=d("LSIntEnum"))).ofNumber(e),clientType:h.ofNumber(f),deviceId:g})},"readwrite")}g["default"]=a}),98);
__d("E2EEBackupSecretRestoreModule",["E2EEBackupCommon","Promise","QuickPerformanceLogger","VestaClient","VestaClientError","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("qpl")._(235874858,"168");function a(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){(i||(i=c("QuickPerformanceLogger"))).markerStart(j);i.markerAnnotate(j,{string:{product_use_case:e.productUseCase}});try{var g=(yield a.initLogin({clientId:e.clientId,productUseCase:e.productUseCase},f)),k=g.islandRsaPub,l=g.islandRsaPubSig,m=g.islandEd25519Pub,n=g.islandEd25519PubSig;g=g.isRegistered;(i||(i=c("QuickPerformanceLogger"))).markerPoint(j,"init_login_network_call");if(!g){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"NOT_REGISTERED"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.NOT_REGISTERED)}g=(yield (h||(h=b("Promise"))).all([d("VestaClient").validateHsmKey(k,l),d("VestaClient").validateHsmKey(m,n)]));k=g[0];l=g[1];if(!k){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"ISLAND_PUB_RSA_KEY_INVALID"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_RSA_KEY_INVALID)}if(!l){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"ISLAND_PUB_ED25519_KEY_INVALID"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_ED25519_KEY_INVALID)}i.markerPoint(j,"verify_island_rsa_key");i.markerPoint(j,"verify_island_ed25519_key");n=e.vestaAccountPin;if(n==null)throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.MISSING_PIN_INPUT);else{g=new TextEncoder();k=(yield d("VestaClient").beginLogin(g.encode(n)));l=k.clientState;g=k.l1Message;(i||(i=c("QuickPerformanceLogger"))).markerPoint(j,"begin_login_vesta_client");n=(yield a.beginLogin({clientId:e.clientId,productUseCase:e.productUseCase,opaqueL1:g},f));k=n.opaqueL2;g=n.opaqueL2Sig;i.markerPoint(j,"begin_login_network_call");n=(yield d("VestaClient").finishLogin(k,g,m,l));k=n.exportKey;g=n.l3Message;m=n.sessionKey;i.markerPoint(j,"finish_login_vesta_client");l=(yield a.finishLogin({clientId:e.clientId,productUseCase:e.productUseCase,opaqueL3:g},f));n=l.loginSuccess;a=l.loginPayload;i.markerPoint(j,"finish_login_network_call");if(!n){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"VESTA_SERVER_ERROR"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR)}if(a!=null){e=(yield d("VestaClient").unpackLoginPayload(a,m,k));g=e.userSecret;(i||(i=c("QuickPerformanceLogger"))).markerPoint(j,"unpack_login_payload");i.markerEnd(j,2);return g}i.markerAnnotate(j,{string:{failure_reason:"VESTA_SERVER_ERROR"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR)}}catch(a){if(a instanceof d("E2EEBackupCommon").BackupError)throw a;else if(a instanceof c("VestaClientError")){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"VestaClientException: "+a.name}});i.markerEnd(j,3);if(a.name==="InvalidUserPassword")throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.INVALID_PASSWORD,a);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_CLIENT_ERROR,a)}else{(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:a.message}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.NETWORK_PROVIDER_ERROR,a)}}});return k.apply(this,arguments)}g.restoreBackupSecret=a}),98);
__d("LSAddDevice",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDataTrace","LSCreateDataTraceID.nop","LSFlushDataTrace.nop","LSGetViewerFBID","LSHandleWrongRecoveryCode","LSIsMobileClient","LSIssueNewTaskAndGetTaskID","LSIssueNewTaskUsingSyncChannel","LSLogMebClientEvent.nop","LSParseRecoveryCode_v2.nop","gkx","justknobx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Beginning execution."),(c("gkx")("23657")||c("gkx")("26375"))&&c("justknobx")._("946")?d.sequence([function(c){return d.i64.eq(a[3],d.i64.cast([0,2]))?e[8]=d.i64.cast([0,199]):e[8]=d.i64.cast([0,71]),a[4]!==void 0?d.sequence([function(a){return e[18]="EncryptedBackups Trace ID",e[19]=d.i64.to_string(e[8]),e[17]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",e[17],e[18],e[17],e[19]].join("")),d.resolve()},function(c){return d.storedProcedure(b("LSCreateDataTrace"),a[4],void 0,void 0,"backup_init_flow",e[8])},function(b){return e[9]=a[4]}]):d.sequence([function(a){return d.nativeOperation(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,e[17]=a[0],a})},function(a){return e[21]="EncryptedBackups MCD Trace ID",e[22]=d.i64.to_string(e[8]),e[18]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",e[18],e[21],e[18],e[22]].join("")),d.resolve()},function(a){return d.storedProcedure(b("LSCreateDataTrace"),e[17],void 0,void 0,"backup_init_flow",e[8])},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[19]=a[0],a})},function(a){return e[19]?e[20]=!0:e[20]=!1,e[20]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[23]=d.createArray(),void 0!==void 0?e[24]=(e[23].push(void 0),e[23]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[23],d.i64.cast([0,3]))):d.resolve()},function(a){return e[9]=e[17]}])},function(a){return e[9]!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,1413]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[10]=a[0],a})},function(a){return e[10]?e[11]=!0:e[11]=!1,e[11]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[17]=d.createArray(),void 0!==void 0?e[18]=(e[17].push(void 0),e[17]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[17],d.i64.cast([0,3]))):d.resolve()},function(a){return e[12]=d.createArray(),d.forEach(d.db.table(179).fetch(),function(a){var b=a.item;return d.sequence([function(a){return e[19]=b.taskId,d.db.table(2).fetch([[[e[19]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?e[17]=!1:(a.item,e[17]=!0)})},function(a){return e[17]?0:e[20]=(e[12].push(e[19]),e[12])}])})},function(a){return e[13]=d.i64.of_int32(e[12].length),d.i64.gt(e[13],d.i64.cast([0,0]))?d.loopAsync(e[13],function(a){return e[17]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[12],e[17]).then(function(a){return a=a,e[18]=a[0],e[19]=a[1],a})},function(a){return d.forEach(d.db.table(179).fetch([[[e[18]]]]),function(a){return a["delete"]()})}])}):d.resolve()},function(a){return d.db.table(179).fetch().next().then(function(a,b){b=a.done;a=a.value;return b?e[14]=!1:(a.item,e[14]=!0)})},function(c){return e[14]?d.sequence([function(a){return e[17]="Aborting addDevice execution as there is an existing pending task",e[17]!==void 0?d.sequence([function(a){return e[21]=["[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] ","",e[17]].join(""),function(a){d.logger(a).mustfix(a)}(e[21]),e[18]=d.createArray(),e[9]!==void 0?e[22]=(e[18].push(e[9]),e[18]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceStoredProcedure",e[17],e[18],d.i64.cast([0,3]))},function(a){return e[9]!==void 0?d.sequence([function(a){return e[9]!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,85]),d.i64.cast([0,2]),e[21],void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[22]=a[0],a})},function(a){return e[22]?e[23]=!0:e[23]=!1,e[23]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[24]=d.createArray(),void 0!==void 0?e[25]=(e[24].push(void 0),e[24]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[24],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return e[9]!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),e[9]):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[19]=a[0],a})},function(a){return e[19]?e[20]=!0:e[20]=!1,e[20]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[22]=d.createArray(),void 0!==void 0?e[23]=(e[22].push(void 0),e[22]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[22],d.i64.cast([0,3]))):d.resolve()}]):d.sequence([function(a){return e[9]!==void 0?d.sequence([function(a){return e[9]!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),e[9],d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] ","",""].join(""),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[20]=a[0],a})},function(a){return e[20]?e[21]=!0:e[21]=!1,e[21]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[22]=d.createArray(),void 0!==void 0?e[23]=(e[22].push(void 0),e[22]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[22],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return e[9]!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),e[9]):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[18]=a[0],a})},function(a){return e[18]?e[19]=!0:e[19]=!1,e[19]?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[20]=d.createArray(),void 0!==void 0?e[21]=(e[20].push(void 0),e[20]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[20],d.i64.cast([0,3]))):d.resolve()}])},function(a){return e[16]=d.i64.cast([0,1])}]):d.sequence([function(b){return e[17]=d.createArray(),d.forEach(d.filter(d.db.table(184).fetch(),function(b){return d.i64.eq(b.backupId,a[0])}),function(a){a=a.item;return e[23]=new d.Map(),e[23].set("virtual_device_id",a.virtualDeviceId),e[24]=(e[17].push(e[23]),e[17])})},function(a){return d.db.table(172).fetch().next().then(function(a,b){var c=a.done;a=a.value;return c?e[18]=void 0:(b=a.item,e[24]=b.encryptionManagementDelegatorId,d.i64.neq(e[24],void 0)?(d.i64.neq(e[24],d.i64.cast([0,0]))?e[25]=d.i64.to_string(e[24]):e[25]=void 0,e[23]=e[25]):e[23]=void 0,e[18]=e[23])})},function(a){return d.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,e[20]=a[0],a})},function(c){return d.nativeOperation(b("LSParseRecoveryCode_v2.nop"),a[1],e[18]==null?d.i64.to_string(e[20]):e[18],e[17]).then(function(a){return a=a,e[21]=a[0],e[22]=a[1],a})},function(c){return d.blobs.neq(e[21],void 0)?d.blobs.neq(e[22],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[21]).then(function(a){return a=a,e[23]=a[0],a})},function(a){return e[26]=e[23]==null?"":e[23],d.db.table(178).put({pk:d.i64.cast([0,1]),recoveryCodeStatus:d.i64.cast([0,1])})},function(c){return e[24]=d.i64.cast([0,0]),d.sequence([function(c){return e[27]=new d.Map(),e[27].set("backup_id",a[0]),e[27].set("virtual_device_id",e[26]),e[27].set("trace_id",e[9]),d.i64.gt(d.i64.cast([0,0]),d.i64.cast([0,0]))?(e[31]=d.i64.of_float(Date.now()),e[28]=d.i64.add(e[31],d.i64.cast([0,0]))):e[28]=d.i64.cast([0,0]),e[29]=d.toJSON(e[27]),d.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),"encrypted_backups_setup",d.i64.cast([0,50007]),e[29],void 0,void 0,d.i64.cast([0,0]),d.i64.cast([0,0]),void 0,void 0,e[28],e[24]).then(function(a){return a=a,e[30]=a[0],a})},function(a){return e[25]=e[30]}])},function(b){return d.db.table(185).add({pk:d.i64.cast([0,1]),backupId:a[0],deviceRegistrationId:a[2],taskId:e[25]})},function(a){return d.db.table(179).add({taskId:e[25],virtualDeviceId:e[21],blobDecryptionKey:e[22]})}]):d.storedProcedure(b("LSHandleWrongRecoveryCode"),e[9],"[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Wrong recovery code. blob_decryption_key is null",!0):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Wrong recovery code"),e[23]=d.createArray(),void 0!==void 0?e[24]=(e[23].push(void 0),e[23]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceStoredProcedure","Wrong recovery code",e[23],d.i64.cast([0,3]))},function(a){return d.storedProcedure(b("LSHandleWrongRecoveryCode"),e[9],"[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Wrong recovery code. virtual_device_id is null",!0)}])},function(a){return e[16]=d.i64.cast([0,0])}])},function(a){return e[1]=e[16]}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] addDeviceFlow is not enabled"),e[1]=d.i64.cast([0,1])))},function(a){return e[2]=d.i64.of_float(Date.now()),e[3]=d.i64.random(),e[5]="Finishing execution. Execution time: ",e[6]=d.i64.to_string(d.i64.sub(e[2],e[0])),e[7]=" ms",e[4]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] ",e[4],e[5],e[4],e[6],e[4],e[7]].join("")),d.i64.eq(d.i64.mod_(e[3],d.i64.cast([0,100])),d.i64.cast([0,0]))?(e[8]=",",e[9]=d.createArray(),void 0!==void 0?e[10]=(e[9].push(void 0),e[9]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceStoredProcedure",[e[5],e[8],e[6],e[8],e[7]].join(""),e[9],d.i64.cast([0,4]))):d.resolve()},function(a){return f[0]=e[1]}])},function(a){return d.resolve(f)}])}d=a;g["default"]=d}),98);
__d("LSAddDeviceStoredProcedure",["LSAddDevice","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.backupId;d[1]=b.recoveryCode;d[2]=b.deviceRegistrationId;d[3]=b.backupTenancy;d[4]=b.traceId;return c("LSAddDevice").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MWPakeQPLEvents",["qpl"],(function(a,b,c,d,e,f,g){"use strict";a=c("qpl")._(231349365,"1751");g.pakeInitiatorQplEvent=a}),98);
__d("PAKEMessageQplLoggingAction",[],(function(a,b,c,d,e,f){a=Object.freeze({ADD_MARKER:0,END_SUCCESS:1,END_FAILURE:2,ADD_ERROR_ANNOTATION:3});f["default"]=a}),66);
__d("LSQplInteractionHelper.nop",["FBLogger","I64","MWPakeQPLEvents","PAKEMessageQplLoggingAction","Promise","QPLUserFlow"],(function(a,b,c,d,e,f,g){"use strict";var h,i;a=function(a,e,f,g,j){a=(i||(i=d("I64"))).to_int32(g);switch(a){case c("PAKEMessageQplLoggingAction").ADD_MARKER:f==null?c("FBLogger")("labyrinth_web").mustfix("PAKE: markerName is null when adding DS PAKE marker."):c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,f);break;case c("PAKEMessageQplLoggingAction").END_FAILURE:f==null?c("FBLogger")("labyrinth_web").mustfix("PAKE: markerName is null when adding failure DS PAKE marker."):c("QPLUserFlow").endFailure(d("MWPakeQPLEvents").pakeInitiatorQplEvent,f);break;case c("PAKEMessageQplLoggingAction").END_SUCCESS:c("QPLUserFlow").endSuccess(d("MWPakeQPLEvents").pakeInitiatorQplEvent);break;case c("PAKEMessageQplLoggingAction").ADD_ERROR_ANNOTATION:j==null?c("FBLogger")("labyrinth_web").mustfix("PAKE: pakeMessageType is null when annotating PAKE error."):c("QPLUserFlow").addAnnotations(d("MWPakeQPLEvents").pakeInitiatorQplEvent,{"int":{errorCode:(i||(i=d("I64"))).to_int32(j)}});break}return(h||(h=b("Promise"))).resolve()};g["default"]=a}),98);
__d("LSDecryptPakeSecret",["LSLogMebClientEvent.nop","LSQplInteractionHelper.nop","LSSymmetricEncryptionCreateDecryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptPakeSecret] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[2])&&c.i64.eq(b.sessionId,a[0])}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_NO_SESSION_ONGOING_FAILURE",c.i64.cast([0,0]),void 0)},function(a){return d[12]="PAKE: Failed to decrypt PAKE secrets as no session was ongoing.",c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,7]))},function(b){return c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[2])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,7]),clientType:a[2]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,7])})}))})},function(a){return function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",d[12]].join("")),d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[d[12]].join(""),d[13],c.i64.cast([0,3]))},function(a){return a=[void 0,c.i64.cast([-1,4294967294])],d[2]=a[0],d[3]=a[1],a}]):(f=e.item,c.sequence([function(e){return d[13]=f.responderId,d[14]=f.initiatorId,d[15]=f.pakeSecret,d[13]!==void 0?c.sequence([function(e){return d[14]!==void 0?c.sequence([function(e){return d[15]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_GENERATE_PAKE_AAD_START",c.i64.cast([0,0]),void 0)},function(a){return d[20]="_",c.nativeOperation(b("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_NATIVE_OP_START",c.i64.cast([0,0]),void 0)},function(e){return c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedString.nop"),a[1],c.blobs.of_string(["v1",d[20],c.i64.to_string(a[0]),d[20],d[13],d[20],d[14],d[20],c.i64.to_string(f.clientType)].join("")),d[15]).then(function(a){return a=a,d[21]=a[0],a})},function(e){return d[21]!==void 0?c.resolve((e=[d[21],c.i64.cast([0,0])],d[22]=e[0],d[23]=e[1],e)):c.sequence([function(a){return d[25]="PAKE: Failed to decrypt PAKE secrets as key was incorrect.",c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,10]))},function(b){return c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[2])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,10]),clientType:a[2]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,10])})}))})},function(a){return function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",d[25]].join("")),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[d[25]].join(""),d[26],c.i64.cast([0,3]))},function(a){return a=[void 0,c.i64.cast([-1,4294967295])],d[22]=a[0],d[23]=a[1],a}])},function(a){return a=[d[22],d[23]],d[18]=a[0],d[19]=a[1],a}]):c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_PAKE_SECRET_NULL_FAILURE",c.i64.cast([0,0]),void 0)},function(a){return d[21]="PAKE: Failed to decrypt PAKE secrets as there was no secret to decrypt.",c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,8]))},function(b){return c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[2])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,8]),clientType:a[2]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,8])})}))})},function(a){return function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",d[21]].join("")),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[d[21]].join(""),d[22],c.i64.cast([0,3]))},function(a){return a=[void 0,c.i64.cast([-1,4294967294])],d[18]=a[0],d[19]=a[1],a}])},function(a){return a=[d[18],d[19]],d[16]=a[0],d[17]=a[1],a}]):c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_INITIATOR_ID_NULL_FAILURE",c.i64.cast([0,0]),void 0)},function(a){return d[19]="PAKE: Failed to decrypt PAKE secrets as initiator id was null.",c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,8]))},function(b){return c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[2])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,8]),clientType:a[2]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,8])})}))})},function(a){return function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",d[19]].join("")),d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[d[19]].join(""),d[20],c.i64.cast([0,3]))},function(a){return a=[void 0,c.i64.cast([-1,4294967294])],d[16]=a[0],d[17]=a[1],a}])},function(a){return a=[d[16],d[17]],d[11]=a[0],d[12]=a[1],a}]):c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"PAKE_DS_DECRYPT_SECRET_RESPONDER_ID_NULL_FAILURE",c.i64.cast([0,0]),void 0)},function(a){return d[17]="PAKE: Failed to decrypt PAKE secrets as responder id was null.",c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,8]))},function(b){return c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[2])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,8]),clientType:a[2]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,8])})}))})},function(a){return function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSPakeMessagesDecryptPakeSecretStoredProcedure] ","",d[17]].join("")),d[18]=c.createArray(),void 0!==void 0?d[19]=(d[18].push(void 0),d[18]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSPakeMessagesDecryptPakeSecretStoredProcedure",[d[17]].join(""),d[18],c.i64.cast([0,3]))},function(a){return a=[void 0,c.i64.cast([-1,4294967294])],d[11]=a[0],d[12]=a[1],a}])},function(a){return a=[d[11],d[12]],d[2]=a[0],d[3]=a[1],a}]))})},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[8]="Finishing execution. Execution time: ",d[9]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[10]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptPakeSecret] ",d[7],d[8],d[7],d[9],d[7],d[10]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,100])),c.i64.cast([0,0]))?(d[11]=",",d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptPakeSecret",[d[8],d[11],d[9],d[11],d[10]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSDecryptPakeSecretStoredProcedure",["LSDecryptPakeSecret","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.sessionId;d[1]=b.encryptionKey;d[2]=b.clientType;return c("LSDecryptPakeSecret").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSFinishAddPeerDevice",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDataTrace","LSCreateDataTraceID.nop","LSCreateDebugToken.nop","LSCreateDerivedKeys.nop","LSCreateSignature_v2.nop","LSDeleteBackupOnClient","LSFlushDataTrace.nop","LSGenerateLocalKeys","LSGetBlobFromString.nop","LSGetEncryptionVersionFromSupportedVersionsList.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewTask","LSLogMebClientEvent.nop","LSOcmfClientEvolve_v2.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Beginning execution."),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))&&c.i64.eq(a.backupTenancy,c.i64.cast([0,2]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?d[1]=!1:(a.item,d[1]=!0)})},function(a){return d[1]?d[3]=c.i64.or_(c.i64.cast([0,88]),c.i64.cast([0,128])):d[3]=c.i64.cast([0,88]),c.nativeOperation(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,d[4]=a[0],a})},function(a){return d[14]="EncryptedBackups MCD Trace ID",d[15]=c.i64.to_string(d[3]),d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",d[5],d[14],d[5],d[15]].join("")),c.resolve()},function(a){return c.storedProcedure(b("LSCreateDataTrace"),d[4],void 0,void 0,"qr_add_device_receiver",d[3])},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[6]?d[7]=!0:d[7]=!1,d[7]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[19]=c.createArray(),void 0!==void 0?d[20]=(d[19].push(void 0),d[19]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[19],c.i64.cast([0,3]))):c.resolve()},function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,1434]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[8]=a[0],a})},function(a){return d[8]?d[9]=!0:d[9]=!1,d[9]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[19]=c.createArray(),void 0!==void 0?d[20]=(d[19].push(void 0),d[19]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[19],c.i64.cast([0,3]))):c.resolve()},function(e){return c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}).next().then(function(e,f){f=e.done;e=e.value;return f?c.sequence([function(a){return c.db.table(168).fetch().next().then(function(a,d){var e=a.done;a=a.value;return e?0:(d=a.item,c.storedProcedure(b("LSDeleteBackupOnClient"),d.backupId,void 0,!1,void 0,"null",!0))})},function(e){return d[19]=a[0].get("backup_id"),a[0],c.storedProcedure(b("LSGenerateLocalKeys"),!1).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(e){return d[20]!==void 0?c.sequence([function(a){return d[22]=d[20].get("device_key"),d[20],d[23]=d[20].get("epoch_storage_key"),d[20],d[24]=d[20].get("epoch_auth_key"),d[20],d[25]=d[22].get("device_private_key"),d[22],d[26]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[27]=a[0],a})},function(a){return d[27]?d[65]=(d[26].push(c.i64.cast([0,0])),d[26]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[65]=(d[26].push(c.i64.cast([0,2])),d[26]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[29]?d[65]=(d[26].push(c.i64.cast([0,3])),d[26]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[65]=(d[26].push(c.i64.cast([0,4])),d[26]):0,d[31]="",d[32]=c.i64.of_int32(d[26].length),c.i64.gt(d[32],c.i64.cast([0,0]))?c.loopAsync(d[32],function(a){return d[65]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[26],d[65]).then(function(a){return a=a,d[66]=a[0],d[67]=a[1],a})},function(a){return d[31]=[d[31],"_",c.i64.to_string(d[66])].join("")}])}):c.resolve()},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),["supported_versions_",d[31],"revision_version_",c.i64.to_string(c.i64.cast([0,1]))].join("")).then(function(a){return a=a,d[33]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateSignature_v2.nop"),d[25],c.blob("Mg=="),d[33]).then(function(a){return a=a,d[34]=a[0],a})},function(a){return c.blobs.neq(d[34],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[34]).then(function(a){return a=a,d[65]=a[0],a})},function(a){return d[35]=d[65]}]):c.resolve(d[35]=void 0)},function(a){return c.count(c.db.table(191).fetch()).then(function(a){return d[36]=a})},function(a){return c.i64.neq(d[36],c.i64.cast([0,0]))?c.sequence([function(a){return d[65]=c.createArray(),c.forEach(c.filter(c.db.table(191).fetch(),function(a){return c.i64.eq(d[19],a.backupId)}),function(a){var e=a.item;return c.sequence([function(a){return d[75]=c.createArray(),c.forEach(c.db.table(192).fetch([[[e.deviceId]]]),function(a){var e=a.item;return c.sequence([function(a){return d[78]=e.supportedVersion,c.storedProcedure(b("LSIsEncryptionVersionSecure"),d[78]).then(function(a){return a=a,d[77]=a[0],a})},function(a){return d[77]?d[79]=(d[75].push(d[78]),d[75]):0}])})},function(a){return d[76]=c.i64.of_int32(d[75].length),c.i64.gt(d[76],c.i64.cast([0,0]))?d[77]=(d[65].push(d[75]),d[65]):0}])})},function(a){return d[66]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[67]=a[0],a})},function(a){return d[67]?d[75]=(d[66].push(c.i64.cast([0,0])),d[66]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[68]=a[0],a})},function(a){return d[68]?d[75]=(d[66].push(c.i64.cast([0,2])),d[66]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[69]?d[75]=(d[66].push(c.i64.cast([0,3])),d[66]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[70]=a[0],a})},function(a){return d[70]?d[75]=(d[66].push(c.i64.cast([0,4])),d[66]):0,d[71]=c.createArray(),d[72]=c.i64.of_int32(d[66].length),c.i64.gt(d[72],c.i64.cast([0,0]))?c.loopAsync(d[72],function(a){return d[75]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[66],d[75]).then(function(a){return a=a,d[76]=a[0],d[77]=a[1],a})},function(a){return d[78]=(d[71].push(d[76]),d[71])}])}):c.resolve()},function(a){return d[75]=(d[65].push(d[71]),d[65]),c.nativeOperation(b("LSGetEncryptionVersionFromSupportedVersionsList.nop"),d[65]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return c.i64.neq(void 0,void 0)?c.resolve(d[74]=void 0):c.sequence([function(a){return d[75]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[76]=a[0],a})},function(a){return d[76]?d[85]=(d[75].push(c.i64.cast([0,0])),d[75]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[77]=a[0],a})},function(a){return d[77]?d[85]=(d[75].push(c.i64.cast([0,2])),d[75]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[78]=a[0],a})},function(a){return d[78]?d[85]=(d[75].push(c.i64.cast([0,3])),d[75]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[79]=a[0],a})},function(a){return d[79]?d[85]=(d[75].push(c.i64.cast([0,4])),d[75]):0,d[80]=c.createArray(),d[81]=c.i64.of_int32(d[75].length),c.i64.gt(d[81],c.i64.cast([0,0]))?c.loopAsync(d[81],function(a){return d[85]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[75],d[85]).then(function(a){return a=a,d[86]=a[0],d[87]=a[1],a})},function(a){return d[88]=(d[80].push(d[86]),d[80])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[85]=c.createArray(),d[86]=c.i64.of_int32(d[80].length),c.i64.gt(d[86],c.i64.cast([0,0]))?c.loopAsync(d[86],function(a){return d[88]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[80],d[88]).then(function(a){return a=a,d[89]=a[0],d[90]=a[1],a})},function(a){return d[91]=(d[85].push(c.i64.to_string(d[89])),d[85])}])}):c.resolve()},function(a){return d[87]=d[85].join(","),d[82]=d[87]}])},function(a){return d[80].some(function(a){return c.i64.eq(d[73],a)})?d[83]=d[73]:d[83]=void 0,c.i64.neq(d[83],void 0)?d[84]=d[83]:d[84]=void 0,d[74]=d[84]}])},function(a){return c.i64.neq(d[74],void 0)?c.resolve(0):(d[75]=["Returning unsupported encyption version, version not supported: ",c.i64.to_string(d[73])].join(""),function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsVersioningUtils] ","",d[75]].join("")),d[76]=c.createArray(),void 0!==void 0?d[77]=(d[76].push(void 0),d[76]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsVersioningUtils",[d[75]].join(""),d[76],c.i64.cast([0,3])))},function(a){return d[37]=d[73]}]):c.sequence([function(a){return function(a){c.logger(a).warn(a)}("[EncryptedBackups][LSEncryptedBackupsVersioningUtils] Device versions table not populated when adding device using QR code"),d[65]=c.createArray(),void 0!==void 0?d[66]=(d[65].push(void 0),d[65]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsVersioningUtils","Device versions table not populated when adding device using QR code",d[65],c.i64.cast([0,2]))},function(a){return d[37]=c.i64.cast([0,0])}])},function(e){return d[38]=a[0].get("temp_ocmf_client_state"),a[0],c.nativeOperation(b("LSOcmfClientEvolve_v2.nop"),d[38]).then(function(a){return a=a,d[39]=a[0],d[40]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[40]).then(function(a){return a=a,d[41]=a[0],a})},function(b){return d[42]=d[22].get("device_public_key"),d[22],d[43]=d[22].get("device_private_key"),d[22],d[44]=d[23].get("epoch_storage_public_key"),d[23],d[45]=d[23].get("epoch_storage_private_key"),d[23],d[46]=d[24].get("epoch_auth_public_key"),d[24],d[47]=d[24].get("epoch_auth_private_key"),d[24],d[48]=a[0].get("mailbox_root_key"),a[0],d[49]=a[0].get("oblivious_validation_token"),a[0],c.forEach(c.filter(c.db.table(168).fetch([[[d[19]]]]),function(a){return c.i64.eq(a.backupId,d[19])&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(168).add({backupId:d[19],devicePublicKeyBlob:d[42],devicePrivateKeyBlob:d[43],epochStoragePublicKeyBlob:d[44],epochStoragePrivateKeyBlob:d[45],epochAuthPublicKeyBlob:d[46],epochAuthPrivateKeyBlob:d[47],mailboxRootKeyBlob:d[48],ocmfClientStateBlob:d[39],obliviousValidationTokenBlob:d[49],authorityLevel:c.i64.cast([0,20]),backupTenancy:c.i64.cast([0,1]),revisionVersion:c.i64.cast([0,1]),encryptionVersion:d[37]})},function(a){return c.blobs.neq(d[48],void 0)?c.sequence([function(a){return d[65]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[48],"private_key",d[43],c.i64.cast([0,1]),d[65]).then(function(a){return a=a,d[66]=a[0],a})},function(a){return c.blobs.neq(d[66],void 0)?d[67]=d[66]:d[67]=void 0,d[50]=d[67]}]):c.resolve(d[50]=void 0)},function(a){return c.blobs.neq(d[50],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[50]).then(function(a){return a=a,d[65]=a[0],a})},function(a){return d[51]=d[65]}]):c.resolve(d[51]=void 0)},function(a){return c.blobs.neq(d[48],void 0)?c.sequence([function(a){return d[65]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[48],"epoch_storage_private_key",d[45],c.i64.cast([0,1]),d[65]).then(function(a){return a=a,d[66]=a[0],a})},function(a){return c.blobs.neq(d[66],void 0)?d[67]=d[66]:d[67]=void 0,d[52]=d[67]}]):c.resolve(d[52]=void 0)},function(a){return c.blobs.neq(d[52],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[52]).then(function(a){return a=a,d[65]=a[0],a})},function(a){return d[53]=d[65]}]):c.resolve(d[53]=void 0)},function(a){return c.blobs.neq(d[48],void 0)?c.sequence([function(a){return d[65]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[48],"epoch_auth_private_key",d[47],c.i64.cast([0,1]),d[65]).then(function(a){return a=a,d[66]=a[0],a})},function(a){return c.blobs.neq(d[66],void 0)?d[67]=d[66]:d[67]=void 0,d[54]=d[67]}]):c.resolve(d[54]=void 0)},function(a){return c.blobs.neq(d[54],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[54]).then(function(a){return a=a,d[65]=a[0],a})},function(a){return d[55]=d[65]}]):c.resolve(d[55]=void 0)},function(a){return d[64]=c.blob("bWFpbGJveF9yb290X2tleQ=="),c.blobs.neq(d[64],void 0)?c.sequence([function(a){return d[65]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[64],"mailbox_root_key",d[48],c.i64.cast([0,1]),d[65]).then(function(a){return a=a,d[66]=a[0],a})},function(a){return c.blobs.neq(d[66],void 0)?d[67]=d[66]:d[67]=void 0,d[56]=d[67]}]):c.resolve(d[56]=void 0)},function(a){return c.blobs.neq(d[56],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[56]).then(function(a){return a=a,d[65]=a[0],a})},function(a){return d[57]=d[65]}]):c.resolve(d[57]=void 0)},function(a){return c.blobs.neq(d[48],void 0)?c.sequence([function(a){return d[65]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[48],"ocmf_client_state",d[39],c.i64.cast([0,1]),d[65]).then(function(a){return a=a,d[66]=a[0],a})},function(a){return c.blobs.neq(d[66],void 0)?d[67]=d[66]:d[67]=void 0,d[58]=d[67]}]):c.resolve(d[58]=void 0)},function(a){return c.blobs.neq(d[58],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[58]).then(function(a){return a=a,d[65]=a[0],a})},function(a){return d[59]=d[65]}]):c.resolve(d[59]=void 0)},function(a){return c.db.table(217).put({backupId:d[19],devicePrivateKeyDebugToken:d[51]==null?"":d[51],epochStoragePrivateKeyDebugToken:d[53]==null?"":d[53],epochAuthPrivateKeyDebugToken:d[55]==null?"":d[55],mailboxRootKeyDebugToken:d[57]==null?"":d[57],ocmfClientStateDebugToken:d[59]==null?"":d[59],appVersion:""})},function(e){return d[60]=a[0].get("add_peer_epoch_data"),a[0],d[61]=c.i64.of_int32(d[60].length),c.i64.gt(d[61],c.i64.cast([0,0]))?c.loopAsync(d[61],function(a){return d[65]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[60],d[65]).then(function(a){return a=a,d[66]=a[0],d[67]=a[1],a})},function(a){return d[68]=d[66].get("epoch_id"),d[66],d[69]=d[66].get("epoch_anon_id"),d[66],d[70]=d[66].get("epoch_root_key"),d[66],d[71]=d[66].get("epoch_status"),d[66],c.forEach(c.filter(c.db.table(169).fetch([[[d[68]]]]),function(a){return c.i64.eq(a.epochId,d[68])&&c.i64.lt(a.authorityLevel,c.i64.cast([0,80]))}),function(a){return a["delete"]()})},function(a){return c.db.table(169).add({epochId:d[68],authorityLevel:c.i64.cast([0,80]),backupId:d[19],epochAnonIdBlob:d[69],epochRootKeyBlob:d[70],epochStatus:d[71]})},function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,20]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,e){var f=a.done;a=a.value;return f?(f=[void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,20])],d[72]=f[0],d[73]=f[1],d[74]=f[2],d[75]=f[3],d[76]=f[4],d[77]=f[5],d[78]=f[6],d[79]=f[7],d[80]=f[8],d[81]=f[9],d[82]=f[10],d[83]=f[11],d[84]=f[12],d[85]=f[13],f):(e=a.item,c.sequence([function(a){return d[91]=e.backupTenancy,d[90]=e.encryptionVersion,c.i64.neq(void 0,void 0)?c.resolve(d[87]=void 0):c.sequence([function(a){return d[92]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[93]=a[0],a})},function(a){return d[93]?d[102]=(d[92].push(c.i64.cast([0,0])),d[92]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[94]=a[0],a})},function(a){return d[94]?d[102]=(d[92].push(c.i64.cast([0,2])),d[92]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[95]=a[0],a})},function(a){return d[95]?d[102]=(d[92].push(c.i64.cast([0,3])),d[92]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[96]=a[0],a})},function(a){return d[96]?d[102]=(d[92].push(c.i64.cast([0,4])),d[92]):0,d[97]=c.createArray(),d[98]=c.i64.of_int32(d[92].length),c.i64.gt(d[98],c.i64.cast([0,0]))?c.loopAsync(d[98],function(a){return d[102]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[92],d[102]).then(function(a){return a=a,d[103]=a[0],d[104]=a[1],a})},function(a){return d[105]=(d[97].push(d[103]),d[97])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[102]=c.createArray(),d[103]=c.i64.of_int32(d[97].length),c.i64.gt(d[103],c.i64.cast([0,0]))?c.loopAsync(d[103],function(a){return d[105]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[97],d[105]).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return d[108]=(d[102].push(c.i64.to_string(d[106])),d[102])}])}):c.resolve()},function(a){return d[104]=d[102].join(","),d[99]=d[104]}])},function(a){return d[97].some(function(a){return c.i64.eq(d[90],a)})?d[100]=d[90]:d[100]=void 0,c.i64.neq(d[100],void 0)?d[101]=d[100]:d[101]=void 0,d[87]=d[101]}])},function(a){return c.i64.neq(d[87],void 0)?d[88]=d[87]:d[88]=c.i64.cast([0,0]),c.i64.neq(d[91],void 0)?d[89]=d[91]:d[89]=c.i64.cast([0,1]),a=[e.backupId,e.deviceId,e.mailboxRootKeyBlob,e.ocmfClientStateBlob,d[88],d[89],e.epochAuthPublicKeyBlob,e.epochAuthPrivateKeyBlob,e.devicePublicKeyBlob,e.devicePrivateKeyBlob,e.epochStoragePublicKeyBlob,e.epochStoragePrivateKeyBlob,e.obliviousValidationTokenBlob,e.authorityLevel],d[72]=a[0],d[73]=a[1],d[74]=a[2],d[75]=a[3],d[76]=a[4],d[77]=a[5],d[78]=a[6],d[79]=a[7],d[80]=a[8],d[81]=a[9],d[82]=a[10],d[83]=a[11],d[84]=a[12],d[85]=a[13],a}]))})},function(a){return c.blobs.neq(d[74],void 0)?c.sequence([function(a){return c.blobs.neq(d[74],void 0)?c.sequence([function(a){return d[89]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[74],"epoch_root_key",d[70],c.i64.cast([0,1]),d[89]).then(function(a){return a=a,d[90]=a[0],a})},function(a){return c.blobs.neq(d[90],void 0)?d[91]=d[90]:d[91]=void 0,d[87]=d[91]}]):c.resolve(d[87]=void 0)},function(a){return c.blobs.neq(d[87],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[87]).then(function(a){return a=a,d[89]=a[0],a})},function(a){return d[88]=d[89]}]):c.resolve(d[88]=void 0)},function(a){return c.db.table(218).put({epochId:d[68],epochAnonId:c.blobs.to_string(d[69]),epochRootKeyDebugToken:d[88]==null?"":d[88],appVersion:""})}]):(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsEncryptedBackupsEpochDebugMetadataV2Table] mailbox_root_key is null, skipping generate epoch debug tokens"),d[87]=c.createArray(),void 0!==void 0?d[88]=(d[87].push(void 0),d[87]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsEncryptedBackupsEpochDebugMetadataV2Table","mailbox_root_key is null, skipping generate epoch debug tokens",d[87],c.i64.cast([0,3])))}])}):c.resolve()},function(a){return c.count(c.db.table(169).fetch()).then(function(a){return d[62]=a})},function(a){return c.i64.le(d[62],c.i64.cast([0,1]))?c.sequence([function(a){return c.db.table(169).fetch().next().then(function(a,e){var f=a.done;a=a.value;return f?c.sequence([function(a){return d[67]="No epoch available in epochs table",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ","",d[67]].join("")),d[68]=c.createArray(),void 0!==void 0?d[69]=(d[68].push(void 0),d[68]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",[d[67]].join(""),d[68],c.i64.cast([0,3]))},function(a){return d[65]=void 0}]):(e=a.item,d[67]=new c.Map(),d[67].set("epoch_id",e.epochId),d[67].set("backup_id",e.backupId),d[67].set("epoch_anon_id_blob",e.epochAnonIdBlob),d[67].set("epoch_root_key_blob",e.epochRootKeyBlob),d[67].set("epoch_status",e.epochStatus),d[67].set("authority_level",e.authorityLevel),d[65]=d[67])})},function(a){return d[63]=d[65]}]):c.sequence([function(a){return d[65]="Multiple epochs available in epochs table",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ","",d[65]].join("")),d[66]=c.createArray(),void 0!==void 0?d[67]=(d[66].push(void 0),d[66]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",[d[65]].join(""),d[66],c.i64.cast([0,3]))},function(a){return d[63]=void 0}])},function(e){return d[63]!==void 0?c.sequence([function(a){return d[65]=d[63].get("epoch_anon_id_blob"),d[63],d[66]=d[63].get("epoch_root_key_blob"),d[63],d[67]=d[22].get("device_public_key"),d[22],d[68]=c.createArray(),d[72]=(d[68].push(c.i64.cast([0,32])),d[68]),c.nativeOperation(b("LSBase64Encode.nop"),d[65]).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[69]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blobs.of_string(["epoch_devices","_",d[69]].join("")),void 0,d[66],d[68]).then(function(a){return a=a,d[72]=a[0],a})},function(a){return d[72]?d[73]=!1:d[73]=!0,d[73]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),d[75]=c.createArray(),void 0!==void 0?d[77]=(d[75].push(void 0),d[75]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",d[75],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[76]=a[0],a})},function(a){return d[74]=d[76]}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[72],c.i64.cast([0,0])).then(function(a){return a=a,d[75]=a[0],d[76]=a[1],a})},function(a){return d[74]=d[75]}])},function(a){return d[70]=d[74]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),d[72]=c.createArray(),void 0!==void 0?d[74]=(d[72].push(void 0),d[72]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",d[72],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[73]=a[0],a})},function(a){return d[70]=d[73]}])},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),d[70],d[67]).then(function(a){return a=a,d[71]=a[0],a})},function(e){return c.blobs.neq(d[71],void 0)?c.sequence([function(a){return d[72]=d[22].get("device_public_key"),d[22],c.nativeOperation(b("LSBase64Encode.nop"),d[72]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[71]).then(function(a){return a=a,d[74]=a[0],a})},function(a){return d[75]=d[63].get("epoch_root_key_blob"),d[63],c.blobs.neq(d[75],void 0)?c.sequence([function(a){return d[100]=c.createArray(),d[106]=(d[100].push(c.i64.cast([0,18])),d[100]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[75],d[100]).then(function(a){return a=a,d[101]=a[0],a})},function(a){return d[101]!==void 0?c.sequence([function(a){return d[106]=c.i64.of_int32(d[101].length),c.i64.ge(d[106],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[101],c.i64.cast([0,0])).then(function(a){return a=a,d[108]=a[0],d[109]=a[1],a})},function(a){return d[107]=d[108]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[108]=c.createArray(),void 0!==void 0?d[109]=(d[108].push(void 0),d[108]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[108],c.i64.cast([0,3]))},function(a){return d[107]=void 0}])},function(a){return d[102]=d[107]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[106]=c.createArray(),void 0!==void 0?d[107]=(d[106].push(void 0),d[106]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[106],c.i64.cast([0,3]))},function(a){return d[102]=void 0}])},function(a){return c.blobs.neq(d[102],void 0)?d[103]=!0:d[103]=!1,d[103]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[102]).then(function(a){return a=a,d[104]=a[0],a})},function(a){return d[104]!==void 0?d[105]=d[104]:d[105]="encodingfailed",d[76]=d[105]}]):c.resolve(d[76]="null")},function(a){return d[77]=d[23].get("epoch_storage_public_key"),d[23],c.nativeOperation(b("LSBase64Encode.nop"),d[77]).then(function(a){return a=a,d[78]=a[0],a})},function(a){return d[79]=d[20].get("epoch_storage_public_key_sig"),d[20],c.nativeOperation(b("LSBase64Encode.nop"),d[79]).then(function(a){return a=a,d[80]=a[0],a})},function(a){return d[81]=d[24].get("epoch_auth_public_key"),d[24],c.nativeOperation(b("LSBase64Encode.nop"),d[81]).then(function(a){return a=a,d[82]=a[0],a})},function(a){return d[83]=d[20].get("epoch_auth_public_key_sig"),d[20],c.nativeOperation(b("LSBase64Encode.nop"),d[83]).then(function(a){return a=a,d[84]=a[0],a})},function(e){return d[85]=d[22].get("device_private_key"),d[22],d[86]=a[0].get("mailbox_root_key"),a[0],d[87]=d[23].get("epoch_storage_private_key"),d[23],c.blobs.neq(d[86],void 0)?c.sequence([function(a){return d[100]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[86],"private_key",d[85],c.i64.cast([0,1]),d[100]).then(function(a){return a=a,d[101]=a[0],a})},function(a){return c.blobs.neq(d[101],void 0)?d[102]=d[101]:d[102]=void 0,d[88]=d[102]}]):c.resolve(d[88]=void 0)},function(a){return c.blobs.neq(d[88],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[88]).then(function(a){return a=a,d[100]=a[0],a})},function(a){return d[89]=d[100]}]):c.resolve(d[89]=void 0)},function(a){return c.blobs.neq(d[86],void 0)?c.sequence([function(a){return d[100]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[86],"ocmf_client_state",d[39],c.i64.cast([0,1]),d[100]).then(function(a){return a=a,d[101]=a[0],a})},function(a){return c.blobs.neq(d[101],void 0)?d[102]=d[101]:d[102]=void 0,d[90]=d[102]}]):c.resolve(d[90]=void 0)},function(a){return c.blobs.neq(d[90],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[90]).then(function(a){return a=a,d[100]=a[0],a})},function(a){return d[91]=d[100]}]):c.resolve(d[91]=void 0)},function(a){return c.blobs.neq(d[86],void 0)?c.sequence([function(a){return d[100]=new c.Map(),c.nativeOperation(b("LSCreateDebugToken.nop"),d[86],"epoch_storage_private_key",d[87],c.i64.cast([0,1]),d[100]).then(function(a){return a=a,d[101]=a[0],a})},function(a){return c.blobs.neq(d[101],void 0)?d[102]=d[101]:d[102]=void 0,d[92]=d[102]}]):c.resolve(d[92]=void 0)},function(a){return c.blobs.neq(d[92],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[92]).then(function(a){return a=a,d[100]=a[0],a})},function(a){return d[93]=d[100]}]):c.resolve(d[93]=void 0)},function(e){return d[94]=a[0].get("backup_id"),a[0],d[95]=a[0].get("server_data_id"),a[0],d[96]=d[63].get("epoch_id"),d[63],d[97]=new c.Map(),d[97].set("supported_encryption_versions",d[26]),d[97].set("client_version",c.i64.cast([0,1])),d[97].set("version_sig",d[35]==null?"":d[35]),d[98]=new c.Map(),d[98].set("backup_id",d[94]),d[98].set("device_epoch_hmac",d[74]==null?"":d[74]),d[98].set("epoch_root_key_fingerprint",d[76]),d[98].set("device_public_key",d[73]==null?"":d[73]),d[98].set("epoch_auth_pubkey",d[82]==null?"":d[82]),d[98].set("epoch_auth_pubkey_sig",d[84]==null?"":d[84]),d[98].set("epoch_storage_pubkey",d[78]==null?"":d[78]),d[98].set("epoch_storage_pubkey_sig",d[80]==null?"":d[80]),d[98].set("ocmf_rotation_token",d[41]==null?"":d[41]),d[98].set("server_data_id",d[95]),d[98].set("device_registration_id",a[1]),d[98].set("base_epoch_id",d[96]),d[98].set("encryption_version_data",d[97]),d[98].set("private_key_debug_token",d[89]),d[98].set("ocmf_client_state_debug_token",d[91]),d[98].set("epoch_storage_pvtkey_debug_token",d[93]),d[98].set("trace_id",d[4]),d[98].set("occam_only_eligible",!0),d[99]=c.toJSON(d[98]),c.storedProcedure(b("LSIssueNewTask"),"encrypted_backups_setup",c.i64.cast([0,50017]),d[99],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] $device_epoch_hmac found to be null"),d[4]!==void 0?c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,85]),c.i64.cast([0,2]),"[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] $device_epoch_hmac found to be null",void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[73]=a[0],a})},function(a){return d[73]?d[74]=!0:d[74]=!1,d[74]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[75]=c.createArray(),void 0!==void 0?d[76]=(d[75].push(void 0),d[75]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[75],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[72]=c.createArray(),d[4]!==void 0?d[73]=(d[72].push(d[4]),d[72]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure","$device_epoch_hmac found to be null",d[72],c.i64.cast([0,3]))},function(a){return c.storedProcedure(b("LSDeleteBackupOnClient"),d[19],"backup_init_flow",!0,d[4],void 0,!1)},function(a){return c.forEach(c.db.table(169).fetch(),function(a){return a["delete"]()})}])}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Error! There should be exactly one open epoch. Deleting local state and terminating device addition"),d[4]!==void 0?c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,85]),c.i64.cast([0,2]),"[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Error! There should be exactly one open epoch. Deleting local state and terminating device addition",void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[66]=a[0],a})},function(a){return d[66]?d[67]=!0:d[67]=!1,d[67]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[68]=c.createArray(),void 0!==void 0?d[69]=(d[68].push(void 0),d[68]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[68],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[65]=c.createArray(),d[4]!==void 0?d[66]=(d[65].push(d[4]),d[65]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure","Error! There should be exactly one open epoch. Deleting local state and terminating device addition",d[65],c.i64.cast([0,3]))},function(a){return c.storedProcedure(b("LSDeleteBackupOnClient"),d[19],"backup_init_flow",!0,d[4],void 0,!1)},function(a){return c.forEach(c.db.table(169).fetch(),function(a){return a["delete"]()})}])}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Error! Error in generating the keys. Deleting local state and terminating device addition"),d[4]!==void 0?c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,85]),c.i64.cast([0,2]),"[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Error! Error in generating the keys. Deleting local state and terminating device addition",void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[24]=!0:d[24]=!1,d[24]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[25]=c.createArray(),void 0!==void 0?d[26]=(d[25].push(void 0),d[25]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[25],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[22]=c.createArray(),d[4]!==void 0?d[23]=(d[22].push(d[4]),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure","Error! Error in generating the keys. Deleting local state and terminating device addition",d[22],c.i64.cast([0,3]))},function(a){return c.storedProcedure(b("LSDeleteBackupOnClient"),d[19],"backup_init_flow",!0,d[4],void 0,!1)},function(a){return c.forEach(c.db.table(169).fetch(),function(a){return a["delete"]()})}])}]):(e.item,d[19]="An authoritative row already exists, aborting execution of add peer device",d[19]!==void 0?c.sequence([function(a){return d[23]=["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ","",d[19]].join(""),function(a){c.logger(a).mustfix(a)}(d[23]),d[20]=c.createArray(),d[4]!==void 0?d[24]=(d[20].push(d[4]),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",d[19],d[20],c.i64.cast([0,3]))},function(a){return d[4]!==void 0?c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,85]),c.i64.cast([0,2]),d[23],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!0:d[25]=!1,d[25]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[26],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[22]=!0:d[22]=!1,d[22]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[24],c.i64.cast([0,3]))):c.resolve()}]):c.sequence([function(a){return d[4]!==void 0?c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[23]=!0:d[23]=!1,d[23]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[24],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}]))})},function(a){return d[11]=c.i64.of_float(Date.now()),d[12]=c.i64.random(),d[16]="Finishing execution. Execution time: ",d[17]=c.i64.to_string(c.i64.sub(d[11],d[0])),d[18]=" ms",d[13]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ",d[13],d[16],d[13],d[17],d[13],d[18]].join("")),c.i64.eq(c.i64.mod_(d[12],c.i64.cast([0,100])),c.i64.cast([0,0]))?(d[19]=",",d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",[d[16],d[19],d[17],d[19],d[18]].join(""),d[20],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSDeserializeSecretsAndAddDevice",["LSArrayGetObjectAt","LSBase64Decode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSFinishAddPeerDevice","LSQplInteractionHelper.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"MEB_DS_DESERIALIZE_SECRETS_NATIVE_OP_START",c.i64.cast([0,0]),void 0)},function(e){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),a[0]).then(function(a){return a=a,d[0]=a[0],a})},function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"MEB_DS_DESERIALIZE_SECRETS_NATIVE_OP_END",c.i64.cast([0,0]),void 0)},function(a){return d[1]=d[0].get("temp_ocmf_client_state"),d[0],c.nativeOperation(b("LSBase64Decode.nop"),d[1]).then(function(a){return a=a,d[2]=a[0],a})},function(a){return d[3]=d[0].get("mailbox_root_key"),d[0],c.nativeOperation(b("LSBase64Decode.nop"),d[3]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return d[5]=d[0].get("oblivious_validation_token"),d[0],c.nativeOperation(b("LSBase64Decode.nop"),d[5]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[7]=c.createArray(),d[8]=d[0].get("add_peer_epoch_data_serializable"),d[0],d[9]=c.i64.of_int32(d[8].length),c.i64.gt(d[9],c.i64.cast([0,0]))?c.loopAsync(d[9],function(a){return d[14]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[8],d[14]).then(function(a){return a=a,d[15]=a[0],d[16]=a[1],a})},function(a){return d[17]=d[15].get("epoch_anon_id"),d[15],c.nativeOperation(b("LSBase64Decode.nop"),d[17]).then(function(a){return a=a,d[18]=a[0],a})},function(a){return d[19]=d[15].get("epoch_root_key"),d[15],c.nativeOperation(b("LSBase64Decode.nop"),d[19]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[21]=d[15].get("epoch_id"),d[15],d[22]=d[15].get("epoch_status"),d[15],d[23]=new c.Map(),d[23].set("epoch_id",d[21]),d[23].set("epoch_anon_id",d[18]==null?c.blob(""):d[18]),d[23].set("epoch_root_key",d[20]==null?c.blob(""):d[20]),d[23].set("epoch_status",d[22]),d[24]=(d[7].push(d[23]),d[7])}])}):c.resolve()},function(e){return d[10]=d[0].get("backup_id"),d[0],d[11]=d[0].get("server_data_id"),d[0],d[12]=new c.Map(),d[12].set("backup_id",d[10]),d[12].set("server_data_id",d[11]),d[12].set("temp_ocmf_client_state",d[2]==null?c.blob(""):d[2]),d[12].set("mailbox_root_key",d[4]==null?c.blob(""):d[4]),d[12].set("oblivious_validation_token",d[6]==null?c.blob(""):d[6]),d[12].set("add_peer_epoch_data",d[7]),d[12]!==void 0?c.sequence([function(e){return c.storedProcedure(b("LSFinishAddPeerDevice"),d[12],a[1])},function(a){return d[13]=!0}]):c.resolve(d[13]=!1)},function(a){return e[0]=d[13]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSDeserializeSecretsAndAddDeviceStoredProcedure",["LSDeserializeSecretsAndAddDevice","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.serializedPayload;d[1]=b.deviceRegistrationId;return c("LSDeserializeSecretsAndAddDevice").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSFetchOTCEligibleEBDevicesV2",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return c.forEach(c.db.table(261).fetch(),function(a){return a["delete"]()})},function(a){return d[0]="",c.forEach(c.filter(c.db.table(261).fetch([[[d[0]]]]),function(a){return a.deviceId===d[0]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(261).add({deviceId:d[0],authorityLevel:c.i64.cast([0,20])})},function(a){return d[1]=new c.Map(),d[2]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewTask"),"meb_fetch_otc_eligible_devices",c.i64.cast([0,50028]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSFetchOTCEligibleEBDevicesV2StoredProcedure",["LSFetchOTCEligibleEBDevicesV2","cr:8709"],(function(a,b,c,d,e,f,g){function a(a){return c("LSFetchOTCEligibleEBDevicesV2")(a)}g["default"]=a}),98);
__d("LSGetActiveSession",["LSLogMebClientEvent.nop","LSQplInteractionHelper.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][getActiveSession] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.count(c.filter(c.db.table(258).fetch(),function(b){return c.i64.eq(b.messageType,c.i64.cast([0,0]))&&c.i64.eq(b.clientType,a[1])&&b.initiatorId===void 0||c.i64.eq(b.clientType,a[1])&&b.initiatorId===a[0]&&![c.i64.cast([0,1]),c.i64.cast([0,2]),c.i64.cast([0,3]),c.i64.cast([0,4]),c.i64.cast([0,21]),c.i64.cast([0,15])].some(function(a){return c.i64.eq(b.messageType,a)})&&c.i64.neq(b.sessionId,c.i64.cast([-1,4294967295]))})).then(function(a){return d[2]=a})},function(e){return c.i64.le(d[2],c.i64.cast([0,1]))?c.sequence([function(e){return c.filter(c.db.table(258).fetch(),function(b){return c.i64.eq(b.messageType,c.i64.cast([0,0]))&&c.i64.eq(b.clientType,a[1])&&b.initiatorId===void 0||c.i64.eq(b.clientType,a[1])&&b.initiatorId===a[0]&&![c.i64.cast([0,1]),c.i64.cast([0,2]),c.i64.cast([0,3]),c.i64.cast([0,4]),c.i64.cast([0,21]),c.i64.cast([0,15])].some(function(a){return c.i64.eq(b.messageType,a)})&&c.i64.neq(b.sessionId,c.i64.cast([-1,4294967295]))}).next().then(function(a,e){var f=a.done;a=a.value;return f?c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,17]))},function(a){return a=[c.i64.cast([-1,4294967295]),void 0,void 0],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]):(e=a.item,c.sequence([function(a){return d[19]=e.responderId,d[19]!==void 0?c.resolve((a=[c.i64.cast([0,0]),e.sessionId,d[19]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a)):c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),"PAKE_DS_SESSION_ONGOING_RESPONDER_ID_NULL_FAILURE",c.i64.cast([0,0]),void 0)},function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,8]))},function(a){return a=[c.i64.cast([-1,4294967294]),void 0,void 0],d[16]=a[0],d[17]=a[1],d[18]=a[2],a}])},function(a){return a=[d[16],d[17],d[18]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return a=[d[12],d[13],d[14]],d[3]=a[0],d[4]=a[1],d[5]=a[2],a}]):c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,18]))},function(a){return a=[c.i64.cast([-1,4294967294]),void 0,void 0],d[3]=a[0],d[4]=a[1],d[5]=a[2],a}])},function(a){return d[6]=c.i64.of_float(Date.now()),d[7]=c.i64.random(),d[9]="Finishing execution. Execution time: ",d[10]=c.i64.to_string(c.i64.sub(d[6],d[0])),d[11]=" ms",d[8]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][getActiveSession] ",d[8],d[9],d[8],d[10],d[8],d[11]].join("")),c.i64.eq(c.i64.mod_(d[7],c.i64.cast([0,100])),c.i64.cast([0,0]))?(d[12]=",",d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"getActiveSession",[d[9],d[12],d[10],d[12],d[11]].join(""),d[13],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[3],d[4],d[5]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSGetActiveSessionStoredProcedure",["LSGetActiveSession","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.initiatorId;d[1]=b.clientType;return c("LSGetActiveSession").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSSendOTCNotifications",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.forEach(c.db.table(285).fetch(),function(a){return a["delete"]()})},function(a){return c.forEach(c.filter(c.db.table(285).fetch([[[c.i64.cast([0,1])]]]),function(a){return c.i64.eq(a.pk,c.i64.cast([0,1]))&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(285).add({pk:c.i64.cast([0,1]),notificationSendingStatus:c.i64.cast([0,2]),authorityLevel:c.i64.cast([0,20])})},function(e){return d[0]=new c.Map(),d[0].set("device_ids",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"meb_send_otc_notifications",c.i64.cast([0,50032]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSSendOTCNotificationsStoredProcedure",["LSSendOTCNotifications","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.deviceIds;return c("LSSendOTCNotifications").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSSendPakeMessage",["LSIssueNewTask","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][sendPakeMessage] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[4])&&c.i64.eq(b.sessionId,a[0])}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[4])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,7]),clientType:a[4]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,7])})}))}):(f=e.item,d[9]=new c.Map(),d[9].set("session_id",a[0]),d[9].set("responder_id",f.responderId),d[9].set("initiator_id",f.initiatorId),d[9].set("message_payload",a[2]==null?f.messagePayload:a[2]),d[9].set("pake_secret",f.pakeSecret),d[9].set("sender_id",a[1]),d[9].set("message_type",a[3]),d[9].set("client_type",a[4]),d[10]=c.toJSON(d[9]),c.storedProcedure(b("LSIssueNewTask"),"PakeMessages",c.i64.cast([0,717]),d[10],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0])))})},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[6]="Finishing execution. Execution time: ",d[7]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[8]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][sendPakeMessage] ",d[5],d[6],d[5],d[7],d[5],d[8]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,100])),c.i64.cast([0,0]))?(d[9]=",",d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"sendPakeMessage",[d[6],d[9],d[7],d[9],d[8]].join(""),d[10],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSSendPakeMessageOne",["LSBase64Encode.nop","LSIssueNewTask","LSLogMebClientEvent.nop","LSQplInteractionHelper.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][sendPakeMessageOne] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.nativeOperation(b("LSBase64Encode.nop"),a[2]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[3])&&c.i64.eq(b.sessionId,a[0])}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,7]))},function(b){return c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[3])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,7]),clientType:a[3]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,7])})}))})}]):(f=e.item,d[10]=f.responderId,d[10]!==void 0?(d[11]=new c.Map(),d[11].set("session_id",a[0]),d[11].set("responder_id",d[10]),d[11].set("initiator_id",a[1]),d[11].set("message_payload",d[2]==null?"":d[2]),d[11].set("pake_secret",void 0),d[11].set("sender_id",a[1]),d[11].set("message_type",c.i64.cast([0,1])),d[11].set("client_type",a[3]),d[12]=c.toJSON(d[11]),c.storedProcedure(b("LSIssueNewTask"),"PakeMessages",c.i64.cast([0,717]),d[12],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):c.sequence([function(a){return c.nativeOperation(b("LSQplInteractionHelper.nop"),void 0,c.i64.cast([0,3]),c.i64.cast([0,8]))},function(b){return c.islc(c.filter(c.db.table(258).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.clientType,a[3])&&c.i64.eq(b.sessionId,a[0])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,d){d=b.done;b=b.value;return d?c.db.table(258).add({sessionId:a[0],messageType:c.i64.cast([0,8]),clientType:a[3]}):(b.item,c.forEach(c.db.table(258).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({messageType:c.i64.cast([0,8])})}))})}]))})},function(a){return d[4]=c.i64.of_float(Date.now()),d[5]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[4],d[0])),d[9]=" ms",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][sendPakeMessageOne] ",d[6],d[7],d[6],d[8],d[6],d[9]].join("")),c.i64.eq(c.i64.mod_(d[5],c.i64.cast([0,100])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"sendPakeMessageOne",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSSendPakeMessageOneStoredProcedure",["LSSendPakeMessageOne","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.sessionId;d[1]=b.initiatorId;d[2]=b.messagePayload;d[3]=b.clientType;return c("LSSendPakeMessageOne").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSSendPakeMessageStoredProcedure",["LSSendPakeMessage","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.sessionId;d[1]=b.senderId;d[2]=b.messagePayload;d[3]=b.messageType;d[4]=b.clientType;return c("LSSendPakeMessage").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWEncryptedBackupsClearRecoveryCode",["Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return(h||(h=b("Promise"))).all([d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.secure_recovery_code_data)),d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.secure_encrypted_backups_recovery_code_status))]).then(function(c){var d=c[0],e=c[1];if(d!=null||e!=null)return a.runInTransaction(function(a){return(h||(h=b("Promise"))).all([(d==null?void 0:d.taskId)!=null?a.secure_recovery_code_data["delete"](d.taskId):(h||(h=b("Promise"))).resolve(),(e==null?void 0:e.pk)!=null?a.secure_encrypted_backups_recovery_code_status["delete"](e.pk):(h||(h=b("Promise"))).resolve()])},"readwrite")})}g.encryptedBackupsClearRecoveryCode=a}),98);
__d("MWChatEBPinCodeVerifyIndicator.react",["fbt","MWXSpinner.react","MWXText.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){a=a.isMessenger;return j.jsxs("div",{className:"x6s0dn4 x78zum5 xl56j7k x135pmgq xwib8y2",children:[j.jsx("div",{className:"x1sxyh0",children:j.jsx(c("MWXSpinner.react"),{color:a?"disabled":"blue",size:12})}),j.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"meta3",children:h._("__JHASH__sqvt0agiqDI__JHASH__")})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsAccessCodeInput.react",["fbt","BaseTextArea.react","MWXText.react","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react")),l=j.useRef,m={bigContainer:{marginTop:"x1xmf6yo",paddingStart:"x1m6arcz",paddingLeft:null,paddingRight:null,paddingEnd:"x13omvei",$$css:!0},containerDefaults:{backgroundColor:"x443n21",borderTopStartRadius:"x1a2cdl4",borderTopEndRadius:"xnhgr82",borderBottomEndRadius:"x1qt0ttw",borderBottomStartRadius:"xgk8upj",paddingBottom:"x1g2khh7",paddingTop:"xyamay9",textAlign:"x2b8uid",":hover_backgroundImage":"x10bruuh",$$css:!0},input:{backgroundColor:"xjbqb8w",borderTopStyle:"x1ejq31n",borderEndStyle:"xd10rxx",borderBottomStyle:"x1sy0etr",borderStartStyle:"x17r0tee",color:"xzsf02u",end:"xds687c",left:null,right:null,fontSize:"x1lkfr7t",fontWeight:"x1s688f",height:"x5yr21d",letterSpacing:"xoiqa5b",lineHeight:"x11m8ghp",overflowX:"x6ikm8r",overflowY:"x10wlt62",paddingBottom:"x18d9i69",paddingTop:"x1y1aw1k",position:"x10l6tqk",start:"x17qophe",top:"x1jzctok",width:"xh8yej3","::placeholder_color":"xha3pab",$$css:!0},inputWrapper:{height:"xwzfr38",marginTop:"xr1yuqi",marginEnd:"xkrivgy",marginBottom:"x4ii5y1",marginStart:"x1gryazu",position:"x1n2onr6",width:"x1hfn5x7",$$css:!0},smallContainer:{marginBottom:"x12nagc",paddingBottom:"x18d9i69",width:"x1s1gtqi",$$css:!0}},n="---- ---- ---- ---- ----\n---- ---- ---- ---- ----",o=40;function a(a){var b=a.autoSubmit,d=b===void 0?!1:b;b=a.disabled;b=b===void 0?!1:b;var e=a.onComplete,f=a.onFocus,g=a.onValueChange,j=a.smallInput,r=a.value;a=l();var s=function(a){return a.toUpperCase().replace(/[^A-Z0-9]/g,"")},t=function(a){a=s(a).substring(0,o);var b=s(r);if(a===b)return;g(a);a.length===o&&d&&(e==null?void 0:e(a))};return k.jsxs("div",{className:(i||(i=c("stylex")))(m.containerDefaults,j?m.smallContainer:m.bigContainer),children:[k.jsx(c("MWXText.react"),{type:"meta3",children:h._("__JHASH__xBAImOW2o36__JHASH__")}),k.jsxs("div",{className:"xwzfr38 xr1yuqi xkrivgy x4ii5y1 x1gryazu x1n2onr6 x1hfn5x7",children:[k.jsx("span",{style:{fontFamily:"var(--font-family-code)"},children:k.jsx(c("BaseTextArea.react"),{disabled:b,maxRows:2,onFocus:f,placeholder:n,readOnly:!0,suppressFocusRing:!0,unresizable:!0,value:r===""?n:q(r),xstyle:m.input})}),k.jsx("span",{style:{fontFamily:"var(--font-family-code)"},children:k.jsx(c("BaseTextArea.react"),{disabled:b,maxRows:2,onFocus:f,onValueChange:t,ref:a,suppressFocusRing:!0,testid:void 0,unresizable:!0,value:r===""?r:p(r),xstyle:m.input})})]})]})}a.displayName=a.name+" [from "+f.id+"]";function p(a){a=a.split("");var b=0,c=[];for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;c.length===24?c.push("\n"):b>0&&b%4===0&&c.push(" ");c.push(f);b+=1}return c.join("")}function q(a){var b=a.split("");return n.split("").map(function(a){if(a===" "||a==="\n"||b.length===0)return a;else{b.pop();return" "}}).join("")}g["default"]=a}),98);
__d("MWChatEncryptedBackupsLayout.react",["FocusRegion.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MWXText.react","react","stylex","xplatToDOMRef"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i.forwardRef;var k={compressedIcon:{marginTop:"x4arcmf",marginEnd:"x1c0yhlu",marginBottom:"x6mlq2k",marginStart:"x15u6uln",$$css:!0},content:{marginStart:"x8vdgqj",marginLeft:null,marginRight:null,marginEnd:"x1gja9t",textAlign:"x2b8uid",$$css:!0},icon:{marginTop:"x1sy10c2",paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",$$css:!0},scrollBar:{maxHeight:"x1jcbksy",overflowY:"x1odjw0f",$$css:!0},stretchContent:{marginStart:"x1mh8g0r",marginLeft:null,marginRight:null,marginEnd:"x11i5rnm",$$css:!0},title:{maxWidth:"x1lr1uin",$$css:!0},titleWithNoIcon:{paddingTop:"x4i7bpe",$$css:!0},titleWithNoIconRestore:{paddingTop:"x1iorvi4",$$css:!0},titleWithNoIconSmall:{paddingTop:"x1xy6bms",$$css:!0},titleWithPadding:{paddingStart:"x5ib6vp",paddingLeft:null,paddingRight:null,paddingEnd:"xc73u3c",$$css:!0}};function a(a,b){var e=a.actionsDirection;e=e===void 0?"row":e;var f=a.children,g=a.focusRegionId,i=a.icon,l=a.innerContentPaddingHorizontal;l=l===void 0?20:l;var m=a.innerContentPaddingVertical;m=m===void 0?20:m;var n=a.outerContentPaddingHorizontal;n=n===void 0?20:n;var o=a.outerContentPaddingVertical;o=o===void 0?20:o;var p=a.primaryAction,q=a.secondaryAction,r=a.showTopMargin;r=r===void 0?!0:r;var s=a.showTopMarginSmall;s=s===void 0?!1:s;var t=a.tertiaryAction,u=a.title,v=a.useBigTitle;v=v===void 0?!1:v;var w=a.useCompressedIcon;w=w===void 0?!1:w;var x=a.useScrollBar;x=x===void 0?!1:x;var y=a.useStretchContent;y=y===void 0?!1:y;a=a.useTightTitle;a=a===void 0?!1:a;g=g==null?p:j.jsx(d("FocusRegion.react").FocusRegion,{id:g,children:p});v=i!=null||v?"headlineEmphasized2":"headlineEmphasized3";a=j.jsx("div",{className:(h||(h=c("stylex")))(a?k.titleWithPadding:null),children:j.jsx(c("MWXText.react"),{align:"center",type:v,children:u})});return j.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:n,paddingVertical:o,ref:d("xplatToDOMRef").xplatToDOMRef(b),spacing:16,children:[i&&j.jsx(c("MWXColumnItem.react"),{children:j.jsx("div",{className:(h||(h=c("stylex")))(w?k.compressedIcon:k.icon),children:i})}),u!=null&&j.jsx(c("MWXColumnItem.react"),{align:"center",children:i!=null?a:j.jsx("div",{className:(h||(h=c("stylex")))(r?k.titleWithNoIcon:k.titleWithNoIconRestore,s?k.titleWithNoIconSmall:null,k.title),children:a})}),j.jsx(c("MWXColumnItem.react"),{align:y?"stretch":"center",paddingHorizontal:l,paddingVertical:m,children:j.jsx("div",{className:h(y?k.stretchContent:k.content,x&&k.scrollBar),children:f})}),(p!=null||q!=null||t!=null)&&j.jsx(c("MWXColumnItem.react"),{align:"stretch",children:e==="row"?j.jsxs(c("MWXRow.react"),{expanding:!0,paddingHorizontal:0,paddingVertical:0,spacing:8,children:[t!=null&&j.jsx(c("MWXRowItem.react"),{expanding:!0,children:t}),q!=null&&j.jsx(c("MWXRowItem.react"),{expanding:!0,children:q}),j.jsx(c("MWXRowItem.react"),{expanding:!0,children:g})]}):j.jsxs(c("MWXColumn.react"),{paddingHorizontal:0,paddingVertical:0,spacing:8,children:[j.jsx(c("MWXColumnItem.react"),{children:g}),q!=null&&j.jsx(c("MWXColumnItem.react"),{children:q}),t!=null&&j.jsx(c("MWXColumnItem.react"),{align:"center",children:t})]})})]})}a.displayName=a.name+" [from "+f.id+"]";e=b(a);g["default"]=e}),98);
__d("MWEncryptedBackupsRecoveryCodeStatus",["FBLogger","I64","LSEncryptedBackupsRecoveryCodeStatus"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=a.onFailure,e=a.onInvalidRecoveryCode,f=a.onSuccess;a=a.recoveryCodeStatusData;if((a==null?void 0:a.length)!==1)return;a=a[0].recoveryCodeStatus;switch((h||(h=d("I64"))).to_int32(a)){case c("LSEncryptedBackupsRecoveryCodeStatus").OPTIMISTIC:return c("LSEncryptedBackupsRecoveryCodeStatus").OPTIMISTIC;case c("LSEncryptedBackupsRecoveryCodeStatus").INVALID:e==null?void 0:e();return c("LSEncryptedBackupsRecoveryCodeStatus").INVALID;case c("LSEncryptedBackupsRecoveryCodeStatus").VALID:f==null?void 0:f();return c("LSEncryptedBackupsRecoveryCodeStatus").VALID;case c("LSEncryptedBackupsRecoveryCodeStatus").SYSTEM_ERROR:b==null?void 0:b();return c("LSEncryptedBackupsRecoveryCodeStatus").SYSTEM_ERROR;default:b==null?void 0:b(),c("FBLogger")("labyrinth_web").mustfix("Invalid Recovery Code Status type")}}g.encryptedBackupsGetRecoveryCodeStatus=a}),98);
__d("useMWEncryptedBackupsAddDevice",["FBLogger","I64","LSAddDeviceStoredProcedure","LSDataTraceCheckPoint","LSEncryptedBackupsBackupTenancy","LSFactory","LSIntEnum","MAWBridgeFireAndForget","MAWTraceUtils","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsDeviceRegistrationId","MWEncryptedBackupsInitializeRestoreDeferred","MWEncryptedBackupsRecoveryCodeStatus","Promise","QPLUserFlow","ReQL","clearTimeout","isInstamadilloEB","promiseDone","react","setTimeout","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;e=l||d("react");var m=e.useCallback,n=e.useEffect,o=e.useRef;function a(a){var e=a.onFailure,f=a.onInvalidRecoveryCode,g=a.onStart,l=a.onSuccess,p=o(null);n(function(){return function(){p.current&&c("clearTimeout")(p.current)}},[]);var q=(i||(i=c("useReStore")))();return m(function(a,i){g();var m=q.table("secure_encrypted_backups_recovery_code_status").subscribe(function(a,b){if(b.operation==="delete")return;c("promiseDone")(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(q.table("secure_encrypted_backups_recovery_code_status"))),function(a){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"add_device_check_rc_status"),d("MWEncryptedBackupsRecoveryCodeStatus").encryptedBackupsGetRecoveryCodeStatus({onFailure:function(){d("MAWTraceUtils").recordFailureAndFlushForTraceId(i,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],"LSEncryptedBackupsRecoveryCodeStatus system error"),c("clearTimeout")(p.current),m(),e()},onInvalidRecoveryCode:function(){d("MAWTraceUtils").recordFailureAndFlushForTraceId(i,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],"Invalid recovery code"),c("clearTimeout")(p.current),m(),f()},onSuccess:function(){d("MAWTraceUtils").recordSuccessAndFlushForTraceId(i,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PLUGIN_CALLING_INITIALIZE_RESTORE),[]),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"add_device_init_restore"),c("clearTimeout")(p.current),m(),!c("isInstamadilloEB")()?(d("MAWBridgeFireAndForget").fireAndForget("backend","checkForDecryptionFailuresToPointRestore"),d("MWEncryptedBackupsInitializeRestoreDeferred").encryptedBackupsInitializeRestoreDeferred({db:q,onFailure:e,onSuccess:l})):(c("QPLUserFlow").endSuccess(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent),l())},recoveryCodeStatusData:a})})});p.current=c("setTimeout")(function(){c("FBLogger")("labyrinth_web").mustfix("Add device failed by timeout 90 sec"),m(),e()},9e4);c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(q.table("encrypted_backups"))).then(function(e){var f=e==null?void 0:e.backupId;if(f!=null){var g=d("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();if(g==="")return(h||(h=b("Promise"))).reject("deviceRegistrationId is not defined");c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"add_device_lsadddevice_sproc");return q.runInTransaction(function(b){return c("LSAddDeviceStoredProcedure")(c("LSFactory")(b),{backupId:f,backupTenancy:(j||(j=d("I64"))).of_int32(c("LSEncryptedBackupsBackupTenancy").PRODUCTION),deviceRegistrationId:g,recoveryCode:a})},"readwrite")}else return(h||(h=b("Promise"))).reject("backupId is not defined")})["catch"](function(a){c("FBLogger")("labyrinth_web").catching(a).mustfix("Add device failed. encrypted_backups table or LSAddDevice sproc"),d("MAWTraceUtils").recordFailureAndFlushForTraceId(i,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],"Add Device Failure"),c("clearTimeout")(p.current),m(),e()}))},[g,q,e,f,l])}g["default"]=a}),98);
__d("useMWChatEncryptedBackupsAddDevice",["MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","promiseDone","react","requireDeferred","useMWEncryptedBackupsAddDevice","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");var j=b.useCallback,k=b.useRef,l=b.useState,m=c("requireDeferred")("MAWEncryptedBackupsClearRecoveryCode").__setRef("useMWChatEncryptedBackupsAddDevice"),n=c("requireDeferred")("MWEncryptedBackupsFetchBackupIds").__setRef("useMWChatEncryptedBackupsAddDevice");function a(a){var b=a.hsmFleetMigrationResetPIN,e=a.onComplete,f=a.onFailure,g=a.onInvalidRecoveryCode,i=a.onStart;a=l(!1);var o=a[0],p=a[1],q=j(function(){p(!1)},[]),r=(h||(h=c("useReStore")))(),s=k(""),t=c("useMWEncryptedBackupsAddDevice")({onFailure:j(function(){q(),f(),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"restore_error",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent})},[f,q]),onInvalidRecoveryCode:j(function(){q(),g()},[q,g]),onStart:j(function(){p(!0),i==null?void 0:i()},[i]),onSuccess:j(function(){n.onReady(function(a){a=a.encryptedBackupsFetchBackupIds;c("promiseDone")(a(r))}),q(),e(),b&&s.current!==""&&b(s.current)},[r,e,q,b])});return[function(a,b,d){s.current=d||"",m.onReady(function(d){d=d.encryptedBackupsClearRecoveryCode;c("promiseDone")(d(r).then(function(){return t(a,b)}))})},o]}g["default"]=a}),98);
__d("MWChatEncryptedBackupsAccessCodeInputStep.react",["fbt","CometProgressButtonIndeterminate.react","CometRelay","MAWWaitForBackendSetup","MWChatEncryptedBackupsAccessCodeInput.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","MWEncryptedBackupsLocalStorageEntryEnum","MWXButton.react","MWXText.react","QPLUserFlow","promiseDone","react","requireDeferred","useEncryptedBackupsQplImpressionRef","useLabyrinthLogging","useMAWEncryptedBackupsRestoreToast","useMWChatEncryptedBackupsAddDevice","useMWEBFlowSourceContext","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useCallback,m=b.useState,n=c("requireDeferred")("MWEBUseLocalStorage").__setRef("MWChatEncryptedBackupsAccessCodeInputStep.react"),o=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("MWChatEncryptedBackupsAccessCodeInputStep.react"),p=c("requireDeferred")("triggerBackupStatusTrigger").__setRef("MWChatEncryptedBackupsAccessCodeInputStep.react"),q=h._("__JHASH__T0C_5M__5DH__JHASH__");function a(a){var b=a.onChooseOtc,e=a.onComplete,f=a.onForgotRC;a=a.shouldShowForgotButton;a=a===void 0?!0:a;var g=(i||(i=c("useReStore")))(),j=h._("__JHASH__7iiwqV3Z6Ok__JHASH__"),r=m(""),s=r[0],t=r[1];r=m(!1);var u=r[0],v=r[1],w=d("CometRelay").useRelayEnvironment();r=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var x=r.startFlow;r=l(function(){d("MWChatEncryptedBackupsLogging").endFailure({errorName:"wrong_recovery_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityKey:c("MWEBODSEntityKey.enum").INCORRECT_RECOVERY_CODE,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),c("QPLUserFlow").markError(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"invalid_recovery_code_input"),v(!0)},[]);var y=c("useMAWEncryptedBackupsRestoreToast")(),z=y.showErrorToast,A=c("useMWEBFlowSourceContext")();y=function(a){u&&v(!1),t(a)};r=c("useMWChatEncryptedBackupsAddDevice")({onComplete:l(function(){var a;c("QPLUserFlow").addPoint((a=d("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success");c("QPLUserFlow").addPoint(a.restoreQplEvent,"restore_auth_finished_and_dismissed");o.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:g,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))});n.onReady(function(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)});d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("MAWWaitForBackendSetup").isBackendSetupSuccessful()}},event:a.restoreQplEvent});d("MWChatEncryptedBackupsLogging").endSuccess({event:a.restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH});e();c("promiseDone")(p.load(),function(a){a({environment:w})})},[g,w,e]),onFailure:l(function(){d("MWChatEncryptedBackupsLogging").endFailure({errorName:"add_device_error",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"add_device_error",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH}),z()},[z]),onInvalidRecoveryCode:r});var B=r[0];r=r[1];var C=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_IMPRESSION",function(){D!=null&&c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_OPTION_DISPLAYED_RESTORE_SCREEN")});a=a?k.jsx(c("MWXButton.react"),{label:h._("__JHASH__TJHhepIDy5c__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_ACTION_DONT_HAVE_RC"),f()},testid:void 0,type:"secondary"}):null;var D=b!==null?k.jsx(c("MWXButton.react"),{label:h._("__JHASH__rIytKXj5Yr0__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),b()},reduceEmphasis:!1,testid:void 0,type:"secondary"}):null;a=D!=null?D:a;return k.jsxs(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",primaryAction:r?k.jsx(c("CometProgressButtonIndeterminate.react"),{label:q}):k.jsx(c("MWXButton.react"),{disabled:s.length<40,label:q,onPress:function(){var a;c("QPLUserFlow").addPoint((a=d("MWChatEncryptedBackupsQPLEvents")).restoreQplEvent,"RESTORE_ENTER_RECOVERY_CODE_SCREEN_ACTION_SUBMIT");var b=A();c("QPLUserFlow").addAnnotations(a.restoreQplEvent,{string:{restore_type:"recovery_code",source:b}});x({additionalAnnotations:{device_type:"OFFLINE"},event:a.restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_RC_RESTORE_AUTH});c("QPLUserFlow").addPoint(a.restoreDeviceAuthQplEvent,"add_device_begin");B(s)},testid:void 0}),ref:C,secondaryAction:r?null:a,showTopMargin:!1,title:h._("__JHASH__8BMtxO3Z_MC__JHASH__"),children:[k.jsx("div",{className:"xwib8y2",children:k.jsx(c("MWXText.react"),{type:"meta3",children:j})}),k.jsx(c("MWChatEncryptedBackupsAccessCodeInput.react"),{onValueChange:y,smallInput:!1,value:s}),u?k.jsx("div",{className:"x5ib6vp xc73u3c xz9dl7a",children:k.jsx(c("MWXText.react"),{align:"center",color:"negative",testid:void 0,type:"meta3",children:h._("__JHASH__a6pa6P3ejkP__JHASH__")})}):null]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsAddonIcon.react",["MWAddOnCircleContainer.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){a=a.icon;return i.jsx(c("MWAddOnCircleContainer.react"),{size:36,children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsAppFacebookconSmall.react",["ix","MWXIcon.react","cr:1376","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:1376")!=null?new(b("cr:1376"))(h("391025"),16,16):d("fbicon")._(h("869051"),20);return j.jsx(c("MWXIcon.react"),{icon:a,size:20})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsAppMessengerIconSmall.react",["MWXIconAppMessenger","MWXIconStrict.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(){return i.jsx(c("MWXIconStrict.react"),{icon:c("MWXIconAppMessenger"),size:20})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsAutoRestoreConsentStep.react",["fbt","FocusRegion.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWDialogText.react","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","MWXButton.react","MWXColumn.react","MWXColumnItem.react","MWXDialogPageLegacy.react","MWXMultiStepDialogHeader.react","MWXRow.react","MWXRowItem.react","QPLUserFlow","focusScopeQueries","gkx","react","stylex","useEncryptedBackupsQplImpressionRef","xplatToDOMRef"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l=c("gkx")("23219"),m={fdsBodyContainer:{paddingBottom:"xwib8y2",paddingEnd:"x1pi30zi",paddingLeft:null,paddingRight:null,paddingStart:"x1swvt13",$$css:!0},fdsContent:{paddingBottom:"x1l90r2v",paddingTop:"xyamay9",$$css:!0},fdsCtaContainer:{paddingBottom:"xwib8y2",paddingTop:"xyamay9",$$css:!0},mdsBodyContainer:{minHeight:"x2lwn1j",$$css:!0},mdsContent:{paddingBottom:"x1l90r2v",paddingTop:"x1y1aw1k",$$css:!0},mdsCtaContainer:{paddingBottom:"xwib8y2",paddingTop:"xyamay9",$$css:!0},mdsHeadingContainer:{marginTop:"x9otpla",$$css:!0}};function a(a){var b=a.onComplete;a=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_CONSENT_SCREEN_IMPRESSION");return k.jsxs(c("MWXDialogPageLegacy.react"),{includeFDSContentPadding_REMOVE_THIS_AFTER_CONTENT_PADDING_MIGRATION:!1,ref:d("xplatToDOMRef").xplatToDOMRef(a),children:[k.jsx("div",{className:(i||(i=c("stylex")))(l?m.mdsHeadingContainer:null),children:k.jsx(c("MWXMultiStepDialogHeader.react"),{title:h._("__JHASH__oOLwSyBIK6Q__JHASH__"),withCloseButton:!1,withoutBackButton:!0})}),k.jsx("div",{className:i(l?m.mdsBodyContainer:m.fdsBodyContainer),children:k.jsxs(c("MWXColumn.react"),{align:"center",testid:void 0,children:[k.jsx(c("MWXColumnItem.react"),{align:l?"center":"start",children:k.jsx("div",{className:i(l?m.mdsContent:m.fdsContent),children:k.jsx(c("MWDialogText.react"),{align:"start",testid:void 0,type:"body",children:h._("__JHASH__8Pc1AS8cP5M__JHASH__")})})}),k.jsx(c("MWXColumnItem.react"),{align:"stretch",children:k.jsx("div",{className:i(l?m.mdsCtaContainer:m.fdsCtaContainer),children:k.jsxs(c("MWXRow.react"),{align:"end",paddingHorizontal:0,paddingVertical:0,spacing:8,children:[k.jsx(c("MWXRowItem.react"),{expanding:l,children:k.jsx(c("MWXButton.react"),{label:h._("__JHASH__qYs0K2Ysi-h__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_CONSENT_DECLINE_CTA_CLICK"),d("MWEBUseLocalStorage").mwEBDeleteLocalStorageEntry(c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT),d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent}),b()},reduceEmphasis:!l,testid:void 0,type:"secondary"})}),k.jsx(c("MWXRowItem.react"),{expanding:l,children:k.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,children:k.jsx(c("MWXButton.react"),{label:h._("__JHASH__9UXa8IqlGXK__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_CONSENT_CONFIRM_CTA_CLICK"),d("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT),d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent}),b()},padding:"wide",testid:void 0,type:"primary"})})})]})})})]})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsCalendarIconSmall.react",["ix","MWXIcon.react","cr:1376","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:1376")!=null?new(b("cr:1376"))(h("275795"),24,24):d("fbicon")._(h("481115"),16);return j.jsx(c("MWXIcon.react"),{icon:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsChatHeadsIconSmall.react",["ix","MWXIcon.react","cr:1376","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:1376")!=null?new(b("cr:1376"))(h("275810"),24,24):d("fbicon")._(h("265785"),16);return j.jsx(c("MWXIcon.react"),{color:"primary",icon:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsCommentLeftRightIconSmall.react",["ix","MWXIcon.react","cr:1376","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:1376")!=null?new(b("cr:1376"))(h("275815"),24,24):d("fbicon")._(h("265797"),16);return j.jsx(c("MWXIcon.react"),{color:"primary",icon:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsRecoveryCodeIcon.react",["ix","CometImageFromIXValue.react","react","stylex","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));j.forwardRef;b=k.forwardRef(a);function a(a,b){var d=a.alt;a=a.xstyle;var e=c("useCurrentDisplayMode")();e=e==="dark";e=e?h("232768"):h("232770");d=k.jsx(c("CometImageFromIXValue.react"),{alt:d,ref:b,source:e});return a==null?d:k.jsx("div",{className:(i||(i=c("stylex")))(a),children:d})}a.displayName=a.name+" [from "+f.id+"]";e=b;g["default"]=e}),98);
__d("MWChatEncryptedBackupsDocumentCompleteIconSmall.react",["MWXIconDocument","MWXIconStrict.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(){return i.jsx(c("MWXIconStrict.react"),{color:"primary",icon:c("MWXIconDocument"),size:16})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsInterstitialIcon.react",["ix","CometImageFromIXValue.react","react","stylex","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));j.forwardRef;b=k.forwardRef(a);function a(a,b){var d=a.alt;a=a.xstyle;var e=c("useCurrentDisplayMode")();e=e==="dark";e=e?h("230225"):h("230227");d=k.jsx(c("CometImageFromIXValue.react"),{alt:d,ref:b,source:e});return a==null?d:k.jsx("div",{className:(i||(i=c("stylex")))(a),children:d})}a.displayName=a.name+" [from "+f.id+"]";e=b;g["default"]=e}),98);
__d("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react",["fbt","MWChatEncryptedBackupsAddonIcon.react","MWChatEncryptedBackupsCalendarIconSmall.react","MWChatEncryptedBackupsDocumentCompleteIconSmall.react","MWChatEncryptedBackupsInterstitialIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWXButton.react","MWXLink.react","MWXListCell.react","MWXTextPairing.react","QPLUserFlow","react","useEncryptedBackupsQplImpressionRef"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more";function a(a){var b=a.onClose,e=a.onDontRestore;a=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_ROAD_IMPRESSION");return j.jsx(c("MWChatEncryptedBackupsLayout.react"),{icon:j.jsx(c("MWChatEncryptedBackupsInterstitialIcon.react"),{}),primaryAction:j.jsx(c("MWXButton.react"),{label:h._("__JHASH__tkVSChmZ_g0__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_GO_TO_CHATS"),e==null?void 0:e(),d("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"END_OF_THE_ROAD_GO_TO_CHATS",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),b()}}),ref:a,title:h._("__JHASH__RAYT217cLHT__JHASH__"),children:j.jsxs("div",{className:"xfdjxqc",children:[j.jsx(c("MWXListCell.react"),{addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsCalendarIconSmall.react"),{})}),content:j.jsx(c("MWXTextPairing.react"),{body:h._("__JHASH__Fg1INZJMXd1__JHASH__"),bodyColor:"secondary",headline:h._("__JHASH__WDpd9l5PzF3__JHASH__"),headlineColor:"primary",level:4})}),j.jsx(c("MWXListCell.react"),{addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsDocumentCompleteIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXTextPairing.react"),{body:h._("__JHASH__J8VXas41L2R__JHASH__",[h._param("helpCenterLink",j.jsx(c("MWXLink.react"),{display:"inline",href:k,onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_OPEN_HELP_CENTER_LINK")},rel:"noreferrer",target:"_blank",children:j.jsx("b",{children:h._("__JHASH__qUG7pS_oNtY__JHASH__")})}))]),bodyColor:"secondary",headline:h._("__JHASH__RTWBSHgVQ3e__JHASH__"),headlineColor:"primary",level:4})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWChatEncryptedBackupsRestore",["MAWEncryptedBackupsRestoreStep.react","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsForgotPinStep","MWEncryptedBackupsForgotRCStep","MWEncryptedBackupsOtcRestoreSteps","react","useMWChatEncryptedBackupsAutoRestoreConsentStep"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useRef;function a(a){var b=a.clientID,e=a.doesUserHaveOtcEligibleDevices,f=a.isGDriveDeviceEnabled,g=a.offlineDevicesCount,h=a.onClose,k=a.onComplete,l=a.shouldShowForgotButton,m=a.startFlow,n=c("useMWChatEncryptedBackupsAutoRestoreConsentStep")({onComplete:k}),o=j(null),p=function(a){o.current=a};return function(a){return function(){m(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent);var j=n.onPushAutoRestoreConsentPage(a);a(function(m){m=m.onReturn;return i.jsx(c("MAWEncryptedBackupsRestoreStep.react"),{clientID:b,isGDriveDeviceEnabled:f,offlineDevicesCount:g,onChooseOtc:e?function(){return d("MWEncryptedBackupsOtcRestoreSteps").pushByOneTimeCodePage({onOtcComplete:j,pushPage:a})}:null,onClose:h,onComplete:j,onForgotPin:function(){d("MWEncryptedBackupsForgotPinStep").pushForgotPinPage({isGDriveDeviceEnabled:f,offlineDeviceCount:g,onClose:h,onComplete:k,pushPage:a})},onForgotRC:function(){d("MWEncryptedBackupsForgotRCStep").pushForgotRCPage({onClose:h,onComplete:k,pushPage:a})},onReturn:m,pushPage:a,setGdrivePopupRef:p,shouldShowForgotButton:l})},{onBack:function(a){return function(){var b;o==null?void 0:(b=o.current)==null?void 0:b.close();a()}}})}}}g.useMWChatEncryptedBackupsRestore=a}),98);
__d("MWChatEncryptedBackupsForgotPinInformationalResetPin.react",["fbt","MAWPinCodeGating","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWChatEncryptedBackupsVirtualDevicesContext.react","MWXButton.react","MWXLink.react","MWXListCell.react","MWXMultiStepDialogHeader.react","MWXTextPairing.react","QPLUserFlow","react","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsRestore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l="https://www.facebook.com/help/messenger-app/479091330683112?ref=learn_more";function a(a){var b=a.onClose,e=a.onCloseDialogWithConfirmation,f=a.onComplete,g=a.onDontRestore,i=a.pushPage;a=k(c("MWChatEncryptedBackupsVirtualDevicesContext.react"));a=a.virtualDeviceInfo;a=d("useMWChatEncryptedBackupsRestore").useMWChatEncryptedBackupsRestore({clientID:d("MAWPinCodeGating").isPinCodeEnabled()?a.vestaClientID:null,doesUserHaveOtcEligibleDevices:a.doesUserHaveOtcEligibleDevices,isGDriveDeviceEnabled:!1,offlineDevicesCount:-1,onClose:b,onComplete:f,shouldShowForgotButton:!1,startFlow:function(){}});f=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_PIN_SCREEN_IMPRESSION");var m=a(i),n=e!=null,o=function(){i(function(){return j.jsxs(j.Fragment,{children:[n?j.jsx(c("MWXMultiStepDialogHeader.react"),{onClose:e,title:null,withCloseButton:!0,withoutBackButton:!0}):null,j.jsx(c("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:b,onDontRestore:g})]})})};return j.jsx(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:j.jsx(c("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),primaryAction:j.jsx(c("MWXButton.react"),{"aria-label":h._("__JHASH__1h1h4bFeUVs__JHASH__"),label:h._("__JHASH__1h1h4bFeUVs__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_PIN_SCREEN_ACTION_ENTER_PIN"),m()},testid:void 0}),ref:f,secondaryAction:j.jsx(c("MWXButton.react"),{label:h._("__JHASH__fCSxuTUraql__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_PIN_SCREEN_ACTION_CANT_RESET_PIN"),o()},type:"secondary"}),title:h._("__JHASH__VE3XhGtWzdv__JHASH__"),children:j.jsxs("div",{className:"xvue9z",children:[j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{body:j.jsxs(j.Fragment,{children:[h._("__JHASH__KVAv3OCshHa__JHASH__")," ",j.jsx(c("MWXLink.react"),{display:"inline",href:l,onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_SCREEN_ACTION_OPEN_LEARN_MORE_LINK")},rel:"noreferrer",target:"_blank",children:j.jsx("b",{children:h._("__JHASH__yk1kU3qH_5u__JHASH__")})})]}),bodyColor:"secondary",headline:h._("__JHASH__wBkfdAzc3F___JHASH__"),level:4})}),j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{body:j.jsxs(j.Fragment,{children:[h._("__JHASH__LpLyXsT2oOr__JHASH__"),j.jsx("br",{}),h._("__JHASH__v4wjDJm-tld__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__mnPynM3vIb8__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__Mu78uJKMi_r__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__8Oq20T6QwSt__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__i0GqH8IhJyO__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__0zO-AR2mh_u__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__H3h7HIYaIzt__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__iCQkImcF2W4__JHASH__")}))])]}),bodyColor:"secondary",headline:h._("__JHASH__1P-NXLa5yF7__JHASH__"),level:4})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsCreatePinInstruction.react",["fbt","MWChatEncryptedBackupsForgotPinInformationalResetPin.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWXButton.react","MWXLink.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","deferredLoadComponent","react","requireDeferred","useEncryptedBackupsQplImpressionRef","useMWEncryptedBackupsListenForChangesToVirtualDevicesV2"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useState,m=c("deferredLoadComponent")(c("requireDeferred")("MWChatEncryptedBackupsPinCodeRestoreStep.react").__setRef("MWChatEncryptedBackupsCreatePinInstruction.react")),n="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function a(a){var b=a.onClose,e=a.onComplete,f=a.pushPage;a=l(!0);var g=a[0];a=a[1];var i=c("useMWEncryptedBackupsListenForChangesToVirtualDevicesV2")(),o=i.vestaClientID;g&&o!=null&&a(!1);var p=k(function(){return f(function(){return j.jsx(c("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:b})})},[b,f]),q=k(function(){return f(function(){return j.jsx(c("MWChatEncryptedBackupsForgotPinInformationalResetPin.react"),{onClose:b,onComplete:e,pushPage:f})})},[b,f,e]),r=k(function(){return f(function(){return o==null?null:j.jsx(m,{clientID:o,onChooseOtc:null,onClose:b,onComplete:e,onForgotPin:q})})},[b,e,f,o,q]);i=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_IMPRESSION");return j.jsxs(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:j.jsx(c("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),primaryAction:j.jsx(c("MWXButton.react"),{disabled:g,label:h._("__JHASH__azfzhOvLeld__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_ENTER_PIN_CLICK"),r()}}),ref:i,secondaryAction:j.jsx(c("MWXButton.react"),{label:h._("__JHASH__JYt7hk4FEPk__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_CANT_CREATE_PIN_CLICK"),p()},type:"secondary"}),children:[j.jsx("div",{className:"xewm4ob",children:j.jsx(c("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:h._("__JHASH__r-UBPe_4xvO__JHASH__")})}),j.jsxs("div",{className:"x169t7cy x19f6ikt xm77wn2 xvue9z",children:[j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__I5BWRfz9kj6__JHASH__"),level:4,meta:j.jsxs(j.Fragment,{children:[h._("__JHASH__66f6j4edNUW__JHASH__")," ",j.jsx(c("MWXLink.react"),{display:"inline",href:n,onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_PIN_SCREEN_LEARN_MORE_LINK_CLICK")},rel:"noreferrer",target:"_blank",children:j.jsx("b",{children:h._("__JHASH__yk1kU3qH_5u__JHASH__")})})]})})}),j.jsx("br",{}),j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__6OnapwRiU-I__JHASH__"),level:4,meta:j.jsxs(c("MWXText.react"),{type:"meta4",children:[h._("__JHASH__Hyp2Dk13FKd__JHASH__"),j.jsx("br",{}),h._("__JHASH__KtIvQ3G8r-K__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__mnPynM3vIb8__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__YLnPm0Rvu_i__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__8Oq20T6QwSt__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__Bvgp1w5pZ4___JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__0zO-AR2mh_u__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__M34cp2-7gGO__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__0dYzuV-3JUF__JHASH__")}))])]})})})]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWChatEncryptedBackupsRCRestoreStep",["MWEncryptedBackupsForgotRCStep","MWEncryptedBackupsOtcRestoreSteps","deferredLoadComponent","react","requireDeferred","useMWChatEncryptedBackupsAutoRestoreConsentStep"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback,k=c("deferredLoadComponent")(c("requireDeferred")("MWChatEncryptedBackupsAccessCodeInputStep.react").__setRef("useMWChatEncryptedBackupsRCRestoreStep"));function a(a){var b=a.onClose,e=a.onComplete,f=a.onForgotRC,g=a.shouldShowForgotButton,h=c("useMWChatEncryptedBackupsAutoRestoreConsentStep")({onComplete:e});return j(function(a){var c,j=a.pushPage;a=a.otcEligibleDevices;a=a===void 0?[]:a;var l=function(){d("MWEncryptedBackupsForgotRCStep").pushForgotRCPage({onClose:b,onComplete:e,pushPage:j})},m=(c=f)!=null?c:l,n=a.length>0,o=h.onPushAutoRestoreConsentPage(j);j(function(){return i.jsx(k,{onChooseOtc:n?function(){return d("MWEncryptedBackupsOtcRestoreSteps").pushByOneTimeCodePage({onOtcComplete:o,pushPage:j})}:null,onComplete:o,onForgotRC:m,shouldShowForgotButton:g})})},[h,b,e,f,g])}g["default"]=a}),98);
__d("MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react",["fbt","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWXButton.react","MWXLink.react","MWXListCell.react","MWXMultiStepDialogHeader.react","MWXTextPairing.react","QPLUserFlow","react","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsRCRestoreStep"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function a(a){var b=a.onClose,e=a.onCloseDialogWithConfirmation,f=a.onComplete,g=a.onDontRestore,i=a.pushPage,l=c("useMWChatEncryptedBackupsRCRestoreStep")({onClose:b,onComplete:f,shouldShowForgotButton:!1}),m=e!=null,n=function(){i(function(){return j.jsxs(j.Fragment,{children:[m?j.jsx(c("MWXMultiStepDialogHeader.react"),{onClose:e,title:null,withCloseButton:!0,withoutBackButton:!0}):null,j.jsx(c("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:f,onDontRestore:g})]})})};a=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_IMPRESSION");return j.jsx(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:j.jsx(c("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),primaryAction:j.jsx(c("MWXButton.react"),{label:h._("__JHASH__DnKZRulcqGe__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_ACTION_ENTER_CODE"),l({pushPage:i})},testid:void 0}),ref:a,secondaryAction:j.jsx(c("MWXButton.react"),{label:h._("__JHASH__wkez3K_SoHV__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_RC_SCREEN_ACTION_CANT_GENERATE_CODE"),n()},type:"secondary"}),title:h._("__JHASH__qROoBeCmzeY__JHASH__"),children:j.jsxs("div",{className:"xvue9z",children:[j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{body:j.jsxs(j.Fragment,{children:[h._("__JHASH__D6e8Mh9DE8a__JHASH__")," ",j.jsx(c("MWXLink.react"),{display:"inline",href:k,onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_TROUBLESHOOT_SCREEN_ACTION_OPEN_LEARN_MORE_LINK")},rel:"noreferrer",target:"_blank",children:j.jsx("b",{children:h._("__JHASH__yk1kU3qH_5u__JHASH__")})})]}),bodyColor:"secondary",headline:h._("__JHASH__aZTN0eX3kw4__JHASH__"),level:4})}),j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{body:j.jsxs(j.Fragment,{children:[h._("__JHASH__HG5XJ8DHe4v__JHASH__"),j.jsx("br",{}),h._("__JHASH__ZfRAIOlNhhF__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__mnPynM3vIb8__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__8h6q580afos__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__8Oq20T6QwSt__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__XEDcoIgGX9g__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__0zO-AR2mh_u__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__TJHGYNx1Byx__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__ORhXAbatdS9__JHASH__")}))])]}),bodyColor:"secondary",headline:h._("__JHASH__csYZJmhxxDs__JHASH__"),level:4})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react",["fbt","MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWChatEncryptedBackupsRestoreEndOfRoadDialog.react","MWXButton.react","MWXLink.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsRCRestoreStep","useMWEncryptedBackupsListenForChangesToVirtualDevicesV2"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useState,m="https://www.facebook.com/help/messenger-app/3357856081116516?ref=learn_more";function a(a){var b=a.onClose,e=a.onComplete,f=a.pushPage;a=l(!0);var g=a[0];a=a[1];var i=c("useMWEncryptedBackupsListenForChangesToVirtualDevicesV2")();i=i.offlineDevicesCount;g&&i>0&&a(!1);var n=k(function(){return f(function(){return j.jsx(c("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react"),{onClose:b})})},[b,f]);i=k(function(){return f(function(){return j.jsx(c("MWChatEncryptedBackupsGenerateNewRecoveryCodeInstruction.react"),{onClose:b,onComplete:e,pushPage:f})})},[b,e,f]);var o=c("useMWChatEncryptedBackupsRCRestoreStep")({onClose:b,onComplete:e,onForgotRC:i,shouldShowForgotButton:!1});a=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_IMPRESSION");return j.jsxs(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:j.jsx(c("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),primaryAction:j.jsx(c("MWXButton.react"),{disabled:g,label:h._("__JHASH__5c2KiSYPIxj__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_ENTER_CODE_CLICK"),o({pushPage:f})}}),ref:a,secondaryAction:j.jsx(c("MWXButton.react"),{label:h._("__JHASH__wkez3K_SoHV__JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_CANT_GENERATE_CODE_CLICK"),n()},type:"secondary"}),children:[j.jsx("div",{className:"xewm4ob",children:j.jsx(c("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:h._("__JHASH__ePYUiQEv2Jf__JHASH__")})}),j.jsxs("div",{className:"x169t7cy x19f6ikt xm77wn2 xvue9z",children:[j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__j4tUcRVJrVr__JHASH__"),level:4,meta:j.jsxs(j.Fragment,{children:[h._("__JHASH__LvOpAmvQ9Zs__JHASH__")," ",j.jsx(c("MWXLink.react"),{display:"inline",href:m,onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_TROUBLESHOOT_RC_SCREEN_LEARN_MORE_LINK_CLICK")},rel:"noreferrer",target:"_blank",children:j.jsx("b",{children:h._("__JHASH__JFv5llOM1oL__JHASH__")})})]})})}),j.jsx("br",{}),j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__PbR9w7iOzwd__JHASH__"),level:4,meta:j.jsxs(c("MWXText.react"),{type:"meta4",children:[h._("__JHASH__HG5XJ8DHe4v__JHASH__"),j.jsx("br",{}),h._("__JHASH__ZfRAIOlNhhF__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__mnPynM3vIb8__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__8h6q580afos__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__8Oq20T6QwSt__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__XEDcoIgGX9g__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__0zO-AR2mh_u__JHASH__")}))]),j.jsx("br",{}),h._("__JHASH__TJHGYNx1Byx__JHASH__",[h._implicitParam("=m1",j.jsx("b",{children:h._("__JHASH__ORhXAbatdS9__JHASH__")}))])]})})})]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsDots3HorizontalIconSmall.react",["ix","MWXIcon.react","cr:1376","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:1376")!=null?new(b("cr:1376"))(h("275834"),24,24):d("fbicon")._(h("484387"),20);return j.jsx(c("MWXIcon.react"),{color:"primary",icon:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsMobileRotateIconSmall.react",["ix","MWXIcon.react","cr:1376","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:1376")!=null?new(b("cr:1376"))(h("275856"),24,24):d("fbicon")._(h("287144"),20);return j.jsx(c("MWXIcon.react"),{color:"primary",icon:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsTextIconSmall.react",["ix","MWXIcon.react","cr:1376","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:1376")!=null?new(b("cr:1376"))(h("275886"),24,24):d("fbicon")._(h("486064"),20);return j.jsx(c("MWXIcon.react"),{color:"primary",icon:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsForgotPinStep.react",["fbt","MWChatEncryptedBackupsAddonIcon.react","MWChatEncryptedBackupsChevronRightIconMedium.react","MWChatEncryptedBackupsForgotPinInformationalResetPin.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsMobileRotateIconSmall.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsTextIconSmall.react","MWXListCellPressable.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","cr:6808","react","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsRCRestoreStep"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var e=a.isGDriveDeviceEnabled,f=a.isRCDeviceEnabled,g=a.onClose,i=a.onComplete,k=a.pushPage,l=function(){k(function(){return j.jsx(c("MWChatEncryptedBackupsForgotPinInformationalResetPin.react"),{onClose:g,onComplete:i,pushPage:k})})},m=c("useMWChatEncryptedBackupsRCRestoreStep")({onClose:g,onComplete:i,shouldShowForgotButton:!0}),n=b("cr:6808")==null?void 0:b("cr:6808")();a=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_OPTIONS_SCREEN_IMPRESSION");return j.jsxs(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",ref:a,showTopMargin:!1,title:h._("__JHASH__aG4R6bxLQ0N__JHASH__"),children:[j.jsx(c("MWXText.react"),{type:"meta3",children:h._("__JHASH__MeLYonSVEOM__JHASH__")}),j.jsxs("div",{className:"x9a3u73 x1p5oq8j xfdjxqc",children:[j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsMobileRotateIconSmall.react"),{})}),addOnStartVerticalAlign:"center","aria-label":h._("__JHASH__S1KydYJcRDi__JHASH__"),content:j.jsx(c("MWXTextPairing.react"),{body:h._("__JHASH__S1KydYJcRDi__JHASH__"),bodyColor:"secondary",headline:h._("__JHASH__QIw_F3RIyEo__JHASH__"),level:4}),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_OPTIONS_SCREEN_ACTION_RESET_PIN"),l()},testid:void 0}),e&&n?j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsTextIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXText.react"),{align:"start",type:"headlineEmphasized4",children:h._("__JHASH__8xIuMgdlV3G__JHASH__")}),onPress:function(){n(k)},testid:void 0}):null,f?j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsTextIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXText.react"),{align:"start",type:"headlineEmphasized4",children:h._("__JHASH__yY8fizSLvt5__JHASH__")}),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_OPTIONS_SCREEN_ACTION_ENTER_RECOVERY_CODE"),m({pushPage:k})},testid:void 0}):null]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsKVSOnlyRestoreStep.react",["fbt","MWChatEncryptedBackupsAddonIcon.react","MWChatEncryptedBackupsChevronRightIconMedium.react","MWChatEncryptedBackupsCreatePinInstruction.react","MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react","MWChatEncryptedBackupsDots3HorizontalIconSmall.react","MWChatEncryptedBackupsInterstitialIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsTextIconSmall.react","MWXListCellPressable.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","useEncryptedBackupsQplImpressionRef"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useCallback;function a(a){var b=a.onClose,e=a.onComplete,f=a.pushPage,g=k(function(){return f(function(){return j.jsx(c("MWChatEncryptedBackupsCreatePinInstruction.react"),{onClose:b,onComplete:e,pushPage:f})})},[b,e,f]),i=k(function(){return f(function(){return j.jsx(c("MWChatEncryptedBackupsCreateRecoveryCodeInstruction.react"),{onClose:b,onComplete:e,pushPage:f})})},[b,e,f]);a=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_OPTIONS_IMPRESSION");return j.jsxs(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:j.jsx(c("MWChatEncryptedBackupsInterstitialIcon.react"),{}),innerContentPaddingVertical:0,ref:a,title:h._("__JHASH__JiPJcQZ2ODs__JHASH__"),children:[j.jsx(c("MWXText.react"),{color:"secondary",type:"body4",children:h._("__JHASH__KBLSFG_4ok9__JHASH__")}),j.jsxs("div",{className:"x1miatn0 x2b8uid xk68kj7",children:[j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsDots3HorizontalIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__U-M3lpEzQQ___JHASH__"),level:4}),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_PIN_CODE_CLICK"),g()}}),j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsTextIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__X81OWLrHpAK__JHASH__"),level:4}),onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_KVS_RECOVERY_CODE_CLICK"),i()}})]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsTriangleErrorIcon.react",["ix","CometImageFromIXValue.react","react","stylex","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));j.forwardRef;b=k.forwardRef(a);function a(a,b){var d=a.alt;a=a.xstyle;var e=c("useCurrentDisplayMode")();e=e==="dark";e=e?h("210377"):h("210379");d=k.jsx(c("CometImageFromIXValue.react"),{alt:d,ref:b,source:e});return a==null?d:k.jsx("div",{className:(i||(i=c("stylex")))(a),children:d})}a.displayName=a.name+" [from "+f.id+"]";e=b;g["default"]=e}),98);
__d("MWChatEncryptedBackupsPinCodeRestoreLockedOutStep.react",["fbt","CometMultiStepDialogPushPageContext.react","MWChatEncryptedBackupsAddonIcon.react","MWChatEncryptedBackupsChatHeadsIconSmall.react","MWChatEncryptedBackupsChevronRightIconMedium.react","MWChatEncryptedBackupsCommentLeftRightIconSmall.react","MWChatEncryptedBackupsForgotPinInformationalResetPin.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsMobileRotateIconSmall.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsTriangleErrorIcon.react","MWXListCellPressable.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k="https://www.facebook.com/help/messenger-app/479091330683112?ref=learn_more";function a(a){var b=a.onClose,e=a.onComplete,f=d("CometMultiStepDialogPushPageContext.react").useCometMultiStepDialogPushPage();a=function(){f(function(){return j.jsx(c("MWChatEncryptedBackupsForgotPinInformationalResetPin.react"),{onClose:b,onComplete:e,pushPage:f})})};var g=c("useVisibilityObserver")({onVisible:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_LOCKED_OUT_STEP")}});return j.jsxs(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:j.jsx(c("MWChatEncryptedBackupsTriangleErrorIcon.react"),{}),ref:g,title:h._("__JHASH__08MwNMdStVe__JHASH__"),children:[j.jsx("div",{className:"xs9mwh0 x9a3u73",children:j.jsx(c("MWXText.react"),{color:"secondary",type:"body3",children:h._("__JHASH__fsEEXH0VivH__JHASH__")})}),j.jsxs("div",{className:"x4i7bpe x2b8uid",children:[j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsMobileRotateIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__xEOaBkE_ZoH__JHASH__"),level:4,meta:h._("__JHASH__r8LpSzwMHb1__JHASH__")}),onPress:a}),j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsChatHeadsIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__4fC8RiYE2g9__JHASH__"),level:4,meta:h._("__JHASH__lI1UNZScHi___JHASH__")}),linkProps:{rel:"noreferrer",target:"_blank",url:k}}),j.jsx(c("MWXListCellPressable.react"),{addOnEnd:j.jsx(c("MWChatEncryptedBackupsChevronRightIconMedium.react"),{}),addOnEndVerticalAlign:"center",addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:j.jsx(c("MWChatEncryptedBackupsCommentLeftRightIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXTextPairing.react"),{headline:h._("__JHASH__B-Vfr0Il-8p__JHASH__"),level:4,meta:h._("__JHASH__c2DpkbbsXfQ__JHASH__")}),onPress:b})]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsPinCodeErrorTimeRemaining.react",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a){var b=Math.floor(a/3600),c=Math.floor(a/60%60);a=Math.floor(a%60);return h._("__JHASH__ab0Dg78FmB___JHASH__",[h._param("time remain in hours",i(b)),h._param("comma separator between hours and minutes",l(c>0&&b>0)),h._param("time remain in minutes",j(c)),h._param("comma separator between minutes ans seconds",l(c>0&&a>0||b>0&&a>0)),h._param("time remain in seconds",k(a))])}function i(a){return a>0?h._("__JHASH__f0VpoPgScIE__JHASH__",[h._plural(a,"hours_remaining")]):""}function j(a){return a>0?h._("__JHASH__oGYOMCWl9O4__JHASH__",[h._plural(a,"minutes_remaining")]):""}function k(a){return a>0?h._("__JHASH__d773yPL7AyI__JHASH__",[h._plural(a,"seconds_remaining")]):""}function l(a){return a?", ":""}g.getPinCodeErrorTimeRemaining=a}),98);
__d("MWChatEncryptedBackupsRestorePinTryAgainStep.react",["fbt","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsPinCodeErrorTimeRemaining.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsRecoveryCodeIcon.react","MWXButton.react","MWXColumn.react","MWXColumnItem.react","MWXLink.react","MWXText.react","QPLUserFlow","react","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=a.attemptsRemaining,e=a.loginTimeoutRemainingSecs;a=a.onClose;var f=c("useVisibilityObserver")({onVisible:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_TRY_AGAIN_BLOCKED_STEP")}});if(e==null||e===0||b==null)return null;var g="https://www.facebook.com/help/messenger-app/479091330683112?ref=learn_more";e=h._("__JHASH__0S8o5lxRkaX__JHASH__",[h._param("time remain in hours, minutes and seconds",d("MWChatEncryptedBackupsPinCodeErrorTimeRemaining.react").getPinCodeErrorTimeRemaining(e))]);b=h._("__JHASH__AuF5ookghAd__JHASH__",[h._plural(b),h._param("attempts_remaining",b)]);return j.jsx(c("MWChatEncryptedBackupsLayout.react"),{actionsDirection:"column",icon:j.jsx(c("MWChatEncryptedBackupsRecoveryCodeIcon.react"),{}),primaryAction:j.jsx(c("MWXButton.react"),{label:h._("__JHASH__YsCkD2gR0KL__JHASH__"),onPress:a,testid:void 0,type:"primary"}),ref:f,title:e,children:j.jsxs(c("MWXColumn.react"),{paddingHorizontal:0,paddingVertical:0,spacing:16,children:[j.jsx(c("MWXColumnItem.react"),{children:j.jsx(c("MWXText.react"),{color:"secondary",type:"body3",children:b})}),j.jsx(c("MWXColumnItem.react"),{children:j.jsxs(c("MWXText.react"),{color:"secondary",type:"body3",children:[h._("__JHASH__eh4i8scQnxd__JHASH__")," ",j.jsx(c("MWXLink.react"),{display:"inline",href:g,rel:"noreferrer",target:"_blank",children:j.jsx("b",{children:h._("__JHASH__ih05KbwaNpJ__JHASH__")})})]})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsPinCodeBlockedStep.react",["MWChatEncryptedBackupsPinCodeRestoreLockedOutStep.react","MWChatEncryptedBackupsRestorePinTryAgainStep.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.attemptsRemaining,d=a.loginTimeoutRemainingSecs,e=a.onClose;a=a.onComplete;var f=b===0;return f?i.jsx(c("MWChatEncryptedBackupsPinCodeRestoreLockedOutStep.react"),{onClose:e,onComplete:a}):d!=null&&d>0&&b!=null?i.jsx(c("MWChatEncryptedBackupsRestorePinTryAgainStep.react"),{attemptsRemaining:b,loginTimeoutRemainingSecs:d,onClose:e}):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsSettingsDialogQuery.graphql",["MWChatEncryptedBackupsSettingsDialogQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWChatEncryptedBackupsSettingsDialogQuery",selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null}],storageKey:null},action:"THROW",path:"viewer"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MWChatEncryptedBackupsSettingsDialogQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("MWChatEncryptedBackupsSettingsDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatEncryptedBackupsSettingsDialogQuery",operationKind:"query",text:null}};b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("useVestaBackupSecretRestore",["Promise","RelayHooks","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("E2EEBackupSecretRestoreModule").__setRef("useVestaBackupSecretRestore"),j=c("requireDeferred")("VestaServerGraphQLLoginProvider").__setRef("useVestaBackupSecretRestore");function a(){var a=d("RelayHooks").useRelayEnvironment();return function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){var d=(yield (h||(h=b("Promise"))).all([j.load(),i.load()])),e=d[0],f=e.beginLogin,g=e.finishLogin;e=e.initLogin;d=d[1].restoreBackupSecret;return d({beginLogin:f,finishLogin:g,initLogin:e},c,{environment:a})});return function(a){return c.apply(this,arguments)}}()}g["default"]=a}),98);
__d("useMWChatEncryptedBackupsPinCodeRestore",["CometRelay","E2EEBackupCommon","FBLogger","JSResourceForInteraction","LSDataTraceCheckPoint","LSDataTraceType","LSIntEnum","MAWTraceUtils","MAWWaitForBackendSetup","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSettingsDialogQuery.graphql","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","MWEBPinCodeSize","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","asyncToGeneratorRuntime","gkx","promiseDone","react","requireDeferred","useLabyrinthLogging","useMWChatEncryptedBackupsAddDevice","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","useReStore","useVestaBackupSecretRestore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e=j||d("react");var k=e.useCallback,l=e.useEffect,m=e.useRef,n=e.useState,o=c("requireDeferred")("MWEBUseLocalStorage").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),p=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),q=c("requireDeferred")("triggerBackupStatusTrigger").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),r=c("requireDeferred")("updateUpsellsStateInRelayStore").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),s=c("JSResourceForInteraction")("MWEncryptedBackupsHsmFleetMigrationGated").__setRef("useMWChatEncryptedBackupsPinCodeRestore");function a(a){var e=a.clientID,f=a.focusRegionId,g=a.onSubmitPin,j=a.onSubmitPinFailure,t=a.onVestaComplete,u=d("CometRelay").useRelayEnvironment();a=n(!1);var v=a[0],w=a[1];a=n(!1);var x=a[0],y=a[1];a=n(!1);var z=a[0],A=a[1],B=c("useVestaBackupSecretRestore")(),C=m(!1);a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var D=a.startFlow,E=(h||(h=c("useReStore")))(),F=c("useMWEBFlowSourceContext")();a=c("useMWChatEncryptedBackupsAddDevice")({hsmFleetMigrationResetPIN:k(function(a){c("promiseDone")(s.load().then(function(b){b({db:E,environment:u,pinCode:a,startFlow:D})}))},[E,u,D]),onComplete:k(function(){var a;c("QPLUserFlow").addPoint((a=d("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success");c("QPLUserFlow").addPoint(a.restoreQplEvent,"restore_auth_finished_and_dismissed");p.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:E,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))});o.onReady(function(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)});d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("MAWWaitForBackendSetup").isBackendSetupSuccessful()}},event:a.restoreQplEvent});d("MWChatEncryptedBackupsLogging").endSuccess({event:a.restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH});t();c("promiseDone")(q.load(),function(a){a({environment:u})})},[E,u,t]),onFailure:k(function(){j==null?void 0:j(),C.current=!0,y(!0),d("MWChatEncryptedBackupsLogging").endFailure({annotations:{bool:{is_backend_setup:d("MAWWaitForBackendSetup").isBackendSetupSuccessful()}},errorName:"add_device_error",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"add_device_error",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("promiseDone")(r.load(),function(a){a({environment:u,updateValue:!1})})},[u,j]),onInvalidRecoveryCode:k(function(){j==null?void 0:j(),C.current=!0,y(!0),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"pin_code_restore_wrong_recovery_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),d("MWChatEncryptedBackupsLogging").endFailure({annotations:{bool:{is_backend_setup:d("MAWWaitForBackendSetup").isBackendSetupSuccessful()}},errorName:"pin_code_restore_wrong_recovery_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),c("promiseDone")(r.load(),function(a){a({environment:u,updateValue:!1})})},[u,j])});var G=a[0];a=a[1];f=d("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode({enableMasking:!0,focusRegionId:f,inputSize:d("MWEBPinCodeSize").EB_PIN_CODE_SIZE,onChange:function(){y(!1),A(!1),w(!1)},onComplete:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("MAWTraceUtils").startNewTrace((i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").SAP_VESTA_LOGIN),d("MAWTraceUtils").CONTEXT_VESTA_LOGIN);g==null?void 0:g();var f=F();c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{restore_type:"pin_code",source:f}});f=new TextDecoder();var h;D({additionalAnnotations:{device_type:"HSM"},event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH});try{c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"vesta_login_begin"),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_SUBMIT"),d("MAWTraceUtils").recordCheckpointForTrace(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").SAP_VESTA_CALLING_VESTA_LOGIN),[],!1),h=f.decode(yield B({clientId:e,productUseCase:c("gkx")("24066")?"IGD_ENC_BACKUP":"MSGR_ENC_BACKUP",vestaAccountPin:a})),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"vesta_login_success"),d("MAWTraceUtils").recordCheckpointForTrace(b,i.ofNumber(c("LSDataTraceCheckPoint").SAP_VESTA_LOGIN_COMPLETION),[],!1)}catch(a){j==null?void 0:j();c("promiseDone")(d("CometRelay").fetchQuery(u,c("MWChatEncryptedBackupsSettingsDialogQuery.graphql"),{}).toPromise());if(a.errorType===d("E2EEBackupCommon").BackupErrorType.INVALID_PASSWORD)w(!0),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"incorrect_pin_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityKey:c("MWEBODSEntityKey.enum").INCORRECT_PIN_CODE,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("QPLUserFlow").markError(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"incorrect_pin_code"),d("MAWTraceUtils").recordFailureAndFlushForTraceId(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],"Incorrect pin code");else{d("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{errorMessage:a.message,errorType:a.errorType}},errorName:"vesta_login_failure",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH});c("QPLUserFlow").markError(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"pin_code_error");A(!0);f="Error when restoring using PIN: "+a;c("FBLogger")("labyrinth_web").mustfix(f);d("MAWTraceUtils").recordFailureAndFlushForTraceId(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],a.toString())}throw a}h!=null&&(d("MAWTraceUtils").recordCheckpointForTrace(b,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PLUGIN_CALLING_ADD_DEVICE),[],!1),c("promiseDone")(r.load(),function(a){a({environment:u,updateValue:!0})}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"add_device_begin"),G(h,b,a))});function f(b){return a.apply(this,arguments)}return f}()});var H=f[0];f=f[1];var I=f.clearNumericInput,J=f.disabled,K=f.focusOnInput;f=f.isLoading;f=f||a;l(function(){C.current&&(I(),C.current=!1)},[I]);return{focusOnInput:K,inputProps:H,isDisabled:(a=J)!=null?a:!1,isInProgress:f,isLabyrinthError:x,isPinCodeIncorrect:v,isVestaError:z}}g.useMWChatEncryptedBackupsPinCodeRestore=a}),98);
__d("MWChatEncryptedBackupsPinCodeRestoreStep.react",["fbt","FocusRegion.react","MWChatEBPinCodeVerifyIndicator.react","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsPinCodeBlockedStep.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsVestaUserInfoContext.react","MWXColumn.react","MWXColumnItem.react","MWXDialogPageLegacy.react","MWXLink.react","MWXMultiStepDialogHeader.react","MWXText.react","QPLUserFlow","focusScopeQueries","gkx","react","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsPinCodeRestore","xplatToDOMRef"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l=c("gkx")("23219"),m="chat-encrypted-backups-dialog-layout-restore-step";function a(a){var b=a.clientID,e=a.onChooseOtc,f=a.onClose,g=a.onComplete,i=a.onForgotPin;a=a.shouldShowForgotButton;a=a===void 0?!0:a;b=d("useMWChatEncryptedBackupsPinCodeRestore").useMWChatEncryptedBackupsPinCodeRestore({clientID:b,focusRegionId:m,onVestaComplete:g});var n=b.focusOnInput,o=b.inputProps,p=b.isInProgress,q=b.isLabyrinthError,r=b.isPinCodeIncorrect;b=b.isVestaError;var s=h._("__JHASH__CPDJhi3l1S1__JHASH__"),t=k(d("MWChatEncryptedBackupsVestaUserInfoContext.react").VestaUserInfoContext),u=t.attemptsRemaining;t=t.loginTimeoutRemainingSecs;var v=u===0,w=v||t!=null&&t>0,x=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_SCREEN",function(){n(),y!=null&&c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_OPTION_DISPLAYED_RESTORE_SCREEN")});a=a?j.jsx(c("MWXLink.react"),{color:l?"primary":"highlight",disabled:w||p,display:"block",onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_FORGOT_PIN_CLICK"),i()},rel:"noreferrer",testid:void 0,children:j.jsx(c("MWXText.react"),{color:w||p?"disabled":"highlight",type:"button2",children:h._("__JHASH__UY_FDJp7Rzt__JHASH__")})}):null;var y=e!==null?j.jsx(c("MWXLink.react"),{color:l?"primary":"highlight",disabled:w||p,display:"block",onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),e()},rel:"noreferrer",testid:void 0,children:j.jsx(c("MWXText.react"),{color:w||p?"disabled":"highlight",type:"button2",children:h._("__JHASH__rIytKXj5Yr0__JHASH__")})}):null;a=y!=null?y:a;var z=h._("__JHASH__6pjlJMQcqkh__JHASH__");w=w?j.jsx(c("MWChatEncryptedBackupsPinCodeBlockedStep.react"),{attemptsRemaining:u,loginTimeoutRemainingSecs:t,onClose:f,onComplete:g}):j.jsx(c("MWXDialogPageLegacy.react"),{callToActionGroupLayout:"expanded",includeFDSContentPadding_REMOVE_THIS_AFTER_CONTENT_PADDING_MIGRATION:!1,ref:d("xplatToDOMRef").xplatToDOMRef(x),children:j.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingVertical:16,spacing:0,children:[j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx(c("MWXText.react"),{align:"center",color:"secondary",type:"body3",children:j.jsx("div",{className:"x1l90r2v x2b8uid",children:s})})}),j.jsxs(c("MWXColumnItem.react"),{align:"center",children:[j.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:r?h._("__JHASH__TG8l6XqQAul__JHASH__"):q||b?h._("__JHASH__oI6Lha5PMTv__JHASH__"):void 0,children:j.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:m,children:j.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},o,{disabled:t!=null||v||p,testid:void 0}))})}),p?j.jsx(c("MWChatEBPinCodeVerifyIndicator.react"),{isMessenger:l}):null]}),j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx("div",{className:"x1y1aw1k",children:a})})]})});return j.jsxs(j.Fragment,{children:[j.jsx(c("MWXMultiStepDialogHeader.react"),{title:z,withCloseButton:!1,withoutBackButton:!0}),w]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWDeserializeSecretsAndAddDevice",["LSDeserializeSecretsAndAddDeviceStoredProcedure","LSFactory"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.initiatorId,d=a.secrets;a=a.storage;return a.runInTransaction(function(a){return c("LSDeserializeSecretsAndAddDeviceStoredProcedure")(c("LSFactory")(a),{deviceRegistrationId:b,serializedPayload:d})},"readwrite")}g["default"]=a}),98);
__d("MWEncryptedBackupsOTCShowNotificationSentToast",["fbt","ix","MWChatEncryptedBackupsQPLEvents","QPLUserFlow","SVGIcon","cr:2344","cr:4027","fbicon","mwPushToast","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||d("react");function a(){var a=b("cr:2344")?k.jsx(b("cr:2344"),{icon:d("fbicon")._(i("477815"),24)}):void 0,e=b("cr:4027")?d("SVGIcon").svgIcon(b("cr:4027")):void 0;d("mwPushToast").mwPushToast({body:h._("__JHASH__jo46UlZ-CxV__JHASH__"),icon:{comet:a,mds:e},testid:"mw-chat-encrypted-backups-otc-notification-sent-successful-toast"});c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_NOTIFICATION_SENT_SUCCESSFUL_TOAST")}g.showOTCNotificationSentToast=a}),98);
__d("MWEncrypedBackupsSendOTCNotifications",["FBLogger","I64","LSAuthorityLevel","LSEncryptedBackupsOpStatus","LSFactory","LSSendOTCNotificationsStoredProcedure","LSVec","MWEncryptedBackupsOTCShowNotificationSentToast","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.db,e=a.onFailure,f=a.onStart,g=a.onSuccess,i=a.onTableUnsubscribe;a=a.otcEligibleDevices;var j=function(a){return b.runInTransaction(function(b){return c("LSSendOTCNotificationsStoredProcedure")(c("LSFactory")(b),{deviceIds:c("LSVec").ofArray(a)})},"readwrite")},k=[];a.map(function(a){return k.push(a.deviceId)});f==null?void 0:f();yield j(k);a=d("ReQL").fromTableAscending(b.tables.encrypted_backups_otc_notification_sending_status);var l=a.subscribe(function(a,b){if(b.operation==="delete")return;a=b.value;if(a==null)return;b=(h||(h=d("I64"))).to_int32(a.authorityLevel);if(b!==c("LSAuthorityLevel").AUTHORITATIVE)return;l();i==null?void 0:i();switch((h||(h=d("I64"))).to_int32(a.notificationSendingStatus)){case c("LSEncryptedBackupsOpStatus").SUCCESS:d("MWEncryptedBackupsOTCShowNotificationSentToast").showOTCNotificationSentToast();g==null?void 0:g();break;case c("LSEncryptedBackupsOpStatus").FAILURE:e();break;case c("LSEncryptedBackupsOpStatus").UNKNOWN:c("FBLogger")("labyrinth_web").mustfix("OTC: Unexpected UNKNOWN status type for notification sending result.");break;default:c("FBLogger")("labyrinth_web").mustfix("OTC: Unexpected UNKNOWN status type for notification sending result.");break}});return l});return i.apply(this,arguments)}g.sendOTCNotifications=a}),98);
__d("MWEncryptedBackupsEligibleDeviceCell.react",["I64","MWChatEncryptedBackupsAddonIcon.react","MWChatEncryptedBackupsAppFacebookconSmall.react","MWChatEncryptedBackupsAppMessengerIconSmall.react","MWXListCell.react","MWXText.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react"),k=[6628568379,173847642670370,350685531728];function a(a){var b=a.deviceAppId,e=a.deviceManufacturer,f=a.deviceModel;a=a.eligibleDeviceCellId;b=(a=b!=null&&k.includes((i||(i=d("I64"))).to_int32(b)))!=null?a:!1;return j.jsx(c("MWXListCell.react"),{addOnStart:j.jsx(c("MWChatEncryptedBackupsAddonIcon.react"),{icon:b?j.jsx(c("MWChatEncryptedBackupsAppFacebookconSmall.react"),{}):j.jsx(c("MWChatEncryptedBackupsAppMessengerIconSmall.react"),{})}),addOnStartVerticalAlign:"center",content:j.jsx(c("MWXText.react"),{type:"headline4",children:e+" "+f}),size:"large",testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("PAKEMessageTypeEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({AWAITING_CLIENT:0,PAKE_MESSAGE_1:1,PAKE_MESSAGE_2_AND_SECRET:2,SESSION_EXPIRED_ERROR:3,MAX_ATTEMPTS_ERROR:4,GENERIC_ERROR:5,MESSAGE_SENT_ERROR:6,PREVIOUS_MESSAGE_MISSING_ERROR:7,INVALID_PREVIOUS_MESSAGE_ERROR:8,ENCRYPTION_ERROR:9,DECRYPTION_ERROR:10,CPACE_STEP_2_ERROR:11,FETCH_SECRETS_ERROR:12,CPACE_STEP_1_ERROR:13,CPACE_STEP_3_ERROR:14,PAKE_HANDSHAKE_SUCCESS:15,SERIALIZATION_ERROR:16,NO_ACTIVE_SESSION:17,MULTIPLE_ACTIVE_SESSIONS_ERROR:18,PROCESS_SECRETS_ERROR:19,TIMEOUT_ERROR:20,FLOW_ABANDONED_ERROR:21,DESERIALIZE_SECRETS_ERROR:22});f["default"]=a}),66);
__d("usePakeQplLogging",["QPLEvent","QPLUserFlow","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useCallback;function a(){var a=j(function(a,b){c("QPLUserFlow").getActiveFlowIDs().includes((i||(i=d("QPLEvent"))).getMarkerId(a))||c("QPLUserFlow").start(a,{annotations:{string:babelHelpers["extends"]({},b)}})},[]),b=j(function(a,b){c("QPLUserFlow").addAnnotations(a,{string:{cancel_end_point:b}}),c("QPLUserFlow").endCancel(a)},[]),e=j(function(a,b,d){c("QPLUserFlow").endFailure(a,b,{annotations:d})},[]),f=j(function(a,b){c("QPLUserFlow").endSuccess(a,{annotations:b})},[]);return{cancelFlow:b,endFailure:e,endSuccess:f,startFlow:a}}g.usePakeQplLogging=a}),98);
__d("useDeserializeSecretsAndAddDevice",["FBLogger","I64","LSEncryptedBackupsRecoveryCodeStatus","LSIntEnum","MWEncryptedBackupsInitializeRestoreDeferred","MWPakeQPLEvents","PAKEMessageTypeEnum","QPLUserFlow","ReQL","promiseDone","react","requireDeferred","usePakeQplLogging","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useCallback,m=b.useEffect,n=b.useRef,o=c("requireDeferred")("MWDeserializeSecretsAndAddDevice").__setRef("useDeserializeSecretsAndAddDevice");function a(){var a=(h||(h=c("useReStore")))(),b=n(function(){}),e=d("usePakeQplLogging").usePakeQplLogging(),f=e.endFailure,g=e.endSuccess;m(function(){return function(){b.current()}},[]);return l(function(e){var h=e.initiatorId,k=e.onAddDeviceFailure,l=e.onAddDeviceFinish,m=e.secrets;o.onReady(function(e){c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_START"),c("promiseDone")(e({initiatorId:h,secrets:m,storage:a}),function(e){e=e[0];e||(c("FBLogger")("labyrinth_web").mustfix("PAKE: deserializeSecretsAndAddDevice sproc failed"),f(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_FAILURE",{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR}}),k());b.current=d("ReQL").fromTableAscending(a.table("secure_encrypted_backups_recovery_code_status")).subscribe(function(e,h){if(h.operation==="add"||h.operation==="put"){e=h.value.recoveryCodeStatus;if((i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsRecoveryCodeStatus").VALID))){b.current();c("QPLUserFlow").addPoint((h=d("MWPakeQPLEvents")).pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_END");l();c("QPLUserFlow").addPoint(h.pakeInitiatorQplEvent,"MEB_INITIALIZE_RESTORE_START");d("MWEncryptedBackupsInitializeRestoreDeferred").encryptedBackupsInitializeRestoreDeferred({db:a,onFailure:function(){f(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"MEB_INITIALIZE_RESTORE_FAILURE",{bool:{isUserError:!1}})}});c("QPLUserFlow").addPoint(h.pakeInitiatorQplEvent,"MEB_INITIALIZE_RESTORE_END");g(h.pakeInitiatorQplEvent)}else if((i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsRecoveryCodeStatus").SYSTEM_ERROR)))c("FBLogger")("labyrinth_web").mustfix("PAKE: LSEncryptedBackupsFinishAddPeerDeviceTask task failed"),f(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"MEB_FINISH_ADD_PEER_DEVICE_FAILURE",{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR}}),k();else{h="PAKE: Unexpected recovery code status: "+(i||(i=d("I64"))).to_int32(e);c("FBLogger")("labyrinth_web").mustfix(h)}}})},function(a){a="PAKE: error when adding new device using OTC, "+a;c("FBLogger")("labyrinth_web").mustfix(a);f(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"MEB_DESERIALIZE_SECRETS_AND_ADD_DEVICE_EXCEPTION",{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").DESERIALIZE_SECRETS_ERROR},string:{exceptionMessage:a}});k();b.current()})})},[f,g,a])}g["default"]=a}),98);
__d("useFetchOTCEligibleEBDevices",["FBLogger","LSAuthorityLevel","LSFactory","LSFetchOTCEligibleEBDevicesV2StoredProcedure","LSIntEnum","ReQL","ReQLSuspense","gkx","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=j||d("react");var k=b.useCallback,l=b.useEffect,m=b.useRef,n=b.useState,o=c("gkx")("24064");function a(){var a=(h||(h=c("useReStore")))(),b=m(!1),e=n(!1),g=e[0],j=e[1];e=n(!1);var p=e[0],q=e[1];e=n(!1);var r=e[0],s=e[1];e=n(!1);var t=e[0],u=e[1];e=n([]);var v=e[0],w=e[1],x=d("ReQLSuspense").useArray(function(){return g?d("ReQL").fromTableAscending(a.table("encrypted_backups_otc_devices")):d("ReQL").empty()},[g,a],f.id+":49"),y=k(function(){return a.runInTransaction(function(a){return c("LSFetchOTCEligibleEBDevicesV2StoredProcedure")(c("LSFactory")(a))},"readwrite")},[a]),z=k(function(){q(!0),s(!1),c("promiseDone")(y(),function(){j(!0)},function(){c("FBLogger")("labyrinth_web").mustfix("Failed to fetch OTC eligible devices")})},[y]);l(function(){if(b.current!==!0)b.current=!0,z();else if(g){var a=x.length>0&&(i||(i=d("LSIntEnum"))).toNumber(x[0].authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC;if(!a){q(!1);j(!1);a=x[0];a=a.deviceId==="-1";if(a){s(!0);c("FBLogger")("labyrinth_web").mustfix("Encrypted Backups OTC: Failed to fetch otc eligible devices.");return}a=x.filter(function(a){return(i||(i=d("LSIntEnum"))).toNumber(a.authorityLevel)!==c("LSAuthorityLevel").OPTIMISTIC&&a.deviceId!==""});w(a);u(a.length>0||o)}}},[y,g,x,z]);return{doesUserHaveOtcEligibleDevices:t,failedToFetchOtcDevices:r,isFetchOtcDevicesInFlight:p,otcEligibleDevices:v,triggerFetchOtcEligibleDevices:z}}g["default"]=a}),98);
__d("PAKEDecryptSecretSprocStatusEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:0,WRONG_KEYS:-1,FAILURE:-2});f["default"]=a}),66);
__d("PAKEGetActiveSessionSprocStatusEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:0,NO_SESSION:-1,FAILURE:-2});f["default"]=a}),66);
__d("PakeCpaceUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a.buffer.slice(a.byteOffset,a.byteLength+a.byteOffset)}function b(a,b){var c=new a.VectorInt();b.forEach(function(a){c.push_back(a)});return c}f.typedArrayToBuffer=a;f.uint8ArrayToVectorInt=b}),66);
__d("pakeCpace",["Promise"],(function(a,b,c,d,e,f){var g,h=function(){var a=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:void 0;return function(c){c=c||{};var c=typeof c!=="undefined"?c:{},d=Object.assign,i,j;c.ready=new(g||(g=b("Promise")))(function(a,b){i=a,j=b});var k=d({},c),l=[],m="./this.program";(function(a,b){throw b});var n=!0,o=!1,p="";function aa(a){return c.locateFile?c.locateFile(a,p):p+a}var ba,ca,da;(n||o)&&(o?p=self.location.href:typeof document!=="undefined"&&document.currentScript&&(p=document.currentScript.src),a&&(p=a),p.indexOf("blob:")!==0?p=p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):p="",(ba=function(a){var b=new XMLHttpRequest();b.open("GET",a,!1);b.send(null);return b.responseText},o&&(da=function(a){var b=new XMLHttpRequest();b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)}),ca=function(a,b,c){var d=new XMLHttpRequest();d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){if(d.status==200||d.status==0&&d.response){b(d.response);return}c()};d.onerror=c;d.send(null)}),function(a){return document.title=a});var ea=c.print||emptyFunction.bind(console),q=c.printErr||emptyFunction.bind(console);d(c,k);k=null;c.arguments&&(l=c.arguments);c.thisProgram&&(m=c.thisProgram);c.quit&&c.quit;var fa=0,r=function(a){fa=a},ga=function(){return fa},s;c.wasmBinary&&(s=c.wasmBinary);c.noExitRuntime||!0;typeof WebAssembly!=="object"&&A("no native wasm support detected");var ha,ia=!1;function ja(a,b){a||A(b)}var ka=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function t(a,b,c){c=b+c;var d=b;while(a[d]&&!(d>=c))++d;if(d-b>16&&a.subarray&&ka)return ka.decode(a.subarray(b,d));else{c="";while(b<d){var e=a[b++];if(!(e&128)){c+=String.fromCharCode(e);continue}var f=a[b++]&63;if((e&224)==192){c+=String.fromCharCode((e&31)<<6|f);continue}var g=a[b++]&63;(e&240)==224?e=(e&15)<<12|f<<6|g:e=(e&7)<<18|f<<12|g<<6|a[b++]&63;if(e<65536)c+=String.fromCharCode(e);else{f=e-65536;c+=String.fromCharCode(55296|f>>10,56320|f&1023)}}}return c}function la(a,b){return a?t(v,a,b):""}function ma(a,b,c,d){if(!(d>0))return 0;var e=c;d=c+d-1;for(var f=0;f<a.length;++f){var g=a.charCodeAt(f);if(g>=55296&&g<=57343){var h=a.charCodeAt(++f);g=65536+((g&1023)<<10)|h&1023}if(g<=127){if(c>=d)break;b[c++]=g}else if(g<=2047){if(c+1>=d)break;b[c++]=192|g>>6;b[c++]=128|g&63}else if(g<=65535){if(c+2>=d)break;b[c++]=224|g>>12;b[c++]=128|g>>6&63;b[c++]=128|g&63}else{if(c+3>=d)break;b[c++]=240|g>>18;b[c++]=128|g>>12&63;b[c++]=128|g>>6&63;b[c++]=128|g&63}}b[c]=0;return c-e}function na(a,b,c){return ma(a,v,b,c)}function oa(a){var b=0;for(var c=0;c<a.length;++c){var d=a.charCodeAt(c);d>=55296&&d<=57343&&(d=65536+((d&1023)<<10)|a.charCodeAt(++c)&1023);d<=127?++b:d<=2047?b+=2:d<=65535?b+=3:b+=4}return b}var pa=typeof TextDecoder!=="undefined"?new TextDecoder("utf-16le"):void 0;function qa(a,b){var c=a,d=c>>1,e=d+b/2;while(!(d>=e)&&za[d])++d;c=d<<1;if(c-a>32&&pa)return pa.decode(v.subarray(a,c));else{e="";for(d=0;!(d>=b/2);++d){c=w[a+d*2>>1];if(c==0)break;e+=String.fromCharCode(c)}return e}}function ra(a,b,c){c===void 0&&(c=2147483647);if(c<2)return 0;c-=2;var d=b;c=c<a.length*2?c/2:a.length;for(var e=0;e<c;++e){var f=a.charCodeAt(e);w[b>>1]=f;b+=2}w[b>>1]=0;return b-d}function sa(a){return a.length*2}function ta(a,b){var c=0,d="";while(!(c>=b/4)){var e=x[a+c*4>>2];if(e==0)break;++c;if(e>=65536){var f=e-65536;d+=String.fromCharCode(55296|f>>10,56320|f&1023)}else d+=String.fromCharCode(e)}return d}function ua(a,b,c){c===void 0&&(c=2147483647);if(c<4)return 0;var d=b;c=d+c-4;for(var e=0;e<a.length;++e){var f=a.charCodeAt(e);if(f>=55296&&f<=57343){var g=a.charCodeAt(++e);f=65536+((f&1023)<<10)|g&1023}x[b>>2]=f;b+=4;if(b+4>c)break}x[b>>2]=0;return b-d}function va(a){var b=0;for(var c=0;c<a.length;++c){var d=a.charCodeAt(c);d>=55296&&d<=57343&&++c;b+=4}return b}function wa(b,a){u.set(b,a)}function xa(b,a,c){for(var d=0;d<b.length;++d)u[a++>>0]=b.charCodeAt(d);c||(u[a>>0]=0)}var ya,u,v,w,za,x,y,Aa,Ba;function Ca(a){ya=a,c.HEAP8=u=new Int8Array(a),c.HEAP16=w=new Int16Array(a),c.HEAP32=x=new Int32Array(a),c.HEAPU8=v=new Uint8Array(a),c.HEAPU16=za=new Uint16Array(a),c.HEAPU32=y=new Uint32Array(a),c.HEAPF32=Aa=new Float32Array(a),c.HEAPF64=Ba=new Float64Array(a)}c.INITIAL_MEMORY||16777216;var Da,Ea=[],Fa=[],Ga=[];function Ha(){if(c.preRun){typeof c.preRun=="function"&&(c.preRun=[c.preRun]);while(c.preRun.length)Ka(c.preRun.shift())}Xa(Ea)}function Ia(){!c.noFSInit&&!K.init.initialized&&K.init(),K.ignorePermissions=!1,I.init(),Xa(Fa)}function Ja(){if(c.postRun){typeof c.postRun=="function"&&(c.postRun=[c.postRun]);while(c.postRun.length)Ma(c.postRun.shift())}Xa(Ga)}function Ka(a){Ea.unshift(a)}function La(a){Fa.unshift(a)}function Ma(a){Ga.unshift(a)}var z=0,Na=null,Oa=null;function Pa(a){return a}function Qa(a){z++,c.monitorRunDependencies&&c.monitorRunDependencies(z)}function Ra(a){z--;c.monitorRunDependencies&&c.monitorRunDependencies(z);if(z==0){Na!==null&&(clearInterval(Na),Na=null);if(Oa){a=Oa;Oa=null;a()}}}c.preloadedImages={};c.preloadedAudios={};function A(a){c.onAbort&&c.onAbort(a);a="Aborted("+a+")";q(a);ia=!0;a+=". Build with -s ASSERTIONS=1 for more info.";a=new WebAssembly.RuntimeError(a);j(a);throw a}var Sa="data:application/octet-stream;base64,";function Ta(a){return a.startsWith(Sa)}var B;B="pakeCpace.wasm";Ta(B)||(B=aa(B));function Ua(a){try{if(a==B&&s)return new Uint8Array(s);if(da)return da(a);else throw"both async and sync fetching of the wasm failed"}catch(a){A(a)}}function Va(){return!s&&(n||o)&&typeof fetch==="function"?fetch(B,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+B+"'";return a.arrayBuffer()})["catch"](function(){return Ua(B)}):(g||(g=b("Promise"))).resolve().then(function(){return Ua(B)})}function Wa(){var b={a:vd};function d(b,a){a=b.exports;c.asm=a;ha=c.asm.ha;Ca(ha.buffer);Da=c.asm.ka;La(c.asm.ia);Ra("wasm-instantiate")}Qa("wasm-instantiate");function g(a){d(a.instance)}function h(a){return Va().then(function(a){return WebAssembly.instantiate(a,b)}).then(function(a){return a}).then(a,function(a){q("failed to asynchronously prepare wasm: "+a),A(a)})}function i(){if(!s&&typeof WebAssembly.instantiateStreaming==="function"&&!Ta(B)&&typeof fetch==="function")return fetch(B,{credentials:"same-origin"}).then(function(a){a=WebAssembly.instantiateStreaming(a,b);return a.then(g,function(a){q("wasm streaming compile failed: "+a);q("falling back to ArrayBuffer instantiation");return h(g)})});else return h(g)}if(c.instantiateWasm)try{var a=c.instantiateWasm(b,d);return a}catch(a){q("Module.instantiateWasm callback failed with error: "+a);return!1}i()["catch"](j);return{}}var C,D;function Xa(a){while(a.length>0){var b=a.shift();if(typeof b=="function"){b(c);continue}var d=b.func;typeof d==="number"?b.arg===void 0?E(d)():E(d)(b.arg):d(b.arg===void 0?null:b.arg)}}function E(a){return Da.get(a)}function Ya(a){return wd(a+16)+16}function Za(a){this.excPtr=a,this.ptr=a-16,this.set_type=function(a){x[this.ptr+4>>2]=a},this.get_type=function(){return x[this.ptr+4>>2]},this.set_destructor=function(a){x[this.ptr+8>>2]=a},this.get_destructor=function(){return x[this.ptr+8>>2]},this.set_refcount=function(a){x[this.ptr>>2]=a},this.set_caught=function(a){a=a?1:0,u[this.ptr+12>>0]=a},this.get_caught=function(){return u[this.ptr+12>>0]!=0},this.set_rethrown=function(a){a=a?1:0,u[this.ptr+13>>0]=a},this.get_rethrown=function(){return u[this.ptr+13>>0]!=0},this.init=function(a,b){this.set_type(a),this.set_destructor(b),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var a=x[this.ptr>>2];x[this.ptr>>2]=a+1},this.release_ref=function(){var a=x[this.ptr>>2];x[this.ptr>>2]=a-1;return a===1}}function $a(a){this.free=function(){X(this.ptr),this.ptr=0},this.set_base_ptr=function(a){x[this.ptr>>2]=a},this.get_base_ptr=function(){return x[this.ptr>>2]},this.set_adjusted_ptr=function(a){x[this.ptr+4>>2]=a},this.get_adjusted_ptr_addr=function(){return this.ptr+4},this.get_adjusted_ptr=function(){return x[this.ptr+4>>2]},this.get_exception_ptr=function(){var a=zd(this.get_exception_info().get_type());if(a)return x[this.get_base_ptr()>>2];a=this.get_adjusted_ptr();return a!==0?a:this.get_base_ptr()},this.get_exception_info=function(){return new Za(this.get_base_ptr())},a===void 0?(this.ptr=wd(8),this.set_adjusted_ptr(0)):this.ptr=a}var ab=[];function bb(a){a.add_ref()}var cb=0;function db(a){a=new $a(a);var b=a.get_exception_info();b.get_caught()||(b.set_caught(!0),cb--);b.set_rethrown(!1);ab.push(a);bb(b);return a.get_exception_ptr()}var F=0;function eb(a){try{return X(new Za(a).ptr)}catch(a){}}function fb(a){if(a.release_ref()&&!a.get_rethrown()){var b=a.get_destructor();b&&E(b)(a.excPtr);eb(a.excPtr)}}function gb(){Y(0);var a=ab.pop();fb(a.get_exception_info());a.free();F=0}function hb(a){a=new $a(a);var b=a.get_base_ptr();F||(F=b);a.free();throw b}function ib(){var a=F;if(!a){r(0);return 0|0}var b=new Za(a),c=b.get_type(),d=new $a();d.set_base_ptr(a);d.set_adjusted_ptr(a);if(!c){r(0);return d.ptr|0}var e=Array.prototype.slice.call(arguments);for(var f=0;f<e.length;f++){var g=e[f];if(g===0||g===c)break;if(yd(g,c,d.get_adjusted_ptr_addr())){r(g);return d.ptr|0}}r(c);return d.ptr|0}function jb(){var a=F;if(!a){r(0);return 0|0}var b=new Za(a),c=b.get_type(),d=new $a();d.set_base_ptr(a);d.set_adjusted_ptr(a);if(!c){r(0);return d.ptr|0}var e=Array.prototype.slice.call(arguments);for(var f=0;f<e.length;f++){var g=e[f];if(g===0||g===c)break;if(yd(g,c,d.get_adjusted_ptr_addr())){r(g);return d.ptr|0}}r(c);return d.ptr|0}function kb(){var a=ab.pop();a||A("no exception to throw");var b=a.get_exception_info(),c=a.get_base_ptr();!b.get_rethrown()?(ab.push(a),b.set_rethrown(!0),b.set_caught(!1),cb++):a.free();F=c;throw c}function lb(a,b,c){var d=new Za(a);d.init(b,c);F=a;cb++;throw a}function mb(){return cb}var G={splitPath:function(a){var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return b.exec(a).slice(1)},normalizeArray:function(a,b){var c=0;for(var d=a.length-1;d>=0;d--){var e=a[d];e==="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c;c--)a.unshift("..");return a},normalize:function(a){var b=a.charAt(0)==="/",c=a.substr(-1)==="/";a=G.normalizeArray(a.split("/").filter(function(a){return!!a}),!b).join("/");!a&&!b&&(a=".");a&&c&&(a+="/");return(b?"/":"")+a},dirname:function(a){a=G.splitPath(a);var b=a[0];a=a[1];if(!b&&!a)return".";a&&(a=a.substr(0,a.length-1));return b+a},basename:function(a){if(a==="/")return"/";a=G.normalize(a);a=a.replace(/\/$/,"");var b=a.lastIndexOf("/");return b===-1?a:a.substr(b+1)},extname:function(a){return G.splitPath(a)[3]},join:function(){var a=Array.prototype.slice.call(arguments,0);return G.normalize(a.join("/"))},join2:function(a,b){return G.normalize(a+"/"+b)}};function nb(){if(typeof crypto==="object"&&typeof crypto.getRandomValues==="function"){var a=new Uint8Array(1);return function(){crypto.getRandomValues(a);return a[0]}}else return function(){A("randomDevice")}}var H={resolve:function(){var a="",b=!1;for(var c=arguments.length-1;c>=-1&&!b;c--){var d=c>=0?arguments[c]:K.cwd();if(typeof d!=="string")throw new TypeError("Arguments to path.resolve must be strings");else if(!d)return"";a=d+"/"+a;b=d.charAt(0)==="/"}a=G.normalizeArray(a.split("/").filter(function(a){return!!a}),!b).join("/");return(b?"/":"")+a||"."},relative:function(a,b){a=H.resolve(a).substr(1);b=H.resolve(b).substr(1);function c(a){var b=0;for(;b<a.length;b++)if(a[b]!=="")break;var c=a.length-1;for(;c>=0;c--)if(a[c]!=="")break;return b>c?[]:a.slice(b,c-b+1)}a=c(a.split("/"));c=c(b.split("/"));b=Math.min(a.length,c.length);var d=b;for(var e=0;e<b;e++)if(a[e]!==c[e]){d=e;break}b=[];for(var e=d;e<a.length;e++)b.push("..");b=b.concat(c.slice(d));return b.join("/")}},I={ttys:[],init:function(){},shutdown:function(){},register:function(a,b){I.ttys[a]={input:[],output:[],ops:b},K.registerDevice(a,I.stream_ops)},stream_ops:{open:function(a){var b=I.ttys[a.node.rdev];if(!b)throw new K.ErrnoError(43);a.tty=b;a.seekable=!1},close:function(a){a.tty.ops.flush(a.tty)},flush:function(a){a.tty.ops.flush(a.tty)},read:function(b,a,c,d,e){if(!b.tty||!b.tty.ops.get_char)throw new K.ErrnoError(60);e=0;for(var f=0;f<d;f++){var g;try{g=b.tty.ops.get_char(b.tty)}catch(a){throw new K.ErrnoError(29)}if(g===void 0&&e===0)throw new K.ErrnoError(6);if(g===null||g===void 0)break;e++;a[c+f]=g}e&&(b.node.timestamp=Date.now());return e},write:function(b,a,c,d,e){if(!b.tty||!b.tty.ops.put_char)throw new K.ErrnoError(60);try{for(var f=0;f<d;f++)b.tty.ops.put_char(b.tty,a[c+f])}catch(a){throw new K.ErrnoError(29)}d&&(b.node.timestamp=Date.now());return f}},default_tty_ops:{get_char:function(a){if(!a.input.length){var b=null;typeof window!="undefined"&&typeof window.prompt=="function"?(b=window.prompt("Input: "),b!==null&&(b+="\n")):typeof readline=="function"&&(b=readline(),b!==null&&(b+="\n"));if(!b)return null;a.input=ud(b,!0)}return a.input.shift()},put_char:function(a,b){b===null||b===10?(ea(t(a.output,0)),a.output=[]):b!=0&&a.output.push(b)},flush:function(a){a.output&&a.output.length>0&&(ea(t(a.output,0)),a.output=[])}},default_tty1_ops:{put_char:function(a,b){b===null||b===10?(q(t(a.output,0)),a.output=[]):b!=0&&a.output.push(b)},flush:function(a){a.output&&a.output.length>0&&(q(t(a.output,0)),a.output=[])}}};function ob(a){A()}var J={ops_table:null,mount:function(a){return J.createNode(null,"/",16384|511,0)},createNode:function(a,b,c,d){if(K.isBlkdev(c)||K.isFIFO(c))throw new K.ErrnoError(63);J.ops_table||(J.ops_table={dir:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr,lookup:J.node_ops.lookup,mknod:J.node_ops.mknod,rename:J.node_ops.rename,unlink:J.node_ops.unlink,rmdir:J.node_ops.rmdir,readdir:J.node_ops.readdir,symlink:J.node_ops.symlink},stream:{llseek:J.stream_ops.llseek}},file:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr},stream:{llseek:J.stream_ops.llseek,read:J.stream_ops.read,write:J.stream_ops.write,allocate:J.stream_ops.allocate,mmap:J.stream_ops.mmap,msync:J.stream_ops.msync}},link:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr,readlink:J.node_ops.readlink},stream:{}},chrdev:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr},stream:K.chrdev_stream_ops}});c=K.createNode(a,b,c,d);K.isDir(c.mode)?(c.node_ops=J.ops_table.dir.node,c.stream_ops=J.ops_table.dir.stream,c.contents={}):K.isFile(c.mode)?(c.node_ops=J.ops_table.file.node,c.stream_ops=J.ops_table.file.stream,c.usedBytes=0,c.contents=null):K.isLink(c.mode)?(c.node_ops=J.ops_table.link.node,c.stream_ops=J.ops_table.link.stream):K.isChrdev(c.mode)&&(c.node_ops=J.ops_table.chrdev.node,c.stream_ops=J.ops_table.chrdev.stream);c.timestamp=Date.now();a&&(a.contents[b]=c,a.timestamp=c.timestamp);return c},getFileDataAsTypedArray:function(a){if(!a.contents)return new Uint8Array(0);return a.contents.subarray?a.contents.subarray(0,a.usedBytes):new Uint8Array(a.contents)},expandFileStorage:function(a,b){var c=a.contents?a.contents.length:0;if(c>=b)return;var d=1024*1024;b=Math.max(b,c*(c<d?2:1.125)>>>0);c!=0&&(b=Math.max(b,256));d=a.contents;a.contents=new Uint8Array(b);a.usedBytes>0&&a.contents.set(d.subarray(0,a.usedBytes),0)},resizeFileStorage:function(a,b){if(a.usedBytes==b)return;if(b==0)a.contents=null,a.usedBytes=0;else{var c=a.contents;a.contents=new Uint8Array(b);c&&a.contents.set(c.subarray(0,Math.min(b,a.usedBytes)));a.usedBytes=b}},node_ops:{getattr:function(a){var b={};b.dev=K.isChrdev(a.mode)?a.id:1;b.ino=a.id;b.mode=a.mode;b.nlink=1;b.uid=0;b.gid=0;b.rdev=a.rdev;K.isDir(a.mode)?b.size=4096:K.isFile(a.mode)?b.size=a.usedBytes:K.isLink(a.mode)?b.size=a.link.length:b.size=0;b.atime=new Date(a.timestamp);b.mtime=new Date(a.timestamp);b.ctime=new Date(a.timestamp);b.blksize=4096;b.blocks=Math.ceil(b.size/b.blksize);return b},setattr:function(a,b){b.mode!==void 0&&(a.mode=b.mode),b.timestamp!==void 0&&(a.timestamp=b.timestamp),b.size!==void 0&&J.resizeFileStorage(a,b.size)},lookup:function(a,b){throw K.genericErrors[44]},mknod:function(a,b,c,d){return J.createNode(a,b,c,d)},rename:function(a,b,c){if(K.isDir(a.mode)){var d;try{d=K.lookupNode(b,c)}catch(a){}if(d)for(var e in d.contents)throw new K.ErrnoError(55)}delete a.parent.contents[a.name];a.parent.timestamp=Date.now();a.name=c;b.contents[c]=a;b.timestamp=a.parent.timestamp;a.parent=b},unlink:function(a,b){delete a.contents[b],a.timestamp=Date.now()},rmdir:function(a,b){var c=K.lookupNode(a,b);for(c in c.contents)throw new K.ErrnoError(55);delete a.contents[b];a.timestamp=Date.now()},readdir:function(a){var b=[".",".."];for(var c in a.contents){if(!Object.prototype.hasOwnProperty.call(a.contents,c))continue;b.push(c)}return b},symlink:function(a,b,c){a=J.createNode(a,b,511|40960,0);a.link=c;return a},readlink:function(a){if(!K.isLink(a.mode))throw new K.ErrnoError(28);return a.link}},stream_ops:{read:function(b,a,c,d,e){var f=b.node.contents;if(e>=b.node.usedBytes)return 0;b=Math.min(b.node.usedBytes-e,d);if(b>8&&f.subarray)a.set(f.subarray(e,e+b),c);else for(d=0;d<b;d++)a[c+d]=f[e+d];return b},write:function(b,a,c,d,e,f){if(!d)return 0;b=b.node;b.timestamp=Date.now();if(a.subarray&&(!b.contents||b.contents.subarray))if(f){b.contents=a.subarray(c,c+d);b.usedBytes=d;return d}else if(b.usedBytes===0&&e===0){b.contents=a.slice(c,c+d);b.usedBytes=d;return d}else if(e+d<=b.usedBytes){b.contents.set(a.subarray(c,c+d),e);return d}J.expandFileStorage(b,e+d);if(b.contents.subarray&&a.subarray)b.contents.set(a.subarray(c,c+d),e);else for(f=0;f<d;f++)b.contents[e+f]=a[c+f];b.usedBytes=Math.max(b.usedBytes,e+d);return d},llseek:function(a,b,c){b=b;c===1?b+=a.position:c===2&&(K.isFile(a.node.mode)&&(b+=a.node.usedBytes));if(b<0)throw new K.ErrnoError(28);return b},allocate:function(a,b,c){J.expandFileStorage(a.node,b+c),a.node.usedBytes=Math.max(a.node.usedBytes,b+c)},mmap:function(a,b,c,d,e,f){if(b!==0)throw new K.ErrnoError(28);if(!K.isFile(a.node.mode))throw new K.ErrnoError(43);e=a.node.contents;if(!(f&2)&&e.buffer===ya)b=!1,a=e.byteOffset;else{(d>0||d+c<e.length)&&(e.subarray?e=e.subarray(d,d+c):e=Array.prototype.slice.call(e,d,d+c));b=!0;a=ob(c);if(!a)throw new K.ErrnoError(48);u.set(e,a)}return{ptr:a,allocated:b}},msync:function(b,a,c,d,e){if(!K.isFile(b.node.mode))throw new K.ErrnoError(43);if(e&2)return 0;J.stream_ops.write(b,a,0,d,c,!1);return 0}}};function pb(a,b,c,d){var e=d?"":Pa("al "+a);ca(a,function(c){ja(c,'Loading data file "'+a+'" failed (no arrayBuffer).'),b(new Uint8Array(c)),e&&Ra(e)},function(b){if(c)c();else throw'Loading data file "'+a+'" failed.'});e&&Qa(e)}var K={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(a,b){b===void 0&&(b={});a=H.resolve(K.cwd(),a);if(!a)return{path:"",node:null};var c={follow_mount:!0,recurse_count:0};for(var d in c)b[d]===void 0&&(b[d]=c[d]);if(b.recurse_count>8)throw new K.ErrnoError(32);c=G.normalizeArray(a.split("/").filter(function(a){return!!a}),!1);d=K.root;a="/";for(var e=0;e<c.length;e++){var f=e===c.length-1;if(f&&b.parent)break;d=K.lookupNode(d,c[e]);a=G.join2(a,c[e]);K.isMountpoint(d)&&((!f||f&&b.follow_mount)&&(d=d.mounted.root));if(!f||b.follow){f=0;while(K.isLink(d.mode)){var g=K.readlink(a);a=H.resolve(G.dirname(a),g);g=K.lookupPath(a,{recurse_count:b.recurse_count});d=g.node;if(f++>40)throw new K.ErrnoError(32)}}}return{path:a,node:d}},getPath:function(a){var b;while(!0){if(K.isRoot(a)){var c=a.mount.mountpoint;return!b?c:c[c.length-1]!=="/"?c+"/"+b:c+b}b=b?a.name+"/"+b:a.name;a=a.parent}},hashName:function(a,b){var c=0;for(var d=0;d<b.length;d++)c=(c<<5)-c+b.charCodeAt(d)|0;return(a+c>>>0)%K.nameTable.length},hashAddNode:function(a){var b=K.hashName(a.parent.id,a.name);a.name_next=K.nameTable[b];K.nameTable[b]=a},hashRemoveNode:function(a){var b=K.hashName(a.parent.id,a.name);if(K.nameTable[b]===a)K.nameTable[b]=a.name_next;else{b=K.nameTable[b];while(b){if(b.name_next===a){b.name_next=a.name_next;break}b=b.name_next}}},lookupNode:function(a,b){var c=K.mayLookup(a);if(c)throw new K.ErrnoError(c,a);c=K.hashName(a.id,b);for(c=K.nameTable[c];c;c=c.name_next){var d=c.name;if(c.parent.id===a.id&&d===b)return c}return K.lookup(a,b)},createNode:function(a,b,c,d){a=new K.FSNode(a,b,c,d);K.hashAddNode(a);return a},destroyNode:function(a){K.hashRemoveNode(a)},isRoot:function(a){return a===a.parent},isMountpoint:function(a){return!!a.mounted},isFile:function(a){return(a&61440)===32768},isDir:function(a){return(a&61440)===16384},isLink:function(a){return(a&61440)===40960},isChrdev:function(a){return(a&61440)===8192},isBlkdev:function(a){return(a&61440)===24576},isFIFO:function(a){return(a&61440)===4096},isSocket:function(a){return(a&49152)===49152},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(a){var b=K.flagModes[a];if(typeof b==="undefined")throw new Error("Unknown file open mode: "+a);return b},flagsToPermissionString:function(a){var b=["r","w","rw"][a&3];a&512&&(b+="w");return b},nodePermissions:function(a,b){if(K.ignorePermissions)return 0;if(b.includes("r")&&!(a.mode&292))return 2;else if(b.includes("w")&&!(a.mode&146))return 2;else if(b.includes("x")&&!(a.mode&73))return 2;return 0},mayLookup:function(a){var b=K.nodePermissions(a,"x");if(b)return b;return!a.node_ops.lookup?2:0},mayCreate:function(a,b){try{K.lookupNode(a,b);return 20}catch(a){}return K.nodePermissions(a,"wx")},mayDelete:function(a,b,c){var d;try{d=K.lookupNode(a,b)}catch(a){return a.errno}b=K.nodePermissions(a,"wx");if(b)return b;if(c){if(!K.isDir(d.mode))return 54;if(K.isRoot(d)||K.getPath(d)===K.cwd())return 10}else if(K.isDir(d.mode))return 31;return 0},mayOpen:function(a,b){if(!a)return 44;if(K.isLink(a.mode))return 32;else if(K.isDir(a.mode)&&(K.flagsToPermissionString(b)!=="r"||b&512))return 31;return K.nodePermissions(a,K.flagsToPermissionString(b))},MAX_OPEN_FDS:4096,nextfd:function(a,b){a===void 0&&(a=0);b===void 0&&(b=K.MAX_OPEN_FDS);for(a=a;a<=b;a++)if(!K.streams[a])return a;throw new K.ErrnoError(33)},getStream:function(a){return K.streams[a]},createStream:function(a,b,c){K.FSStream||(K.FSStream=function(){},K.FSStream.prototype={object:{get:function(){return this.node},set:function(a){this.node=a}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}}});var d=new K.FSStream();for(var e in a)d[e]=a[e];a=d;e=K.nextfd(b,c);a.fd=e;K.streams[e]=a;return a},closeStream:function(a){K.streams[a]=null},chrdev_stream_ops:{open:function(a){var b=K.getDevice(a.node.rdev);a.stream_ops=b.stream_ops;a.stream_ops.open&&a.stream_ops.open(a)},llseek:function(){throw new K.ErrnoError(70)}},major:function(a){return a>>8},minor:function(a){return a&255},makedev:function(a,b){return a<<8|b},registerDevice:function(a,b){K.devices[a]={stream_ops:b}},getDevice:function(a){return K.devices[a]},getMounts:function(a){var b=[];a=[a];while(a.length){var c=a.pop();b.push(c);a.push.apply(a,c.mounts)}return b},syncfs:function(a,b){typeof a==="function"&&(b=a,a=!1);K.syncFSRequests++;K.syncFSRequests>1&&q("warning: "+K.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var c=K.getMounts(K.root.mount),d=0;function e(a){K.syncFSRequests--;return b(a)}function f(a){if(a){if(!f.errored){f.errored=!0;return e(a)}return}++d>=c.length&&e(null)}c.forEach(function(b){if(!b.type.syncfs)return f(null);b.type.syncfs(b,a,f)})},mount:function(a,b,c){var d=c==="/",e=!c,f;if(d&&K.root)throw new K.ErrnoError(10);else if(!d&&!e){e=K.lookupPath(c,{follow_mount:!1});c=e.path;f=e.node;if(K.isMountpoint(f))throw new K.ErrnoError(10);if(!K.isDir(f.mode))throw new K.ErrnoError(54)}e={type:a,opts:b,mountpoint:c,mounts:[]};b=a.mount(e);b.mount=e;e.root=b;d?K.root=b:f&&(f.mounted=e,f.mount&&f.mount.mounts.push(e));return b},unmount:function(a){a=K.lookupPath(a,{follow_mount:!1});if(!K.isMountpoint(a.node))throw new K.ErrnoError(28);a=a.node;var b=a.mounted,c=K.getMounts(b);Object.keys(K.nameTable).forEach(function(a){a=K.nameTable[a];while(a){var b=a.name_next;c.includes(a.mount)&&K.destroyNode(a);a=b}});a.mounted=null;b=a.mount.mounts.indexOf(b);a.mount.mounts.splice(b,1)},lookup:function(a,b){return a.node_ops.lookup(a,b)},mknod:function(a,b,c){var d=K.lookupPath(a,{parent:!0});d=d.node;a=G.basename(a);if(!a||a==="."||a==="..")throw new K.ErrnoError(28);var e=K.mayCreate(d,a);if(e)throw new K.ErrnoError(e);if(!d.node_ops.mknod)throw new K.ErrnoError(63);return d.node_ops.mknod(d,a,b,c)},create:function(a,b){b=b!==void 0?b:438;b&=4095;b|=32768;return K.mknod(a,b,0)},mkdir:function(a,b){b=b!==void 0?b:511;b&=511|512;b|=16384;return K.mknod(a,b,0)},mkdirTree:function(a,b){a=a.split("/");var c="";for(var d=0;d<a.length;++d){if(!a[d])continue;c+="/"+a[d];try{K.mkdir(c,b)}catch(a){if(a.errno!=20)throw a}}},mkdev:function(a,b,c){typeof c==="undefined"&&(c=b,b=438);b|=8192;return K.mknod(a,b,c)},symlink:function(a,b){if(!H.resolve(a))throw new K.ErrnoError(44);var c=K.lookupPath(b,{parent:!0});c=c.node;if(!c)throw new K.ErrnoError(44);b=G.basename(b);var d=K.mayCreate(c,b);if(d)throw new K.ErrnoError(d);if(!c.node_ops.symlink)throw new K.ErrnoError(63);return c.node_ops.symlink(c,b,a)},rename:function(a,b){var c=G.dirname(a),d=G.dirname(b),e=G.basename(a),f=G.basename(b),g,h;g=K.lookupPath(a,{parent:!0});h=g.node;g=K.lookupPath(b,{parent:!0});g=g.node;if(!h||!g)throw new K.ErrnoError(44);if(h.mount!==g.mount)throw new K.ErrnoError(75);var i=K.lookupNode(h,e);a=H.relative(a,d);if(a.charAt(0)!==".")throw new K.ErrnoError(28);a=H.relative(b,c);if(a.charAt(0)!==".")throw new K.ErrnoError(55);var j;try{j=K.lookupNode(g,f)}catch(a){}if(i===j)return;d=K.isDir(i.mode);b=K.mayDelete(h,e,d);if(b)throw new K.ErrnoError(b);b=j?K.mayDelete(g,f,d):K.mayCreate(g,f);if(b)throw new K.ErrnoError(b);if(!h.node_ops.rename)throw new K.ErrnoError(63);if(K.isMountpoint(i)||j&&K.isMountpoint(j))throw new K.ErrnoError(10);if(g!==h){b=K.nodePermissions(h,"w");if(b)throw new K.ErrnoError(b)}K.hashRemoveNode(i);try{h.node_ops.rename(i,g,f)}catch(a){throw a}finally{K.hashAddNode(i)}},rmdir:function(a){var b=K.lookupPath(a,{parent:!0});b=b.node;a=G.basename(a);var c=K.lookupNode(b,a),d=K.mayDelete(b,a,!0);if(d)throw new K.ErrnoError(d);if(!b.node_ops.rmdir)throw new K.ErrnoError(63);if(K.isMountpoint(c))throw new K.ErrnoError(10);b.node_ops.rmdir(b,a);K.destroyNode(c)},readdir:function(a){a=K.lookupPath(a,{follow:!0});a=a.node;if(!a.node_ops.readdir)throw new K.ErrnoError(54);return a.node_ops.readdir(a)},unlink:function(a){var b=K.lookupPath(a,{parent:!0});b=b.node;if(!b)throw new K.ErrnoError(44);a=G.basename(a);var c=K.lookupNode(b,a),d=K.mayDelete(b,a,!1);if(d)throw new K.ErrnoError(d);if(!b.node_ops.unlink)throw new K.ErrnoError(63);if(K.isMountpoint(c))throw new K.ErrnoError(10);b.node_ops.unlink(b,a);K.destroyNode(c)},readlink:function(a){a=K.lookupPath(a);a=a.node;if(!a)throw new K.ErrnoError(44);if(!a.node_ops.readlink)throw new K.ErrnoError(28);return H.resolve(K.getPath(a.parent),a.node_ops.readlink(a))},stat:function(a,b){a=K.lookupPath(a,{follow:!b});b=a.node;if(!b)throw new K.ErrnoError(44);if(!b.node_ops.getattr)throw new K.ErrnoError(63);return b.node_ops.getattr(b)},lstat:function(a){return K.stat(a,!0)},chmod:function(a,b,c){if(typeof a==="string"){c=K.lookupPath(a,{follow:!c});c=c.node}else c=a;if(!c.node_ops.setattr)throw new K.ErrnoError(63);c.node_ops.setattr(c,{mode:b&4095|c.mode&-4096,timestamp:Date.now()})},lchmod:function(a,b){K.chmod(a,b,!0)},fchmod:function(a,b){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);K.chmod(a.node,b)},chown:function(a,b,c,d){if(typeof a==="string"){b=K.lookupPath(a,{follow:!d});c=b.node}else c=a;if(!c.node_ops.setattr)throw new K.ErrnoError(63);c.node_ops.setattr(c,{timestamp:Date.now()})},lchown:function(a,b,c){K.chown(a,b,c,!0)},fchown:function(a,b,c){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);K.chown(a.node,b,c)},truncate:function(a,b){if(b<0)throw new K.ErrnoError(28);if(typeof a==="string"){var c=K.lookupPath(a,{follow:!0});c=c.node}else c=a;if(!c.node_ops.setattr)throw new K.ErrnoError(63);if(K.isDir(c.mode))throw new K.ErrnoError(31);if(!K.isFile(c.mode))throw new K.ErrnoError(28);a=K.nodePermissions(c,"w");if(a)throw new K.ErrnoError(a);c.node_ops.setattr(c,{size:b,timestamp:Date.now()})},ftruncate:function(a,b){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);if((a.flags&2097155)===0)throw new K.ErrnoError(28);K.truncate(a.node,b)},utime:function(a,b,c){a=K.lookupPath(a,{follow:!0});a=a.node;a.node_ops.setattr(a,{timestamp:Math.max(b,c)})},open:function(a,b,d,e,f){if(a==="")throw new K.ErrnoError(44);b=typeof b==="string"?K.modeStringToFlags(b):b;d=typeof d==="undefined"?438:d;b&64?d=d&4095|32768:d=0;var g;if(typeof a==="object")g=a;else{a=G.normalize(a);try{var h=K.lookupPath(a,{follow:!(b&131072)});g=h.node}catch(a){}}h=!1;if(b&64)if(g){if(b&128)throw new K.ErrnoError(20)}else g=K.mknod(a,d,0),h=!0;if(!g)throw new K.ErrnoError(44);K.isChrdev(g.mode)&&(b&=-513);if(b&65536&&!K.isDir(g.mode))throw new K.ErrnoError(54);if(!h){d=K.mayOpen(g,b);if(d)throw new K.ErrnoError(d)}b&512&&K.truncate(g,0);b&=~(128|512|131072);h=K.createStream({node:g,path:K.getPath(g),flags:b,seekable:!0,position:0,stream_ops:g.stream_ops,ungotten:[],error:!1},e,f);h.stream_ops.open&&h.stream_ops.open(h);c.logReadFiles&&!(b&1)&&(K.readFiles||(K.readFiles={}),a in K.readFiles||(K.readFiles[a]=1));return h},close:function(a){if(K.isClosed(a))throw new K.ErrnoError(8);a.getdents&&(a.getdents=null);try{a.stream_ops.close&&a.stream_ops.close(a)}catch(a){throw a}finally{K.closeStream(a.fd)}a.fd=null},isClosed:function(a){return a.fd===null},llseek:function(a,b,c){if(K.isClosed(a))throw new K.ErrnoError(8);if(!a.seekable||!a.stream_ops.llseek)throw new K.ErrnoError(70);if(c!=0&&c!=1&&c!=2)throw new K.ErrnoError(28);a.position=a.stream_ops.llseek(a,b,c);a.ungotten=[];return a.position},read:function(b,a,c,d,e){if(d<0||e<0)throw new K.ErrnoError(28);if(K.isClosed(b))throw new K.ErrnoError(8);if((b.flags&2097155)===1)throw new K.ErrnoError(8);if(K.isDir(b.node.mode))throw new K.ErrnoError(31);if(!b.stream_ops.read)throw new K.ErrnoError(28);var f=typeof e!=="undefined";if(!f)e=b.position;else if(!b.seekable)throw new K.ErrnoError(70);a=b.stream_ops.read(b,a,c,d,e);f||(b.position+=a);return a},write:function(b,a,c,d,e,f){if(d<0||e<0)throw new K.ErrnoError(28);if(K.isClosed(b))throw new K.ErrnoError(8);if((b.flags&2097155)===0)throw new K.ErrnoError(8);if(K.isDir(b.node.mode))throw new K.ErrnoError(31);if(!b.stream_ops.write)throw new K.ErrnoError(28);b.seekable&&b.flags&1024&&K.llseek(b,0,2);var g=typeof e!=="undefined";if(!g)e=b.position;else if(!b.seekable)throw new K.ErrnoError(70);a=b.stream_ops.write(b,a,c,d,e,f);g||(b.position+=a);return a},allocate:function(a,b,c){if(K.isClosed(a))throw new K.ErrnoError(8);if(b<0||c<=0)throw new K.ErrnoError(28);if((a.flags&2097155)===0)throw new K.ErrnoError(8);if(!K.isFile(a.node.mode)&&!K.isDir(a.node.mode))throw new K.ErrnoError(43);if(!a.stream_ops.allocate)throw new K.ErrnoError(138);a.stream_ops.allocate(a,b,c)},mmap:function(a,b,c,d,e,f){if((e&2)!==0&&(f&2)===0&&(a.flags&2097155)!==2)throw new K.ErrnoError(2);if((a.flags&2097155)===1)throw new K.ErrnoError(2);if(!a.stream_ops.mmap)throw new K.ErrnoError(43);return a.stream_ops.mmap(a,b,c,d,e,f)},msync:function(b,a,c,d,e){return!b||!b.stream_ops.msync?0:b.stream_ops.msync(b,a,c,d,e)},munmap:function(a){return 0},ioctl:function(a,b,c){if(!a.stream_ops.ioctl)throw new K.ErrnoError(59);return a.stream_ops.ioctl(a,b,c)},readFile:function(a,b){b===void 0&&(b={});b.flags=b.flags||0;b.encoding=b.encoding||"binary";if(b.encoding!=="utf8"&&b.encoding!=="binary")throw new Error('Invalid encoding type "'+b.encoding+'"');var c,d=K.open(a,b.flags);a=K.stat(a);a=a.size;var e=new Uint8Array(a);K.read(d,e,0,a,0);b.encoding==="utf8"?c=t(e,0):b.encoding==="binary"&&(c=e);K.close(d);return c},writeFile:function(a,b,c){c===void 0&&(c={});c.flags=c.flags||577;a=K.open(a,c.flags,c.mode);if(typeof b==="string"){var d=new Uint8Array(oa(b)+1),e=ma(b,d,0,d.length);K.write(a,d,0,e,void 0,c.canOwn)}else if(ArrayBuffer.isView(b))K.write(a,b,0,b.byteLength,void 0,c.canOwn);else throw new Error("Unsupported data type");K.close(a)},cwd:function(){return K.currentPath},chdir:function(a){a=K.lookupPath(a,{follow:!0});if(a.node===null)throw new K.ErrnoError(44);if(!K.isDir(a.node.mode))throw new K.ErrnoError(54);var b=K.nodePermissions(a.node,"x");if(b)throw new K.ErrnoError(b);K.currentPath=a.path},createDefaultDirectories:function(){K.mkdir("/tmp"),K.mkdir("/home"),K.mkdir("/home/web_user")},createDefaultDevices:function(){K.mkdir("/dev");K.registerDevice(K.makedev(1,3),{read:function(){return 0},write:function(b,a,c,d,e){return d}});K.mkdev("/dev/null",K.makedev(1,3));I.register(K.makedev(5,0),I.default_tty_ops);I.register(K.makedev(6,0),I.default_tty1_ops);K.mkdev("/dev/tty",K.makedev(5,0));K.mkdev("/dev/tty1",K.makedev(6,0));var a=nb();K.createDevice("/dev","random",a);K.createDevice("/dev","urandom",a);K.mkdir("/dev/shm");K.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){K.mkdir("/proc");var a=K.mkdir("/proc/self");K.mkdir("/proc/self/fd");K.mount({mount:function(){var b=K.createNode(a,"fd",16384|511,73);b.node_ops={lookup:function(a,b){a=+b;var c=K.getStream(a);if(!c)throw new K.ErrnoError(8);b={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return c.path}}};b.parent=b;return b}};return b}},{},"/proc/self/fd")},createStandardStreams:function(){c.stdin?K.createDevice("/dev","stdin",c.stdin):K.symlink("/dev/tty","/dev/stdin"),c.stdout?K.createDevice("/dev","stdout",null,c.stdout):K.symlink("/dev/tty","/dev/stdout"),c.stderr?K.createDevice("/dev","stderr",null,c.stderr):K.symlink("/dev/tty1","/dev/stderr"),K.open("/dev/stdin",0),K.open("/dev/stdout",1),K.open("/dev/stderr",1)},ensureErrnoError:function(){if(K.ErrnoError)return;K.ErrnoError=function(a,b){this.node=b,this.setErrno=function(a){this.errno=a},this.setErrno(a),this.message="FS error"};K.ErrnoError.prototype=new Error();K.ErrnoError.prototype.constructor=K.ErrnoError;[44].forEach(function(a){K.genericErrors[a]=new K.ErrnoError(a),K.genericErrors[a].stack="<generic error, no stack>"})},staticInit:function(){K.ensureErrnoError(),K.nameTable=new Array(4096),K.mount(J,{},"/"),K.createDefaultDirectories(),K.createDefaultDevices(),K.createSpecialDirectories(),K.filesystems={MEMFS:J}},init:function(a,b,d){K.init.initialized=!0,K.ensureErrnoError(),c.stdin=a||c.stdin,c.stdout=b||c.stdout,c.stderr=d||c.stderr,K.createStandardStreams()},quit:function(){K.init.initialized=!1;for(var a=0;a<K.streams.length;a++){var b=K.streams[a];if(!b)continue;K.close(b)}},getMode:function(a,b){var c=0;a&&(c|=292|73);b&&(c|=146);return c},findObject:function(a,b){a=K.analyzePath(a,b);if(a.exists)return a.object;else return null},analyzePath:function(a,b){try{var c=K.lookupPath(a,{follow:!b});a=c.path}catch(a){}var d={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var c=K.lookupPath(a,{parent:!0});d.parentExists=!0;d.parentPath=c.path;d.parentObject=c.node;d.name=G.basename(a);c=K.lookupPath(a,{follow:!b});d.exists=!0;d.path=c.path;d.object=c.node;d.name=c.node.name;d.isRoot=c.path==="/"}catch(a){d.error=a.errno}return d},createPath:function(a,b,c,d){a=typeof a==="string"?a:K.getPath(a);c=b.split("/").reverse();while(c.length){d=c.pop();if(!d)continue;var e=G.join2(a,d);try{K.mkdir(e)}catch(a){}a=e}return e},createFile:function(a,b,c,d,e){c=G.join2(typeof a==="string"?a:K.getPath(a),b);a=K.getMode(d,e);return K.create(c,a)},createDataFile:function(a,b,c,d,e,f){var g=b;a&&(a=typeof a==="string"?a:K.getPath(a),g=b?G.join2(a,b):a);b=K.getMode(d,e);a=K.create(g,b);if(c){if(typeof c==="string"){d=new Array(c.length);for(e=0,g=c.length;e<g;++e)d[e]=c.charCodeAt(e);c=d}K.chmod(a,b|146);e=K.open(a,577);K.write(e,c,0,c.length,0,f);K.close(e);K.chmod(a,b)}return a},createDevice:function(a,b,c,d){a=G.join2(typeof a==="string"?a:K.getPath(a),b);b=K.getMode(!!c,!!d);K.createDevice.major||(K.createDevice.major=64);var e=K.makedev(K.createDevice.major++,0);K.registerDevice(e,{open:function(a){a.seekable=!1},close:function(a){d&&d.buffer&&d.buffer.length&&d(10)},read:function(b,a,d,e,f){f=0;for(var g=0;g<e;g++){var h;try{h=c()}catch(a){throw new K.ErrnoError(29)}if(h===void 0&&f===0)throw new K.ErrnoError(6);if(h===null||h===void 0)break;f++;a[d+g]=h}f&&(b.node.timestamp=Date.now());return f},write:function(b,a,c,e,f){for(f=0;f<e;f++)try{d(a[c+f])}catch(a){throw new K.ErrnoError(29)}e&&(b.node.timestamp=Date.now());return f}});return K.mkdev(a,b,e)},forceLoadFile:function(a){if(a.isDevice||a.isFolder||a.link||a.contents)return!0;if(typeof XMLHttpRequest!=="undefined")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else if(ba)try{a.contents=ud(ba(a.url),!0),a.usedBytes=a.contents.length}catch(a){throw new K.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:function(a,b,c,d,e){function f(){this.lengthKnown=!1,this.chunks=[]}f.prototype.get=function(a){if(a>this.length-1||a<0)return void 0;var b=a%this.chunkSize;a=a/this.chunkSize|0;return this.getter(a)[b]};f.prototype.setDataGetter=function(a){this.getter=a};f.prototype.cacheLength=function(){var a=new XMLHttpRequest();a.open("HEAD",c,!1);a.send(null);if(!(a.status>=200&&a.status<300||a.status===304))throw new Error("Couldn't load "+c+". Status: "+a.status);var b=Number(a.getResponseHeader("Content-length")),d,e=(d=a.getResponseHeader("Accept-Ranges"))&&d==="bytes";a=(d=a.getResponseHeader("Content-Encoding"))&&d==="gzip";var f=1024*1024;e||(f=b);var g=function(d,e){if(d>e)throw new Error("invalid range ("+d+", "+e+") or no bytes requested!");if(e>b-1)throw new Error("only "+b+" bytes available! programmer error!");var a=new XMLHttpRequest();a.open("GET",c,!1);b!==f&&a.setRequestHeader("Range","bytes="+d+"-"+e);typeof Uint8Array!="undefined"&&(a.responseType="arraybuffer");a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined");a.send(null);if(!(a.status>=200&&a.status<300||a.status===304))throw new Error("Couldn't load "+c+". Status: "+a.status);if(a.response!==void 0)return new Uint8Array(a.response||[]);else return ud(a.responseText||"",!0)},h=this;h.setDataGetter(function(a){var c=a*f,d=(a+1)*f-1;d=Math.min(d,b-1);typeof h.chunks[a]==="undefined"&&(h.chunks[a]=g(c,d));if(typeof h.chunks[a]==="undefined")throw new Error("doXHR failed!");return h.chunks[a]});(a||!b)&&(f=b=1,b=this.getter(0).length,f=b,ea("LazyFiles on gzip forces download of the whole file when length is accessed"));this._length=b;this._chunkSize=f;this.lengthKnown=!0};if(typeof XMLHttpRequest!=="undefined"){if(!o)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";f=new f();Object.defineProperties(f,{length:{get:function(){this.lengthKnown||this.cacheLength();return this._length}},chunkSize:{get:function(){this.lengthKnown||this.cacheLength();return this._chunkSize}}});f={isDevice:!1,contents:f}}else var f={isDevice:!1,url:c};var g=K.createFile(a,b,f,d,e);f.contents?g.contents=f.contents:f.url&&(g.contents=null,g.url=f.url);Object.defineProperties(g,{usedBytes:{get:function(){return this.contents.length}}});var h={};a=Object.keys(g.stream_ops);a.forEach(function(a){var b=g.stream_ops[a];h[a]=function(){K.forceLoadFile(g);return b.apply(null,arguments)}});h.read=function(b,a,c,d,e){K.forceLoadFile(g);b=b.node.contents;if(e>=b.length)return 0;d=Math.min(b.length-e,d);if(b.slice)for(var f=0;f<d;f++)a[c+f]=b[e+f];else for(var f=0;f<d;f++)a[c+f]=b.get(e+f);return d};g.stream_ops=h;return g},createPreloadedFile:function(a,b,c,d,e,f,g,h,i,j){var k=b?H.resolve(G.join2(a,b)):a,l=Pa("cp "+k);function m(c){function m(c){j&&j(),h||K.createDataFile(a,b,c,d,e,i),f&&f(),Ra(l)}if(Browser.handledByPreloadPlugin(c,k,m,function(){g&&g(),Ra(l)}))return;m(c)}Qa(l);typeof c=="string"?pb(c,function(a){return m(a)},g):m(c)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(a,b,c){b=b||function(){};c=c||function(){};var d=K.indexedDB();try{var e=d.open(K.DB_NAME(),K.DB_VERSION)}catch(a){return c(a)}e.onupgradeneeded=function(){ea("creating db");var a=e.result;a.createObjectStore(K.DB_STORE_NAME)};e.onsuccess=function(){var d=e.result;d=d.transaction([K.DB_STORE_NAME],"readwrite");var f=d.objectStore(K.DB_STORE_NAME),g=0,h=0,i=a.length;function j(){h==0?b():c()}a.forEach(function(a){a=f.put(K.analyzePath(a).object.contents,a);a.onsuccess=function(){g++,g+h==i&&j()};a.onerror=function(){h++,g+h==i&&j()}});d.onerror=c};e.onerror=c},loadFilesFromDB:function(a,b,c){b=b||function(){};c=c||function(){};var d=K.indexedDB();try{var e=d.open(K.DB_NAME(),K.DB_VERSION)}catch(a){return c(a)}e.onupgradeneeded=c;e.onsuccess=function(){var d=e.result;try{var f=d.transaction([K.DB_STORE_NAME],"readonly")}catch(a){c(a);return}var g=f.objectStore(K.DB_STORE_NAME),h=0,i=0,j=a.length;function k(){i==0?b():c()}a.forEach(function(a){var b=g.get(a);b.onsuccess=function(){K.analyzePath(a).exists&&K.unlink(a),K.createDataFile(G.dirname(a),G.basename(a),b.result,!0,!0,!0),h++,h+i==j&&k()};b.onerror=function(){i++,h+i==j&&k()}});f.onerror=c};e.onerror=c}},L={mappings:{},DEFAULT_POLLMASK:5,calculateAt:function(a,b,c){if(b[0]==="/")return b;var d;if(a===-100)d=K.cwd();else{a=K.getStream(a);if(!a)throw new K.ErrnoError(8);d=a.path}if(b.length==0){if(!c)throw new K.ErrnoError(44);return d}return G.join2(d,b)},doStat:function(a,b,c){try{var d=a(b)}catch(a){if(a&&a.node&&G.normalize(b)!==G.normalize(K.getPath(a.node)))return-54;throw a}x[c>>2]=d.dev;x[c+4>>2]=0;x[c+8>>2]=d.ino;x[c+12>>2]=d.mode;x[c+16>>2]=d.nlink;x[c+20>>2]=d.uid;x[c+24>>2]=d.gid;x[c+28>>2]=d.rdev;x[c+32>>2]=0;D=[d.size>>>0,(C=d.size,+Math.abs(C)>=1?C>0?(Math.min(+Math.floor(C/4294967296),4294967295)|0)>>>0:~~+Math.ceil((C-+(~~C>>>0))/4294967296)>>>0:0)],x[c+40>>2]=D[0],x[c+44>>2]=D[1];x[c+48>>2]=4096;x[c+52>>2]=d.blocks;x[c+56>>2]=d.atime.getTime()/1e3|0;x[c+60>>2]=0;x[c+64>>2]=d.mtime.getTime()/1e3|0;x[c+68>>2]=0;x[c+72>>2]=d.ctime.getTime()/1e3|0;x[c+76>>2]=0;D=[d.ino>>>0,(C=d.ino,+Math.abs(C)>=1?C>0?(Math.min(+Math.floor(C/4294967296),4294967295)|0)>>>0:~~+Math.ceil((C-+(~~C>>>0))/4294967296)>>>0:0)],x[c+80>>2]=D[0],x[c+84>>2]=D[1];return 0},doMsync:function(a,b,c,d,e){a=v.slice(a,a+c);K.msync(b,a,e,c,d)},doMkdir:function(a,b){a=G.normalize(a);a[a.length-1]==="/"&&(a=a.substr(0,a.length-1));K.mkdir(a,b,0);return 0},doMknod:function(a,b,c){switch(b&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}K.mknod(a,b,c);return 0},doReadlink:function(a,b,c){if(c<=0)return-28;a=K.readlink(a);var d=Math.min(c,oa(a)),e=u[b+d];na(a,b,c+1);u[b+d]=e;return d},doAccess:function(a,b){if(b&-8)return-28;a=K.lookupPath(a,{follow:!0});a=a.node;if(!a)return-44;var c="";b&4&&(c+="r");b&2&&(c+="w");b&1&&(c+="x");return c&&K.nodePermissions(a,c)?-2:0},doDup:function(a,b,c){var d=K.getStream(c);d&&K.close(d);return K.open(a,b,0,c,c).fd},doReadv:function(a,b,c,d){var e=0;for(var f=0;f<c;f++){var g=x[b+f*8>>2],h=x[b+(f*8+4)>>2];g=K.read(a,u,g,h,d);if(g<0)return-1;e+=g;if(g<h)break}return e},doWritev:function(a,b,c,d){var e=0;for(var f=0;f<c;f++){var g=x[b+f*8>>2],h=x[b+(f*8+4)>>2];g=K.write(a,u,g,h,d);if(g<0)return-1;e+=g}return e},varargs:void 0,get:function(){L.varargs+=4;var a=x[L.varargs-4>>2];return a},getStr:function(a){a=la(a);return a},getStreamFromFD:function(a){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);return a},get64:function(a,b){return a}};function qb(a,b){try{if(b===0)return-28;var c=K.cwd(),d=oa(c);if(b<d+1)return-68;na(c,a,b);return a}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return-a.errno}}function rb(a,b,c){L.varargs=c;try{a=L.getStr(a);c=c?L.get():0;a=K.open(a,b,c);return a.fd}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return-a.errno}}function sb(a,b,c,d,e){}function tb(a){switch(a){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+a)}}function ub(){var a=new Array(256);for(var b=0;b<256;++b)a[b]=String.fromCharCode(b);vb=a}var vb=void 0;function M(a){var b="";a=a;while(v[a])b+=vb[v[a++]];return b}var N={},O={},wb={},xb=48,yb=57;function zb(a){if(void 0===a)return"_unknown";a=a.replace(/[^a-zA-Z0-9_]/g,"$");var b=a.charCodeAt(0);if(b>=xb&&b<=yb)return"_"+a;else return a}function Ab(a,b){zb(a);return function(){return b.apply(this,arguments)}}function Bb(a,b){var c=Ab(b,function(a){this.name=b;this.message=a;a=new Error(a).stack;a!==void 0&&(this.stack=this.toString()+"\n"+a.replace(/^Error(:[^\n]*)?\n/,""))});c.prototype=Object.create(a.prototype);c.prototype.constructor=c;c.prototype.toString=function(){if(this.message===void 0)return this.name;else return this.name+": "+this.message};return c}var P=void 0;function Q(a){throw new P(a)}var Cb=void 0;function Db(a){throw new Cb(a)}function R(a,b,c){a.forEach(function(a){wb[a]=b});function d(b){b=c(b);b.length!==a.length&&Db("Mismatched type converter count");for(var d=0;d<a.length;++d)S(a[d],b[d])}var e=new Array(b.length),f=[],g=0;b.forEach(function(a,b){Object.prototype.hasOwnProperty.call(O,a)?e[b]=O[a]:(f.push(a),Object.prototype.hasOwnProperty.call(N,a)||(N[a]=[]),N[a].push(function(){e[b]=O[a],++g,g===f.length&&d(e)}))});0===f.length&&d(e)}function S(a,b,c){c===void 0&&(c={});if(!("argPackAdvance"in b))throw new TypeError("registerType registeredInstance requires argPackAdvance");var d=b.name;a||Q('type "'+d+'" must have a positive integer typeid pointer');if(Object.prototype.hasOwnProperty.call(O,a))if(c.ignoreDuplicateRegistrations)return;else Q("Cannot register type '"+d+"' twice");O[a]=b;delete wb[a];if(Object.prototype.hasOwnProperty.call(N,a)){c=N[a];delete N[a];c.forEach(function(a){a()})}}function Eb(a,b,c,d,e){var f=tb(c);b=M(b);S(a,{name:b,fromWireType:function(a){return!!a},toWireType:function(a,b){return b?d:e},argPackAdvance:8,readValueFromPointer:function(a){var d;if(c===1)d=u;else if(c===2)d=w;else if(c===4)d=x;else throw new TypeError("Unknown boolean type size: "+b);return this.fromWireType(d[a>>f])},destructorFunction:null})}function Fb(a){if(!(this instanceof T))return!1;if(!(a instanceof T))return!1;var b=this.$$.ptrType.registeredClass,c=this.$$.ptr,d=a.$$.ptrType.registeredClass;a=a.$$.ptr;while(b.baseClass)c=b.upcast(c),b=b.baseClass;while(d.baseClass)a=d.upcast(a),d=d.baseClass;return b===d&&c===a}function Gb(a){return{count:a.count,deleteScheduled:a.deleteScheduled,preservePointerOnDelete:a.preservePointerOnDelete,ptr:a.ptr,ptrType:a.ptrType,smartPtr:a.smartPtr,smartPtrType:a.smartPtrType}}function Hb(a){function b(a){return a.$$.ptrType.registeredClass.name}Q(b(a)+" instance already deleted")}var Ib=!1;function Jb(a){}function Kb(a){a.smartPtr?a.smartPtrType.rawDestructor(a.smartPtr):a.ptrType.registeredClass.rawDestructor(a.ptr)}function Lb(a){a.count.value-=1;var b=0===a.count.value;b&&Kb(a)}function Mb(a){if("undefined"===typeof FinalizationGroup){Mb=function(a){return a};return a}Ib=new FinalizationGroup(function(a){for(var b=a.next();!b.done;b=a.next()){var c=b.value;c.ptr&&Lb(c)}});Mb=function(a){Ib.register(a,a.$$,a.$$);return a};Jb=function(a){Ib.unregister(a.$$)};return Mb(a)}function Nb(){this.$$.ptr||Hb(this);if(this.$$.preservePointerOnDelete){this.$$.count.value+=1;return this}else{var a=Mb(Object.create(Object.getPrototypeOf(this),{$$:{value:Gb(this.$$)}}));a.$$.count.value+=1;a.$$.deleteScheduled=!1;return a}}function Ob(){this.$$.ptr||Hb(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Q("Object already scheduled for deletion"),Jb(this),Lb(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Pb(){return!this.$$.ptr}var Qb=void 0,Rb=[];function Sb(){while(Rb.length){var a=Rb.pop();a.$$.deleteScheduled=!1;a["delete"]()}}function Tb(){this.$$.ptr||Hb(this);this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Q("Object already scheduled for deletion");Rb.push(this);Rb.length===1&&Qb&&Qb(Sb);this.$$.deleteScheduled=!0;return this}function Ub(){T.prototype.isAliasOf=Fb,T.prototype.clone=Nb,T.prototype["delete"]=Ob,T.prototype.isDeleted=Pb,T.prototype.deleteLater=Tb}function T(){}var Vb={};function Wb(a,b,c){if(void 0===a[b].overloadTable){var d=a[b];a[b]=function(){Object.prototype.hasOwnProperty.call(a[b].overloadTable,arguments.length)||Q("Function '"+c+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+a[b].overloadTable+")!");return a[b].overloadTable[arguments.length].apply(this,arguments)};a[b].overloadTable=[];a[b].overloadTable[d.argCount]=d}}function Xb(a,b,d){Object.prototype.hasOwnProperty.call(c,a)?((void 0===d||void 0!==c[a].overloadTable&&void 0!==c[a].overloadTable[d])&&Q("Cannot register public name '"+a+"' twice"),Wb(c,a,a),Object.prototype.hasOwnProperty.call(c,d)&&Q("Cannot register multiple overloads of a function with the same number of arguments ("+d+")!"),c[a].overloadTable[d]=b):(c[a]=b,void 0!==d&&(c[a].numArguments=d))}function Yb(a,b,c,d,e,f,g,h){this.name=a,this.constructor=b,this.instancePrototype=c,this.rawDestructor=d,this.baseClass=e,this.getActualType=f,this.upcast=g,this.downcast=h,this.pureVirtualFunctions=[]}function Zb(a,b,c){while(b!==c)b.upcast||Q("Expected null or instance of "+c.name+", got an instance of "+b.name),a=b.upcast(a),b=b.baseClass;return a}function $b(a,b){if(b===null){this.isReference&&Q("null is not a valid "+this.name);return 0}b.$$||Q('Cannot pass "'+Lc(b)+'" as a '+this.name);b.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name);a=b.$$.ptrType.registeredClass;b=Zb(b.$$.ptr,a,this.registeredClass);return b}function ac(a,b){var c;if(b===null){this.isReference&&Q("null is not a valid "+this.name);if(this.isSmartPointer){c=this.rawConstructor();a!==null&&a.push(this.rawDestructor,c);return c}else return 0}b.$$||Q('Cannot pass "'+Lc(b)+'" as a '+this.name);b.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name);!this.isConst&&b.$$.ptrType.isConst&&Q("Cannot convert argument of type "+(b.$$.smartPtrType?b.$$.smartPtrType.name:b.$$.ptrType.name)+" to parameter type "+this.name);var d=b.$$.ptrType.registeredClass;c=Zb(b.$$.ptr,d,this.registeredClass);if(this.isSmartPointer){void 0===b.$$.smartPtr&&Q("Passing raw pointer to smart pointer is illegal");switch(this.sharingPolicy){case 0:b.$$.smartPtrType===this?c=b.$$.smartPtr:Q("Cannot convert argument of type "+(b.$$.smartPtrType?b.$$.smartPtrType.name:b.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:c=b.$$.smartPtr;break;case 2:if(b.$$.smartPtrType===this)c=b.$$.smartPtr;else{var e=b.clone();c=this.rawShare(c,Jc.toHandle(function(){e["delete"]()}));a!==null&&a.push(this.rawDestructor,c)}break;default:Q("Unsupporting sharing policy")}}return c}function bc(a,b){if(b===null){this.isReference&&Q("null is not a valid "+this.name);return 0}b.$$||Q('Cannot pass "'+Lc(b)+'" as a '+this.name);b.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name);b.$$.ptrType.isConst&&Q("Cannot convert argument of type "+b.$$.ptrType.name+" to parameter type "+this.name);a=b.$$.ptrType.registeredClass;b=Zb(b.$$.ptr,a,this.registeredClass);return b}function cc(a){return this.fromWireType(y[a>>2])}function dc(a){this.rawGetPointee&&(a=this.rawGetPointee(a));return a}function ec(a){this.rawDestructor&&this.rawDestructor(a)}function fc(a){a!==null&&a["delete"]()}function gc(a,b,c){if(b===c)return a;if(void 0===c.baseClass)return null;a=gc(a,b,c.baseClass);return a===null?null:c.downcast(a)}function hc(){return Object.keys(lc).length}function ic(){var a=[];for(var b in lc)Object.prototype.hasOwnProperty.call(lc,b)&&a.push(lc[b]);return a}function jc(a){Qb=a,Rb.length&&Qb&&Qb(Sb)}function kc(){c.getInheritedInstanceCount=hc,c.getLiveInheritedInstances=ic,c.flushPendingDeletes=Sb,c.setDelayFunction=jc}var lc={};function mc(a,b){b===void 0&&Q("ptr should not be undefined");while(a.baseClass)b=a.upcast(b),a=a.baseClass;return b}function nc(a,b){b=mc(a,b);return lc[b]}function oc(a,b){(!b.ptrType||!b.ptr)&&Db("makeClassHandle requires ptr and ptrType");var c=!!b.smartPtrType,d=!!b.smartPtr;c!==d&&Db("Both smartPtrType and smartPtr must be specified");b.count={value:1};return Mb(Object.create(a,{$$:{value:b}}))}function pc(a){var b=this.getPointee(a);if(!b){this.destructor(a);return null}var c=nc(this.registeredClass,b);if(void 0!==c)if(0===c.$$.count.value){c.$$.ptr=b;c.$$.smartPtr=a;return c.clone()}else{c=c.clone();this.destructor(a);return c}function d(){if(this.isSmartPointer)return oc(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:b,smartPtrType:this,smartPtr:a});else return oc(this.registeredClass.instancePrototype,{ptrType:this,ptr:a})}c=this.registeredClass.getActualType(b);c=Vb[c];if(!c)return d.call(this);var e;this.isConst?e=c.constPointerType:e=c.pointerType;c=gc(b,this.registeredClass,e.registeredClass);if(c===null)return d.call(this);if(this.isSmartPointer)return oc(e.registeredClass.instancePrototype,{ptrType:e,ptr:c,smartPtrType:this,smartPtr:a});else return oc(e.registeredClass.instancePrototype,{ptrType:e,ptr:c})}function qc(){U.prototype.getPointee=dc,U.prototype.destructor=ec,U.prototype.argPackAdvance=8,U.prototype.readValueFromPointer=cc,U.prototype.deleteObject=fc,U.prototype.fromWireType=pc}function U(a,b,c,d,e,f,g,h,i,j,k){this.name=a,this.registeredClass=b,this.isReference=c,this.isConst=d,this.isSmartPointer=e,this.pointeeType=f,this.sharingPolicy=g,this.rawGetPointee=h,this.rawConstructor=i,this.rawShare=j,this.rawDestructor=k,!e&&b.baseClass===void 0?d?(this.toWireType=$b,this.destructorFunction=null):(this.toWireType=bc,this.destructorFunction=null):this.toWireType=ac}function rc(a,b,d){Object.prototype.hasOwnProperty.call(c,a)||Db("Replacing nonexistant public symbol"),void 0!==c[a].overloadTable&&void 0!==d?c[a].overloadTable[d]=b:(c[a]=b,c[a].argCount=d)}function sc(a,b,d){a=c["dynCall_"+a];return d&&d.length?a.apply(null,[b].concat(d)):a.call(null,b)}function tc(a,b,c){return a.includes("j")?sc(a,b,c):E(b).apply(null,c)}function uc(a,b){var c=[];return function(){c.length=arguments.length;for(var d=0;d<arguments.length;d++)c[d]=arguments[d];return tc(a,b,c)}}function V(a,b){a=M(a);function c(){return a.includes("j")?uc(a,b):E(b)}c=c();typeof c!=="function"&&Q("unknown function pointer with signature "+a+": "+b);return c}var vc=void 0;function wc(a){a=xd(a);var b=M(a);X(a);return b}function xc(a,b){var c=[],d={};function e(a){if(d[a])return;if(O[a])return;if(wb[a]){wb[a].forEach(e);return}c.push(a);d[a]=!0}b.forEach(e);throw new vc(a+": "+c.map(wc).join([", "]))}function yc(a,b,c,d,e,f,g,h,i,j,k,l,m){k=M(k);f=V(e,f);h&&(h=V(g,h));j&&(j=V(i,j));m=V(l,m);var n=zb(k);Xb(n,function(){xc("Cannot construct "+k+" due to unbound types",[d])});R([a,b,c],d?[d]:[],function(b){b=b[0];var c;d?(c=b.registeredClass,b=c.instancePrototype):b=T.prototype;var e=Ab(n,function(){if(Object.getPrototypeOf(this)!==g)throw new P("Use 'new' to construct "+k);if(void 0===i.constructor_body)throw new P(k+" has no accessible constructor");var a=i.constructor_body[arguments.length];if(void 0===a)throw new P("Tried to invoke ctor of "+k+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(i.constructor_body).toString()+") parameters instead!");return a.apply(this,arguments)}),g=Object.create(b,{constructor:{value:e}});e.prototype=g;var i=new Yb(k,e,g,m,c,f,h,j);b=new U(k,i,!0,!1,!1);var l=new U(k+"*",i,!1,!1,!1),o=new U(k+" const*",i,!1,!0,!1);Vb[a]={pointerType:l,constPointerType:o};rc(n,e);return[b,l,o]})}function zc(a,b){var c=[];for(var d=0;d<a;d++)c.push(x[(b>>2)+d]);return c}function Ac(a){while(a.length){var b=a.pop(),c=a.pop();c(b)}}function Bc(a,b,c,d,e,f){ja(b>0);var g=zc(b,c);e=V(d,e);R([],[a],function(a){a=a[0];var c="constructor "+a.name;void 0===a.registeredClass.constructor_body&&(a.registeredClass.constructor_body=[]);if(void 0!==a.registeredClass.constructor_body[b-1])throw new P("Cannot register multiple constructors with identical number of parameters ("+(b-1)+") for class '"+a.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");a.registeredClass.constructor_body[b-1]=function(){xc("Cannot construct "+a.name+" due to unbound types",g)};R([],g,function(d){d.splice(1,0,null);a.registeredClass.constructor_body[b-1]=Cc(c,d,null,e,f);return[]});return[]})}function Cc(a,b,c,d,e){var f=b.length;f<2&&Q("argTypes array size mismatch! Must at least get return value and 'this' types!");var g=b[1]!==null&&c!==null,h=!1;for(c=1;c<b.length;++c)if(b[c]!==null&&b[c].destructorFunction===void 0){h=!0;break}var i=b[0].name!=="void",j=f-2,k=new Array(j),l=[],m=[];return function(){arguments.length!==j&&Q("function "+a+" called with "+arguments.length+" arguments, expected "+j+" args!");m.length=0;var c;l.length=g?2:1;l[0]=e;g&&(c=b[1].toWireType(m,this),l[1]=c);for(var f=0;f<j;++f)k[f]=b[f+2].toWireType(m,arguments[f]),l.push(k[f]);var n=d.apply(null,l);function o(d){if(h)Ac(m);else for(var a=g?1:2;a<b.length;a++){var e=a===1?c:k[a-2];b[a].destructorFunction!==null&&b[a].destructorFunction(e)}if(i)return b[0].fromWireType(d)}return o(n)}}function Dc(a,b,c,d,e,f,g,h){var i=zc(c,d);b=M(b);f=V(e,f);R([],[a],function(a){a=a[0];var d=a.name+"."+b;b.startsWith("@@")&&(b=Symbol[b.substring(2)]);h&&a.registeredClass.pureVirtualFunctions.push(b);function e(){xc("Cannot call "+d+" due to unbound types",i)}var j=a.registeredClass.instancePrototype,k=j[b];void 0===k||void 0===k.overloadTable&&k.className!==a.name&&k.argCount===c-2?(e.argCount=c-2,e.className=a.name,j[b]=e):(Wb(j,b,d),j[b].overloadTable[c-2]=e);R([],i,function(e){e=Cc(d,e,a,f,g);void 0===j[b].overloadTable?(e.argCount=c-2,j[b]=e):j[b].overloadTable[c-2]=e;return[]});return[]})}var Ec=[],W=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Fc(a){a>4&&0===--W[a].refcount&&(W[a]=void 0,Ec.push(a))}function Gc(){var a=0;for(var b=5;b<W.length;++b)W[b]!==void 0&&++a;return a}function Hc(){for(var a=5;a<W.length;++a)if(W[a]!==void 0)return W[a];return null}function Ic(){c.count_emval_handles=Gc,c.get_first_emval=Hc}var Jc={toValue:function(a){a||Q("Cannot use deleted val. handle = "+a);return W[a].value},toHandle:function(a){switch(a){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var b=Ec.length?Ec.pop():W.length;W[b]={refcount:1,value:a};return b}}};function Kc(a,b){b=M(b),S(a,{name:b,fromWireType:function(a){var b=Jc.toValue(a);Fc(a);return b},toWireType:function(a,b){return Jc.toHandle(b)},argPackAdvance:8,readValueFromPointer:cc,destructorFunction:null})}function Lc(a){if(a===null)return"null";var b=typeof a;if(b==="object"||b==="array"||b==="function")return a.toString();else return""+a}function Mc(a,b){switch(b){case 2:return function(a){return this.fromWireType(Aa[a>>2])};case 3:return function(a){return this.fromWireType(Ba[a>>3])};default:throw new TypeError("Unknown float type: "+a)}}function Nc(a,b,c){c=tb(c);b=M(b);S(a,{name:b,fromWireType:function(a){return a},toWireType:function(a,b){return b},argPackAdvance:8,readValueFromPointer:Mc(b,c),destructorFunction:null})}function Oc(a,b,c,d,e,f){var g=zc(b,c);a=M(a);e=V(d,e);Xb(a,function(){xc("Cannot call "+a+" due to unbound types",g)},b-1);R([],g,function(c){c=[c[0],null].concat(c.slice(1));rc(a,Cc(a,c,null,e,f),b-1);return[]})}function Pc(a,b,c){switch(b){case 0:return c?function(a){return u[a]}:function(a){return v[a]};case 1:return c?function(a){return w[a>>1]}:function(a){return za[a>>1]};case 2:return c?function(a){return x[a>>2]}:function(a){return y[a>>2]};default:throw new TypeError("Unknown integer type: "+a)}}function Qc(a,b,c,d,e){b=M(b);e===-1&&(e=4294967295);e=tb(c);var f=function(a){return a};if(d===0){var g=32-8*c;f=function(a){return a<<g>>>g}}c=b.includes("unsigned");var h=function(a,b){};c?c=function(a,b){h(b,this.name);return b>>>0}:c=function(a,b){h(b,this.name);return b};S(a,{name:b,fromWireType:f,toWireType:c,argPackAdvance:8,readValueFromPointer:Pc(b,e,d!==0),destructorFunction:null})}function Rc(a,b,c){var d=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],e=d[b];function f(a){a=a>>2;var b=y,c=b[a];b=b[a+1];return new e(ya,b,c)}c=M(c);S(a,{name:c,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{ignoreDuplicateRegistrations:!0})}function Sc(a,b){b=M(b);var c=b==="std::string";S(a,{name:b,fromWireType:function(a){var b=y[a>>2],d;if(c){var e=a+4;for(var f=0;f<=b;++f){var g=a+4+f;if(f==b||v[g]==0){var h=g-e;h=la(e,h);d===void 0?d=h:(d+=String.fromCharCode(0),d+=h);e=g+1}}}else{h=new Array(b);for(var f=0;f<b;++f)h[f]=String.fromCharCode(v[a+4+f]);d=h.join("")}X(a);return d},toWireType:function(a,b){b instanceof ArrayBuffer&&(b=new Uint8Array(b));var d,e=typeof b==="string";e||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int8Array||Q("Cannot pass non-string to std::string");c&&e?d=function(){return oa(b)}:d=function(){return b.length};d=d();var f=wd(4+d+1);y[f>>2]=d;if(c&&e)na(b,f+4,d+1);else if(e)for(e=0;e<d;++e){var g=b.charCodeAt(e);g>255&&(X(f),Q("String has UTF-16 code units that do not fit in 8 bits"));v[f+4+e]=g}else for(e=0;e<d;++e)v[f+4+e]=b[e];a!==null&&a.push(X,f);return f},argPackAdvance:8,readValueFromPointer:cc,destructorFunction:function(a){X(a)}})}function Tc(a,b,c){c=M(c);var d,e,f,g,h;b===2?(d=qa,e=ra,g=sa,f=function(){return za},h=1):b===4&&(d=ta,e=ua,g=va,f=function(){return y},h=2);S(a,{name:c,fromWireType:function(a){var c=y[a>>2],e=f(),g,i=a+4;for(var j=0;j<=c;++j){var k=a+4+j*b;if(j==c||e[k>>h]==0){var l=k-i;l=d(i,l);g===void 0?g=l:(g+=String.fromCharCode(0),g+=l);i=k+b}}X(a);return g},toWireType:function(a,d){typeof d==="string"||Q("Cannot pass non-string to C++ string type "+c);var f=g(d),i=wd(4+f+b);y[i>>2]=f>>h;e(d,i+4,f+b);a!==null&&a.push(X,i);return i},argPackAdvance:8,readValueFromPointer:cc,destructorFunction:function(a){X(a)}})}function Uc(a,b){b=M(b),S(a,{isVoid:!0,name:b,argPackAdvance:0,fromWireType:function(){return void 0},toWireType:function(a,b){return void 0}})}function Vc(a){a>4&&(W[a].refcount+=1)}function Wc(a,b){var c=O[a];void 0===c&&Q(b+" has unknown type "+wc(a));return c}function Xc(a,b){a=Wc(a,"_emval_take_value");a=a.readValueFromPointer(b);return Jc.toHandle(a)}function Yc(){A("")}function Zc(a){A("OOM")}function $c(a){v.length,a=a>>>0,Zc(a)}var ad={};function bd(){return m||"./this.program"}function cd(){if(!cd.strings){var a=(typeof navigator==="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8";a={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:a,_:bd()};for(var b in ad)ad[b]===void 0?delete a[b]:a[b]=ad[b];var c=[];for(var b in a)c.push(b+"="+a[b]);cd.strings=c}return cd.strings}function dd(a,b){var c=0;cd().forEach(function(d,e){var f=b+c;x[a+e*4>>2]=f;xa(d,f);c+=d.length+1});return 0}function ed(a,b){var c=cd();x[a>>2]=c.length;var d=0;c.forEach(function(a){d+=a.length+1});x[b>>2]=d;return 0}function fd(a){try{a=L.getStreamFromFD(a);K.close(a);return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function gd(a,b,c,d){try{a=L.getStreamFromFD(a);a=L.doReadv(a,b,c);x[d>>2]=a;return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function hd(a,b,c,d,e){try{a=L.getStreamFromFD(a);var f=4294967296;c=c*f+(b>>>0);f=9007199254740992;if(c<=-f||c>=f)return-61;K.llseek(a,c,d);D=[a.position>>>0,(C=a.position,+Math.abs(C)>=1?C>0?(Math.min(+Math.floor(C/4294967296),4294967295)|0)>>>0:~~+Math.ceil((C-+(~~C>>>0))/4294967296)>>>0:0)],x[e>>2]=D[0],x[e+4>>2]=D[1];a.getdents&&c===0&&d===0&&(a.getdents=null);return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function id(a,b,c,d){try{a=L.getStreamFromFD(a);a=L.doWritev(a,b,c);x[d>>2]=a;return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function jd(){return ga()}function kd(a){r(a)}function ld(a){return a%4===0&&(a%100!==0||a%400===0)}function md(a,b){var c=0;for(var d=0;d<=b;c+=a[d++]);return c}var nd=[31,29,31,30,31,30,31,31,30,31,30,31],od=[31,28,31,30,31,30,31,31,30,31,30,31];function pd(a,b){a=new Date(a.getTime());while(b>0){var c=ld(a.getFullYear()),d=a.getMonth();c=(c?nd:od)[d];if(b>c-a.getDate())b-=c-a.getDate()+1,a.setDate(1),d<11?a.setMonth(d+1):(a.setMonth(0),a.setFullYear(a.getFullYear()+1));else{a.setDate(a.getDate()+b);return a}}return a}function qd(a,b,c,d){var e=x[d+40>>2];d={tm_sec:x[d>>2],tm_min:x[d+4>>2],tm_hour:x[d+8>>2],tm_mday:x[d+12>>2],tm_mon:x[d+16>>2],tm_year:x[d+20>>2],tm_wday:x[d+24>>2],tm_yday:x[d+28>>2],tm_isdst:x[d+32>>2],tm_gmtoff:x[d+36>>2],tm_zone:e?la(e):""};e=la(c);c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var f in c)e=e.replace(new RegExp(f,"g"),c[f]);var g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];function i(a,b,c){a=typeof a==="number"?a.toString():a||"";while(a.length<b)a=c[0]+a;return a}function j(a,b){return i(a,b,"0")}function k(a,b){function c(a){return a<0?-1:a>0?1:0}var d;(d=c(a.getFullYear()-b.getFullYear()))===0&&((d=c(a.getMonth()-b.getMonth()))===0&&(d=c(a.getDate()-b.getDate())));return d}function l(a){switch(a.getDay()){case 0:return new Date(a.getFullYear()-1,11,29);case 1:return a;case 2:return new Date(a.getFullYear(),0,3);case 3:return new Date(a.getFullYear(),0,2);case 4:return new Date(a.getFullYear(),0,1);case 5:return new Date(a.getFullYear()-1,11,31);case 6:return new Date(a.getFullYear()-1,11,30)}}function m(a){a=pd(new Date(a.tm_year+1900,0,1),a.tm_yday);var b=new Date(a.getFullYear(),0,4),c=new Date(a.getFullYear()+1,0,4);b=l(b);c=l(c);if(k(b,a)<=0)if(k(c,a)<=0)return a.getFullYear()+1;else return a.getFullYear();else return a.getFullYear()-1}c={"%a":function(a){return g[a.tm_wday].substring(0,3)},"%A":function(a){return g[a.tm_wday]},"%b":function(a){return h[a.tm_mon].substring(0,3)},"%B":function(a){return h[a.tm_mon]},"%C":function(a){a=a.tm_year+1900;return j(a/100|0,2)},"%d":function(a){return j(a.tm_mday,2)},"%e":function(a){return i(a.tm_mday,2," ")},"%g":function(a){return m(a).toString().substring(2)},"%G":function(a){return m(a)},"%H":function(a){return j(a.tm_hour,2)},"%I":function(a){a=a.tm_hour;a==0?a=12:a>12&&(a-=12);return j(a,2)},"%j":function(a){return j(a.tm_mday+md(ld(a.tm_year+1900)?nd:od,a.tm_mon-1),3)},"%m":function(a){return j(a.tm_mon+1,2)},"%M":function(a){return j(a.tm_min,2)},"%n":function(){return"\n"},"%p":function(a){if(a.tm_hour>=0&&a.tm_hour<12)return"AM";else return"PM"},"%S":function(a){return j(a.tm_sec,2)},"%t":function(){return"\t"},"%u":function(a){return a.tm_wday||7},"%U":function(a){var b=new Date(a.tm_year+1900,0,1),c=b.getDay()===0?b:pd(b,7-b.getDay());a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);if(k(c,a)<0){var d=md(ld(a.getFullYear())?nd:od,a.getMonth()-1)-31,e=31-c.getDate();e=e+d+a.getDate();return j(Math.ceil(e/7),2)}return k(c,b)===0?"01":"00"},"%V":function(a){var b=new Date(a.tm_year+1900,0,4),c=new Date(a.tm_year+1901,0,4);b=l(b);c=l(c);var d=pd(new Date(a.tm_year+1900,0,1),a.tm_yday);if(k(d,b)<0)return"53";if(k(c,d)<=0)return"01";b.getFullYear()<a.tm_year+1900?c=a.tm_yday+32-b.getDate():c=a.tm_yday+1-b.getDate();return j(Math.ceil(c/7),2)},"%w":function(a){return a.tm_wday},"%W":function(a){var b=new Date(a.tm_year,0,1),c=b.getDay()===1?b:pd(b,b.getDay()===0?1:7-b.getDay()+1);a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);if(k(c,a)<0){var d=md(ld(a.getFullYear())?nd:od,a.getMonth()-1)-31,e=31-c.getDate();e=e+d+a.getDate();return j(Math.ceil(e/7),2)}return k(c,b)===0?"01":"00"},"%y":function(a){return(a.tm_year+1900).toString().substring(2)},"%Y":function(a){return a.tm_year+1900},"%z":function(a){a=a.tm_gmtoff;var b=a>=0;a=Math.abs(a)/60;a=a/60*100+a%60;return(b?"+":"-")+String("0000"+a).slice(-4)},"%Z":function(a){return a.tm_zone},"%%":function(){return"%"}};for(var f in c)e.includes(f)&&(e=e.replace(new RegExp(f,"g"),c[f](d)));c=ud(e,!1);if(c.length>b)return 0;wa(c,a);return c.length-1}function rd(a,b,c,d){return qd(a,b,c,d)}d=function(a,b,c,d){a||(a=this),this.parent=a,this.mount=a.mount,this.mounted=null,this.id=K.nextInode++,this.name=b,this.mode=c,this.node_ops={},this.stream_ops={},this.rdev=d};var sd=292|73,td=146;Object.defineProperties(d.prototype,{read:{get:function(){return(this.mode&sd)===sd},set:function(a){a?this.mode|=sd:this.mode&=~sd}},write:{get:function(){return(this.mode&td)===td},set:function(a){a?this.mode|=td:this.mode&=~td}},isFolder:{get:function(){return K.isDir(this.mode)}},isDevice:{get:function(){return K.isChrdev(this.mode)}}});K.FSNode=d;K.staticInit();ub();P=c.BindingError=Bb(Error,"BindingError");Cb=c.InternalError=Bb(Error,"InternalError");Ub();qc();kc();vc=c.UnboundTypeError=Bb(Error,"UnboundTypeError");Ic();function ud(a,b,c){c=c>0?c:oa(a)+1;c=new Array(c);a=ma(a,c,0,c.length);b&&(c.length=a);return c}var vd={p:Ya,t:db,w:gb,b:ib,g:jb,x:eb,K:kb,u:lb,Y:mb,d:hb,ba:qb,_:rb,U:sb,da:Eb,z:yc,y:Bc,o:Dc,ca:Kc,N:Nc,ga:Oc,s:Qc,m:Rc,M:Sc,G:Tc,ea:Uc,fa:Fc,R:Vc,Q:Xc,C:Yc,Z:$c,$:dd,aa:ed,W:fd,L:gd,T:hd,F:id,a:jd,H:Qd,I:Pd,l:Rd,c:Dd,e:Gd,k:Hd,h:Md,X:Nd,q:Fd,J:Od,P:Jd,B:Td,S:Wd,i:Kd,r:Ed,f:Bd,j:Cd,D:Id,O:Ld,n:Sd,v:Ud,A:Vd,E:kd,V:rd};Wa();c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.ia).apply(null,arguments)};c._bytearray_free=function(){return(c._bytearray_free=c.asm.ja).apply(null,arguments)};var X=c._free=function(){return(X=c._free=c.asm.la).apply(null,arguments)},wd=c._malloc=function(){return(wd=c._malloc=c.asm.ma).apply(null,arguments)},xd=c.___getTypeName=function(){return(xd=c.___getTypeName=c.asm.na).apply(null,arguments)};c.___embind_register_native_and_builtin_types=function(){return(c.___embind_register_native_and_builtin_types=c.asm.oa).apply(null,arguments)};var Y=c._setThrew=function(){return(Y=c._setThrew=c.asm.pa).apply(null,arguments)},Z=c.stackSave=function(){return(Z=c.stackSave=c.asm.qa).apply(null,arguments)},$=c.stackRestore=function(){return($=c.stackRestore=c.asm.ra).apply(null,arguments)},yd=c.___cxa_can_catch=function(){return(yd=c.___cxa_can_catch=c.asm.sa).apply(null,arguments)},zd=c.___cxa_is_pointer_type=function(){return(zd=c.___cxa_is_pointer_type=c.asm.ta).apply(null,arguments)};c.dynCall_ji=function(){return(c.dynCall_ji=c.asm.ua).apply(null,arguments)};c.dynCall_viijii=function(){return(c.dynCall_viijii=c.asm.va).apply(null,arguments)};c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.wa).apply(null,arguments)};var Ad=c.dynCall_jiiii=function(){return(Ad=c.dynCall_jiiii=c.asm.xa).apply(null,arguments)};c.dynCall_iiiiij=function(){return(c.dynCall_iiiiij=c.asm.ya).apply(null,arguments)};c.dynCall_iiiiijj=function(){return(c.dynCall_iiiiijj=c.asm.za).apply(null,arguments)};c.dynCall_iiiiiijj=function(){return(c.dynCall_iiiiiijj=c.asm.Aa).apply(null,arguments)};function Bd(a,b,c){var d=Z();try{E(a)(b,c)}catch(a){$(d);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Cd(a,b,c,d){var e=Z();try{E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Dd(a,b){var c=Z();try{return E(a)(b)}catch(a){$(c);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Ed(a,b){var c=Z();try{E(a)(b)}catch(a){$(c);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Fd(a,b,c,d,e,f,g){var h=Z();try{return E(a)(b,c,d,e,f,g)}catch(a){$(h);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Gd(a,b,c){var d=Z();try{return E(a)(b,c)}catch(a){$(d);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Hd(a,b,c,d){var e=Z();try{return E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Id(a,b,c,d,e){var f=Z();try{E(a)(b,c,d,e)}catch(a){$(f);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Jd(a,b,c,d,e,f,g,h,i){var j=Z();try{return E(a)(b,c,d,e,f,g,h,i)}catch(a){$(j);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Kd(a){var b=Z();try{E(a)()}catch(a){$(b);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Ld(a,b,c,d,e,f){var g=Z();try{E(a)(b,c,d,e,f)}catch(a){$(g);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Md(a,b,c,d,e){var f=Z();try{return E(a)(b,c,d,e)}catch(a){$(f);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Nd(a,b,c,d,e,f){var g=Z();try{return E(a)(b,c,d,e,f)}catch(a){$(g);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Od(a,b,c,d,e,f,g,h){var i=Z();try{return E(a)(b,c,d,e,f,g,h)}catch(a){$(i);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Pd(a,b,c,d){var e=Z();try{return E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Qd(a,b,c,d){var e=Z();try{return E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Rd(a){var b=Z();try{return E(a)()}catch(a){$(b);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Sd(a,b,c,d,e,f,g,h){var i=Z();try{E(a)(b,c,d,e,f,g,h)}catch(a){$(i);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Td(a,b,c,d,e,f,g,h,i,j,k,l){var m=Z();try{return E(a)(b,c,d,e,f,g,h,i,j,k,l)}catch(a){$(m);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Ud(a,b,c,d,e,f,g,h,i,j,k){var l=Z();try{E(a)(b,c,d,e,f,g,h,i,j,k)}catch(a){$(l);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Vd(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var aa=Z();try{E(a)(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)}catch(a){$(aa);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Wd(a,b,c,d,e){var f=Z();try{return Ad(a,b,c,d,e)}catch(a){$(f);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}var Xd;Oa=function a(){Xd||Yd(),Xd||(Oa=a)};function Yd(a){a||l;if(z>0)return;Ha();if(z>0)return;function b(){if(Xd)return;Xd=!0;c.calledRun=!0;if(ia)return;Ia();i(c);c.onRuntimeInitialized&&c.onRuntimeInitialized();Ja()}c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),b()},1)):b()}c.run=Yd;if(c.preInit){typeof c.preInit=="function"&&(c.preInit=[c.preInit]);while(c.preInit.length>0)c.preInit.pop()()}Yd();return c.ready}}();typeof f==="object"&&typeof e==="object"?e.exports=h:typeof define==="function"&&define.amd?define([],function(){return h}):typeof f==="object"&&(f.Module=h)}),null);
__d("PakeCpaceWasm",["PakeCpaceUtils","Promise","bx","err","pakeCpace"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var e={locateFile:function(){return c("bx").getURL(c("bx")("20913"))},wasmBinary:a};return new(h||(h=b("Promise")))(function(a){c("pakeCpace")(e).then(function(b){return a({clientBegin:function(a,c,d){var e=0;try{e=a.clientBegin(c,d);a=b.getInt8Array(e);return a}finally{b._bytearray_free(e)}},clientFinalize:function(a,c){var e=0,f=0;try{c=d("PakeCpaceUtils").uint8ArrayToVectorInt(b,c);a=a.clientFinalize(c);e=a.getKey1Ptr();c=b.getInt8Array(e);f=a.getKey2Ptr();a=b.getInt8Array(f);return{clientKey1:c,clientKey2:a}}finally{b._bytearray_free(e),b._bytearray_free(f)}},createCPaceClient:function(a){return new b.PAKEClient(a)},createCPaceServer:function(a){return new b.PAKEServer(a)},serverHandleClientStepOnePacket:function(a,c,e,f){var g=0,h=0,i=0;try{e=d("PakeCpaceUtils").uint8ArrayToVectorInt(b,e);a=a.handleClientStepOnePacket(c,e,f);g=a.getKey1Ptr();c=b.getInt8Array(g);h=a.getKey2Ptr();e=b.getInt8Array(h);i=a.getPacketPtr();f=b.getInt8Array(i);return{serverKey1:c,serverKey2:e,stepTwoPacket:f}}finally{b._bytearray_free(g),b._bytearray_free(h),b._bytearray_free(i)}}})})["catch"](function(a){throw c("err")("Failed to initialize wasm module, "+a)})})}g.PakeCPaceWasm=a}),98);
__d("usePakeInitiatorManager",["Base64Utils","FBLogger","I64","MWEncryptedBackupsDeviceRegistrationId","MWPakeQPLEvents","PAKECleanupSessionReasonEnum","PAKEDecryptSecretSprocStatusEnum","PAKEGetActiveSessionSprocStatusEnum","PAKEMessageTypeEnum","PakeCpaceUtils","PakeCpaceWasm","QPLUserFlow","ReQL","asyncToGeneratorRuntime","clearTimeout","promiseDone","react","requireDeferred","setTimeout","usePakeQplLogging","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e=i||d("react");var k=e.useEffect,l=e.useMemo,m=e.useRef,n=c("requireDeferred")("CleanupPakeSession").__setRef("usePakeInitiatorManager"),o=c("requireDeferred")("PakeInitiatorSprocCalls").__setRef("usePakeInitiatorManager"),p=(j||(j=d("I64"))).of_int32(-1),q=3e4,r=3e3,s="PAKE_INITIATOR_FAILURE";function a(a){var e=a.onGeneralFailure,f=a.onMaxAttemptsReached,g=a.onNoSessionExists,i=a.onSessionExpired,t=a.onSuccessfulSecretDecryption,u=a.onWrongOtc,v=a.timeout,w=v===void 0?q:v,x=a.clientType,y=(h||(h=c("useReStore")))(),z=m(function(){}),A=m(!1),B=m(""),C=m(null),D=m(null),E=m(null),F=m(null),G=m(!1);v=d("usePakeQplLogging").usePakeQplLogging();var H=v.endFailure,I=v.startFlow,J=l(function(){return d("ReQL").fromTableAscending(y.table("pake_messages"))},[y]),K=function(a){E.current&&c("clearTimeout")(E.current),E.current=c("setTimeout")(function(){e(),z.current(),n.onReady(function(b){c("promiseDone")(b({cleanupReason:c("PAKECleanupSessionReasonEnum").TIMEOUT,clientType:x,deviceId:a,storage:y}))}),c("FBLogger")("labyrinth_web").mustfix("PAKE handshake failed by timeout")},w)},L=function(){F.current&&c("clearTimeout")(F.current),F.current=c("setTimeout")(function(){c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_RETRY_JOIN_SESSION"),G.current=!0,c("promiseDone")(U(B.current))},r)},M=function(a){var b=a.initiatorId,d=a.messageType,f=a.sessionId;e();o.onReady(function(a){c("promiseDone")(a.sendPakeMessage({clientType:x,messageType:d,senderId:b,sessionId:f,storage:y}))})},N=function(){E.current&&c("clearTimeout")(E.current)};k(function(){A.current===!1&&(A.current=!0,c("promiseDone")(d("PakeCpaceWasm").PakeCPaceWasm().then(function(a){D.current=a}),void 0,function(){c("FBLogger")("labyrinth_web").mustfix("PAKE: Error loading WASM module")}));return function(){var a;z.current();(a=C.current)==null?void 0:a["delete"]();N()}},[]);var O=function(a){var b=a.initiatorId,e=a.messagePayload,f=a.pakeClient,g=a.pakeCpaceModule,h=a.responderId,i=a.sessionId;c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_STEP_THREE_START");if(e==null){c("FBLogger")("labyrinth_web").mustfix("PAKE: When executing step 3 of CPace Handshake messagePayload was null");H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR}});return}if(h==null){c("FBLogger")("labyrinth_web").mustfix("PAKE: When executing step 3 of CPace Handshake responderId was null");H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR}});return}a=d("Base64Utils").toArrayBuffer(e);var k;try{h=g.clientFinalize(f,new Uint8Array(a));k=h.clientKey1}catch(a){M({initiatorId:b,messageType:c("PAKEMessageTypeEnum").CPACE_STEP_3_ERROR,sessionId:i});H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").CPACE_STEP_3_ERROR}});throw c("FBLogger")("labyrinth_web").mustfixThrow("PAKE: Error executing CPace step 3")}c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_DECRYPT_SECRET_START");o.onReady(function(a){c("promiseDone")(a.decryptPakeSecret({clientType:x,encryptionKey:d("PakeCpaceUtils").typedArrayToBuffer(k),sessionId:i,storage:y}),function(e){var f=e[0];e=e[1];N();switch((j||(j=d("I64"))).to_int32(e)){case c("PAKEDecryptSecretSprocStatusEnum").SUCCESS:if(f==null){H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").GENERIC_ERROR}});throw c("FBLogger")("labyrinth_web").mustfixThrow("PAKE: decryptedSecret is null despite SPROC success")}c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_DECRYPT_SECRET_END");c("promiseDone")(a.sendPakeMessage({clientType:x,messageType:c("PAKEMessageTypeEnum").PAKE_HANDSHAKE_SUCCESS,senderId:b,sessionId:i,storage:y}));t({decryptedSecret:f,initiatorId:b});break;case c("PAKEDecryptSecretSprocStatusEnum").WRONG_KEYS:H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!0}});u();break;case c("PAKEDecryptSecretSprocStatusEnum").FAILURE:H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1}});M({initiatorId:b,messageType:c("PAKEMessageTypeEnum").DECRYPTION_ERROR,sessionId:i});break}},function(a){H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},string:{exceptionMessage:a}}),M({initiatorId:b,messageType:c("PAKEMessageTypeEnum").DECRYPTION_ERROR,sessionId:i})})})},P=function(a){var b=a.annotations,e=a.fbLoggerMessage,f=a.messageType,g=a.onFinish;a=a.unsubFromTable;N();a();g();e!=null&&c("FBLogger")("labyrinth_web").mustfix(e,f);H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,b)},Q=function(a){var b=a.onPakeStepOneSuccess;z.current=J.subscribe(function(a,f){if(f.operation!=="put"&&f.operation!=="add")return;a=f.value;f=(j||(j=d("I64"))).to_int32(a.messageType);switch(f){case c("PAKEMessageTypeEnum").PAKE_MESSAGE_1:c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_SEND_PAKE_MESSAGE_ONE_END");z.current();b();break;case c("PAKEMessageTypeEnum").INVALID_PREVIOUS_MESSAGE_ERROR:case c("PAKEMessageTypeEnum").PREVIOUS_MESSAGE_MISSING_ERROR:return P({annotations:{bool:{isUserError:!1},"int":{errorCode:f}},fbLoggerMessage:"PAKE: Failed to send PAKE message one due to invalid state",messageType:f,onFinish:function(){return e()},unsubFromTable:function(){z.current()}});case c("PAKEMessageTypeEnum").MESSAGE_SENT_ERROR:return P({annotations:{bool:{isUserError:!1},"int":{errorCode:f}},fbLoggerMessage:"PAKE: Failed to send PAKE message one",messageType:f,onFinish:function(){return e()},unsubFromTable:function(){z.current()}});default:break}})},R=function(a){var b=a.initiatorId,g=a.pakeClient,h=a.pakeCpaceModule,k=a.sessionId;z.current=J.subscribe(function(a,l){if(l.operation!=="put"&&l.operation!=="add")return;a=l.value;l=(j||(j=d("I64"))).to_int32(a.messageType);switch(l){case c("PAKEMessageTypeEnum").PAKE_MESSAGE_2_AND_SECRET:z.current();O({initiatorId:b,messagePayload:a.messagePayload,pakeClient:g,pakeCpaceModule:h,responderId:a.responderId,sessionId:k});break;case c("PAKEMessageTypeEnum").MAX_ATTEMPTS_ERROR:return P({annotations:{bool:{isUserError:!0},"int":{errorCode:l}},messageType:l,onFinish:function(){return f()},unsubFromTable:function(){z.current()}});case c("PAKEMessageTypeEnum").SESSION_EXPIRED_ERROR:return P({annotations:{bool:{isUserError:!0},"int":{errorCode:l}},messageType:l,onFinish:function(){return i()},unsubFromTable:function(){z.current()}});case c("PAKEMessageTypeEnum").GENERIC_ERROR:return P({annotations:{bool:{isUserError:!1},"int":{errorCode:l}},fbLoggerMessage:"PAKE: Something went wrong in the responder device",messageType:l,onFinish:function(){return e()},unsubFromTable:function(){z.current()}});case c("PAKEMessageTypeEnum").FETCH_SECRETS_ERROR:return P({annotations:{bool:{isUserError:!1},"int":{errorCode:l}},fbLoggerMessage:"PAKE: Responder device failed to fetch secrets.",messageType:l,onFinish:function(){return e()},unsubFromTable:function(){z.current()}});case c("PAKEMessageTypeEnum").FLOW_ABANDONED_ERROR:return P({annotations:{bool:{isUserError:!1},"int":{errorCode:l}},fbLoggerMessage:"PAKE: Responder device flow was abandoned.",messageType:l,onFinish:function(){return e()},unsubFromTable:function(){z.current()}});default:return P({annotations:{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").GENERIC_ERROR}},fbLoggerMessage:"PAKE: Unexpected Message Type when listening for pake step two success "+l,messageType:l,onFinish:function(){return e()},unsubFromTable:function(){z.current()}})}})},S=function(a){var b=a.initiatorId,f=a.onJoinSessionSuccess;c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_GET_ACTIVE_SESSION_START");o.onReady(function(a){c("promiseDone")(a.joinPakeSession({clientType:x,initiatorId:b,storage:y}),function(a){var b=a[0],h=a[1];a=a[2];h=(h=h)!=null?h:p;switch((j||(j=d("I64"))).to_int32(b)){case c("PAKEGetActiveSessionSprocStatusEnum").SUCCESS:if(a==null||h===p){c("FBLogger")("labyrinth_web").mustfix("PAKE: When joining session, responderId or joinedSessionId were unexpectedly null");H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").GENERIC_ERROR}});e();return}f(a,h);c("QPLUserFlow").addAnnotations(d("MWPakeQPLEvents").pakeInitiatorQplEvent,{string:{session_id:(j||(j=d("I64"))).to_string(h)}});break;case c("PAKEGetActiveSessionSprocStatusEnum").NO_SESSION:if(G.current===!1){L();return}H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!0},"int":{errorCode:c("PAKEMessageTypeEnum").NO_ACTIVE_SESSION}});g();N();break;case c("PAKEGetActiveSessionSprocStatusEnum").FAILURE:H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").GENERIC_ERROR}});c("FBLogger")("labyrinth_web").mustfix("PAKE: When joining session, sproc failed");e();N();break}},function(){H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").GENERIC_ERROR}}),c("FBLogger")("labyrinth_web").mustfix("PAKE: When joining session, sproc failed"),e(),N()})})},T=function(a){var b=a.initiatorId,e=a.otc,f=a.pakeClient,g=a.pakeCpaceModule,h=a.responderId,i=a.sessionId,j;c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_CPACE_STEP_ONE_START");try{j=g.clientBegin(f,e,h)}catch(a){M({initiatorId:b,messageType:c("PAKEMessageTypeEnum").CPACE_STEP_1_ERROR,sessionId:i});H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").CPACE_STEP_1_ERROR}});throw c("FBLogger")("labyrinth_web").mustfixThrow("PAKE: Error executing CPace step 1")}c("QPLUserFlow").addPoint(d("MWPakeQPLEvents").pakeInitiatorQplEvent,"PAKE_SEND_MESSAGE_ONE_START");o.onReady(function(a){a.sendPakeMessageOne({clientType:x,initiatorId:b,messagePayload:d("PakeCpaceUtils").typedArrayToBuffer(j),sessionId:i,storage:y})});Q({onPakeStepOneSuccess:function(){R({initiatorId:b,pakeClient:f,pakeCpaceModule:g,sessionId:i})}})},U=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();if(b===""){H(d("MWPakeQPLEvents").pakeInitiatorQplEvent,s,{bool:{isUserError:!1},"int":{errorCode:c("PAKEMessageTypeEnum").GENERIC_ERROR}});return}B.current=a;var e;D.current==null?(e=(yield d("PakeCpaceWasm").PakeCPaceWasm()),D.current=e):e=D.current;K(b);I(d("MWPakeQPLEvents").pakeInitiatorQplEvent);var f=e.createCPaceClient(b);C.current=f;S({initiatorId:b,onJoinSessionSuccess:function(c,d){T({initiatorId:b,otc:a,pakeClient:f,pakeCpaceModule:e,responderId:c,sessionId:d})}})});return function(b){return a.apply(this,arguments)}}();return{establishPakeHandshakeAsInitiator:U}}g["default"]=a}),98);
__d("MWEncryptedBackupsInsertOTCStep.react",["fbt","CometRelay","FBLogger","FocusRegion.react","MAWWaitForBackendSetup","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsOTCEligibleDevicesContext.react","MWXColumn.react","MWXColumnItem.react","MWXDialogPageLegacy.react","MWXLink.react","MWXMultiStepDialogHeader.react","MWXSpinner.react","MWXText.react","PAKEClientTypeEnum","QPLUserFlow","focusScopeQueries","gkx","promiseDone","react","requireDeferred","useDeserializeSecretsAndAddDevice","useFetchOTCEligibleEBDevices","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","usePakeInitiatorManager","useReStore","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useCallback,m=b.useContext,n=b.useEffect,o=b.useRef,p=b.useState,q=c("requireDeferred")("MWEBUseLocalStorage").__setRef("MWEncryptedBackupsInsertOTCStep.react"),r=c("requireDeferred")("MWEncrypedBackupsSendOTCNotifications").__setRef("MWEncryptedBackupsInsertOTCStep.react"),s=c("requireDeferred")("MWEncryptedBackupsFetchBackupIds").__setRef("MWEncryptedBackupsInsertOTCStep.react"),t=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("MWEncryptedBackupsInsertOTCStep.react"),u=c("requireDeferred")("triggerBackupStatusTrigger").__setRef("MWEncryptedBackupsInsertOTCStep.react"),v="chat-encrypted-backups-dialog-layout-second-step",w=6,x=c("gkx")("23219"),y=c("gkx")("20861"),z=function(){return h._("__JHASH__lBlURV9iIv0__JHASH__")},A=function(){return h._("__JHASH__rIH_-tfv2x2__JHASH__")},B=function(){return h._("__JHASH__WypD50Gdi03__JHASH__")},C=function(){return h._("__JHASH__7uRJ4wtXcoz__JHASH__")},D=function(){return h._("__JHASH__XUu1h3R4qPj__JHASH__")},E=function(){return h._("__JHASH__ndaWq552FSK__JHASH__")},F=function(){return h._("__JHASH__WoNRZZnIdhP__JHASH__")};function a(a){var b=a.onComplete,e=a.onViewAllDevices;a=p(!1);var f=a[0],g=a[1],j=o(!1),G=o(!1),H=o(function(){});a=p(null);var I=a[0],J=a[1],K=(i||(i=c("useReStore")))(),L=d("CometRelay").useRelayEnvironment(),M=c("useDeserializeSecretsAndAddDevice")();a=c("useFetchOTCEligibleEBDevices")();var N=a.failedToFetchOtcDevices,O=a.isFetchOtcDevicesInFlight,P=a.otcEligibleDevices,Q=a.triggerFetchOtcEligibleDevices;a=m(d("MWEncryptedBackupsOTCEligibleDevicesContext.react").MWEncryptedBackupsOTCEligibleDevicesContext);var R=a.setFailedToFetchOtcDevices,S=a.setIsFetchOtcDevicesInFlight,T=a.setOtcEligibleDevices,U=c("useMWEBFlowSourceContext")();n(function(){return function(){H.current()}},[]);n(function(){j.current===!1&&(j.current=!0,r.onReady(function(a){a=a.sendOTCNotifications;c("promiseDone")(a({db:K,onFailure:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_SEND_NOTIFICATION_FAILURE"),J(E())},otcEligibleDevices:[]}),function(a){H.current=a},function(){c("FBLogger")("labyrinth_web").mustfix("OTC: Send otc notifications sproc failed."),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_SEND_NOTIFICATION_FAILURE"),J(E())})})),S(O),T(P),R(N)},[K,N,O,P,R,S,T]);a=c("usePakeInitiatorManager")({clientType:c("PAKEClientTypeEnum").ENCRYPTED_BACKUPS,onGeneralFailure:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_API_FAILURE"),J(D()),G.current=!0,g(!1)},[]),onMaxAttemptsReached:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_MAX_ATTEMPTS_REACHED"),J(B()),G.current=!0,g(!1)},[]),onNoSessionExists:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_NO_SESSION"),J(A()),G.current=!0,g(!1)},[]),onSessionExpired:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SESSION_EXPIRED"),J(C()),G.current=!0,g(!1)},[]),onSuccessfulSecretDecryption:l(function(a){var e=a.decryptedSecret;a=a.initiatorId;M({initiatorId:a,onAddDeviceFailure:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_ADD_DEVICE_FAILURE"),J(D()),G.current=!0,g(!1)},onAddDeviceFinish:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_ADD_DEVICE_FINISHED"),d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("MAWWaitForBackendSetup").isBackendSetupSuccessful()}},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),t.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:K,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))}),q.onReady(function(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}),b(),g(!1),s.onReady(function(a){a=a.encryptedBackupsFetchBackupIds;a(K)["catch"](function(a){return c("FBLogger")("labyrinth_web").mustfix("OTC Restore: Error when fetching backup ids, %s",a)})}),c("promiseDone")(u.load(),function(a){a({environment:L})})},secrets:e})},[K,M,L,b]),onWrongOtc:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_INCORRECT_CODE"),J(z()),G.current=!0,g(!1)},[])});var V=a.establishPakeHandshakeAsInitiator;a=d("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode({focusRegionId:v,inputSize:w,onChange:function(){J()},onComplete:function(a){var b=U();c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{restore_type:"one_time_code",source:b}});g(!0);c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SUBMIT");c("promiseDone")(V(a))}});var W=a[0];a=a[1];var X=a.clearNumericInput,Y=a.focusOnInput;a=a.isLoading;n(function(){G.current&&(X(),G.current=!1)},[X]);var Z=c("useVisibilityObserver")({onVisible:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SCREEN"),Y()}});return k.jsxs(k.Fragment,{children:[k.jsx(c("MWXMultiStepDialogHeader.react"),{title:h._("__JHASH__tNwKql8Ahz9__JHASH__"),withCloseButton:!1,withoutBackButton:!0}),k.jsx(c("MWXDialogPageLegacy.react"),{callToActionGroupLayout:"expanded",includeFDSContentPadding_REMOVE_THIS_AFTER_CONTENT_PADDING_MIGRATION:!1,ref:Z,children:k.jsx("div",{className:"x2lwn1j",children:k.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingVertical:16,spacing:0,children:[k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx("div",{className:"x1l90r2v x2b8uid",children:k.jsx(c("MWXText.react"),{color:"secondary",type:"body3",children:h._("__JHASH__cJomUxxVnoi__JHASH__")})})}),k.jsxs(c("MWXColumnItem.react"),{align:"center",children:[k.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:I,children:k.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:v,children:k.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},W,{disabled:a||f,testid:void 0}))})}),y&&I===D()?k.jsx("div",{className:"xwib8y2",children:k.jsx(c("MWXText.react"),{align:"center",color:"negative",type:"body4",children:h._("__JHASH__47yJJ8U23lB__JHASH__")})}):null,f?k.jsxs("div",{className:"x6s0dn4 x78zum5 xl56j7k x135pmgq xwib8y2",children:[k.jsx("div",{className:"x1sxyh0",children:k.jsx(c("MWXSpinner.react"),{color:x?"disabled":"blue",size:12})}),k.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"meta3",children:h._("__JHASH__zNLcSfOKcLf__JHASH__")})]}):null]}),k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx("div",{className:"x1y1aw1k",children:k.jsx(c("MWXLink.react"),{color:x?"primary":"highlight",disabled:f||a,display:"block",onClick:function(){X(),J(),e({onFetchOtcEligibleDevicesError:function(){J(F()),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_FETCH_OTC_ELIGIBLE_DEVICES_FAILURE"),Q()},onResendCodeFailure:function(){J(E()),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESEND_NOTIFICATION_FAILURE")}}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_VIEW_ALL_DEVICES_CLICK")},rel:"noreferrer",children:k.jsx(c("MWXText.react"),{color:f?"disabled":"highlight",type:"button2",children:h._("__JHASH__UdIx77e_03V__JHASH__")})})})})]})})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWEncryptedBackupsViewAllOtcEligibleDialogStep.react",["fbt","CometScrollableArea.react","FBLogger","FDSListCellGlimmer.react","MWChatEncryptedBackupsQPLEvents","MWEncrypedBackupsSendOTCNotifications","MWEncryptedBackupsEligibleDeviceCell.react","MWEncryptedBackupsOTCEligibleDevicesContext.react","MWXColumn.react","MWXColumnItem.react","MWXDialogPageLegacy.react","MWXMultiStepDialogHeader.react","MWXText.react","QPLUserFlow","gkx","promiseDone","react","useReStore","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useContext,m=b.useEffect,n=b.useRef,o=b.useState,p=c("gkx")("23219"),q="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more",r={cellsScrollableAreaFds:{marginStart:"x1mh8g0r",marginLeft:null,marginRight:null,maxHeight:"xwazeda",paddingBottom:"x10b6aqq",width:"xh8yej3",$$css:!0},cellsScrollableAreaMds:{marginStart:"x1hk0nng",marginLeft:null,marginRight:null,maxHeight:"x8vp032",width:"xh8yej3",$$css:!0},loadingGlimmer:{paddingTop:"x889kno",width:"x65xoit",$$css:!0},subtitle:{minWidth:"x977yut",paddingTop:"xyamay9",$$css:!0}};function a(a){var b=a.onFetchOtcEligibleDevicesError,e=a.onResendCodeFailure,f=a.onReturn;a=c("useVisibilityObserver")({onVisible:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_VIEW_ALL_DEVICES_SCREEN")}});var g=(i||(i=c("useReStore")))(),j=n(!1),s=n(function(){}),t=o(!1),u=t[0],v=t[1];t=l(d("MWEncryptedBackupsOTCEligibleDevicesContext.react").MWEncryptedBackupsOTCEligibleDevicesContext);var w=t.failedToFetchOtcDevices,x=t.isFetchOtcDevicesInFlight;t=t.otcEligibleDevices;var y=x?null:t.length;m(function(){(y===0||w)&&j.current===!1&&(j.current=!0,f(),b())},[w,y,b,f]);m(function(){return function(){s.current()}},[]);return k.jsxs(k.Fragment,{children:[k.jsx(c("MWXMultiStepDialogHeader.react"),{title:h._("__JHASH__MFhuz6OB9p3__JHASH__"),withCloseButton:!1,withoutBackButton:!0}),k.jsx(c("MWXDialogPageLegacy.react"),{callToActionGroupLayout:"expanded",primaryCallToAction:{label:h._("__JHASH__rgoYqsLs8Qq__JHASH__"),loading:u,onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_RESEND_CODE_CLICK"),c("promiseDone")(d("MWEncrypedBackupsSendOTCNotifications").sendOTCNotifications({db:g,onFailure:function(){v(!1),f(),e()},onStart:function(){v(!0)},onSuccess:function(){v(!1),f()},otcEligibleDevices:[]}),function(a){s.current=a},function(){c("FBLogger")("labyrinth_web").mustfix("OTC: Send otc notifications sproc failed."),f(),e()})}},ref:a,secondaryCallToAction:{label:h._("__JHASH__kVQyhECs96C__JHASH__"),linkProps:{target:"_blank",url:q},onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_CANT_ACCESS_CODE_CLICK")}},children:k.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:0,paddingVertical:0,spacing:16,children:[k.jsx(c("MWXColumnItem.react"),{align:"start",children:k.jsx("div",{className:"x977yut xyamay9",children:k.jsx(c("MWXText.react"),{color:"secondary",type:"body3",children:h._("__JHASH__t7U8UIKqWo9__JHASH__")})})}),k.jsx(c("MWXColumnItem.react"),{align:"start",children:x?k.jsx("div",{className:"x889kno x65xoit",children:k.jsx(c("FDSListCellGlimmer.react"),{imageStyle:"circle",paddingHorizontal:0})}):k.jsx(c("CometScrollableArea.react"),{horizontal:!1,xstyle:p?r.cellsScrollableAreaMds:r.cellsScrollableAreaFds,children:k.jsx(c("MWXColumn.react"),{align:"center",paddingHorizontal:0,paddingVertical:0,spacing:0,children:t.map(function(a,b){var d=a.appId,e=a.deviceId,f=a.manufacturer;a=a.model;return a!=null&&f!=null?k.jsx(c("MWXColumnItem.react"),{align:"start",children:k.jsx(c("MWEncryptedBackupsEligibleDeviceCell.react"),{deviceAppId:d,deviceManufacturer:f,deviceModel:a,eligibleDeviceCellId:"mw-chat-encrypted-backups-eligible-otc-device-"+b})},e):null})})})})]})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("PakeInitiatorSprocCalls",["LSDecryptPakeSecretStoredProcedure","LSFactory","LSGetActiveSessionStoredProcedure","LSIntEnum","LSSendPakeMessageOneStoredProcedure","LSSendPakeMessageStoredProcedure","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=a.clientType,e=a.initiatorId,f=a.messagePayload,g=a.sessionId;a=a.storage;c("promiseDone")(a.runInTransaction(function(a){return c("LSSendPakeMessageOneStoredProcedure")(c("LSFactory")(a),{clientType:(h||(h=d("LSIntEnum"))).ofNumber(b),initiatorId:e,messagePayload:f,sessionId:g})},"readwrite"))}function b(a){var b=a.clientType,e=a.initiatorId;a=a.storage;return a.runInTransaction(function(a){return c("LSGetActiveSessionStoredProcedure")(c("LSFactory")(a),{clientType:(h||(h=d("LSIntEnum"))).ofNumber(b),initiatorId:e})},"readwrite")}function e(a){var b=a.clientType,e=a.encryptionKey,f=a.sessionId;a=a.storage;return a.runInTransaction(function(a){return c("LSDecryptPakeSecretStoredProcedure")(c("LSFactory")(a),{clientType:(h||(h=d("LSIntEnum"))).ofNumber(b),encryptionKey:e,sessionId:f})},"readwrite")}function f(a){var b=a.clientType,e=a.messagePayload,f=a.messageType,g=a.senderId,i=a.sessionId;a=a.storage;return a.runInTransaction(function(a){return c("LSSendPakeMessageStoredProcedure")(c("LSFactory")(a),{clientType:(h||(h=d("LSIntEnum"))).ofNumber(b),messagePayload:e,messageType:h.ofNumber(f),senderId:g,sessionId:i})},"readwrite")}g.sendPakeMessageOne=a;g.joinPakeSession=b;g.decryptPakeSecret=e;g.sendPakeMessage=f}),98);
__d("VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4901700173259892"}),null);
__d("VestaServerGraphQLLoginProviderBeginLoginMutation.graphql",["VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"begin_login_request",variableName:"input"}],concreteType:"VestaBeginLoginResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_begin_login",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_l2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_l2_sig",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderBeginLoginMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLLoginProviderBeginLoginMutation",selections:c},params:{id:b("VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderBeginLoginMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5072170542843500"}),null);
__d("VestaServerGraphQLLoginProviderFinishLoginMutation.graphql",["VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"finish_login_request",variableName:"input"}],concreteType:"VestaFinishLoginResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_finish_login",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_login_payload",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_success",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderFinishLoginMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLLoginProviderFinishLoginMutation",selections:c},params:{id:b("VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderFinishLoginMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="7267509326655323"}),null);
__d("VestaServerGraphQLLoginProviderInitQuery.graphql",["VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{alias:null,args:[{kind:"Variable",name:"vesta_init_request",variableName:"request"}],concreteType:"VestaInitIqResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_login_init",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderInitQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLLoginProviderInitQuery",selections:c},params:{id:b("VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderInitQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLLoginProvider",["E2EEBackupUtil","Promise","RelayHooks","RelayModern","VestaServerGraphQLLoginProviderBeginLoginMutation.graphql","VestaServerGraphQLLoginProviderFinishLoginMutation.graphql","VestaServerGraphQLLoginProviderInitQuery.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c=c.environment;c=(yield d("RelayHooks").fetchQuery(c,h!==void 0?h:h=b("VestaServerGraphQLLoginProviderInitQuery.graphql"),{request:{fbid:a.clientId,product_use_case:a.productUseCase,vesta_client_api_version:6}}).toPromise());a=c==null?void 0:c.fbid_based_auth_layer_vesta_login_init;c=a==null?void 0:a.base64url_encoded_island_rsa_pub;var e=a==null?void 0:a.base64url_encoded_island_rsa_pub_signature,f=a==null?void 0:a.base64url_encoded_opaque_pub,g=a==null?void 0:a.base64url_encoded_opaque_pub_signature,i=a==null?void 0:a.base64url_encoded_island_ed25519_pub,j=a==null?void 0:a.base64url_encoded_island_ed25519_pub_signature,k=a==null?void 0:a.is_registered;a=a==null?void 0:a.attempts_remaining;if(c!=null&&e!=null&&f!=null&&g!=null&&i!=null&&j!=null&&k!=null){var l;return{islandRsaPub:(l=d("E2EEBackupUtil")).decodeBase64Url(c),islandRsaPubSig:l.decodeBase64Url(e),opaquePub:l.decodeBase64Url(f),opaquePubSig:l.decodeBase64Url(g),islandEd25519Pub:l.decodeBase64Url(i),islandEd25519PubSig:l.decodeBase64Url(j),isRegistered:k,loginAttemptsRemaining:a}}throw new Error("GraphQL Response is Null")});return l.apply(this,arguments)}function c(a,c){var e=c.environment,f=i!==void 0?i:i=b("VestaServerGraphQLLoginProviderBeginLoginMutation.graphql"),g={input:{fbid:a.clientId,product_use_case:a.productUseCase,base64url_encoded_opaque_l1:d("E2EEBackupUtil").encodeBase64Url(a.opaqueL1)}};return new(k||(k=b("Promise")))(function(a,b){d("RelayModern").commitMutation(e,{mutation:f,variables:g,onCompleted:function(c){c=c.fbid_based_auth_layer_vesta_begin_login;var e=c==null?void 0:c.base64url_encoded_opaque_l2;c=c==null?void 0:c.base64url_encoded_opaque_l2_sig;if(e!=null&&c!=null){a({opaqueL2:d("E2EEBackupUtil").decodeBase64Url(e),opaqueL2Sig:d("E2EEBackupUtil").decodeBase64Url(c)});return}b(new Error("GraphQL Response is Null"))},onError:function(a){b(a)}})})}function e(a,c){var e=c.environment,f=c.updater;return new(k||(k=b("Promise")))(function(c,g){d("RelayModern").commitMutation(e,{mutation:j!==void 0?j:j=b("VestaServerGraphQLLoginProviderFinishLoginMutation.graphql"),variables:{input:{fbid:a.clientId,product_use_case:a.productUseCase,base64url_encoded_opaque_l3:d("E2EEBackupUtil").encodeBase64Url(a.opaqueL3)}},onCompleted:function(a){a=a.fbid_based_auth_layer_vesta_finish_login;var b=a==null?void 0:a.base64url_encoded_login_payload,e=a==null?void 0:a.login_success;a=a==null?void 0:a.attempts_remaining;if(e!=null){c({loginSuccess:e,loginPayload:b==null?b:d("E2EEBackupUtil").decodeBase64Url(b),attemptsRemaining:a});return}g(new Error("GraphQL Response is Null"))},onError:function(a){g(a)},updater:f})})}g.initLogin=a;g.beginLogin=c;g.finishLogin=e}),98);