;/*FB_PKG_DELIM*/

__d("LSForceWebClientRefresh.nop",["ClientConsistencyEventEmitter","CurrentUser","ODS","WebStorage","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=!1;function a(){var a=(i||(i=c("WebStorage"))).getSessionStorage();a&&!j&&(a.getItem("ls_forced_refresh")==="1"?(h||(h=d("ODS"))).bumpEntityKey(3303,"lightspeed_web.refresh_loop_detected",k(c("CurrentUser").getAppID())):a.setItem("ls_forced_refresh","1"));j=!0;switch(c("CurrentUser").getAppID()){case 772021112871879..toString():c("ClientConsistencyEventEmitter").emit("hardRefresh","ls_forced_refresh");break;default:c("ClientConsistencyEventEmitter").emit("softRefresh","ls_forced_refresh")}throw c("unrecoverableViolation")("Client must refresh to continue syncScript execution","messenger_web_product")}function k(a){switch(a){case String(772021112871879):return"messenger";case String(2220391788200892):return"facebook";case String(1217981644879628):case String(936619743392459):case String(487152425211411):case String(1035956773910536):return"instagram";default:return"unknown_app"}}g["default"]=a}),98);
__d("LSUpdateOrInsertEditMessageHistory",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.filter(b.db.table(322).fetch([[[a[0],a[2]]],"originalMsgPkEditTs"]),function(c){return c.originalMessagePk===a[0]&&b.i64.eq(c.threadKey,a[1])&&b.i64.eq(c.serverAdjustedEditTsMs,a[2])}).next().then(function(c,d){var e=c.done;c=c.value;return e?b.db.table(322).add({pk:void 0,originalMessagePk:a[0],threadKey:a[1],serverAdjustedEditTsMs:a[2],messageContent:a[3],sendStatus:a[4]}):(d=c.item,b.db.table(322).put({pk:d.pk,originalMessagePk:a[0],threadKey:a[1],serverAdjustedEditTsMs:a[2],messageContent:a[3],sendStatus:a[4]}))})},function(a){return b.resolve(c)}])}e.exports=a}),null);